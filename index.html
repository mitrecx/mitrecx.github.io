<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/woAiLuo.jpg?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Goals determine what you are going to be">
<meta property="og:type" content="website">
<meta property="og:title" content="MITRE">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="MITRE">
<meta property="og:description" content="Goals determine what you are going to be">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MITRE">
<meta name="twitter:description" content="Goals determine what you are going to be">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>MITRE</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MITRE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Goals determine what you are going to be</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/01/墨菲定律/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/01/墨菲定律/" itemprop="url">读书笔记-墨菲定律</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-01T18:32:06+08:00">
                2020-03-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近读了 &lt;&lt;墨菲定律&gt;&gt; 这本书, 花了点时间提取出了 20% 的精华. 剩下 80% 我觉得有点扯淡, 就不提了.  </p>
<h2 id="1-墨菲定律"><a href="#1-墨菲定律" class="headerlink" title="1 墨菲定律"></a>1 墨菲定律</h2><p>如果你担心某种情况发生, 那么它很有可能发生.  </p>
<p><strong>不存在侥幸心理, 我们应该正视错误, 总结错误, 在错误中学习.</strong><br>事实上我们主要从尝试和错误中学习, 而不是从正确中学习.  </p>
<h2 id="2-奥卡姆剃刀定律"><a href="#2-奥卡姆剃刀定律" class="headerlink" title="2 奥卡姆剃刀定律"></a>2 奥卡姆剃刀定律</h2><p>把握关键, 化繁为简.  </p>
<p>把复杂的问题简单化, 选择越少越专注.<br>当你面对问题时, 应当思考: “什么是解决这个问题 或 实现目标 的最简单直接的方法?”  </p>
<h2 id="3-洛克定律"><a href="#3-洛克定律" class="headerlink" title="3 洛克定律"></a>3 洛克定律</h2><p>确定目标, 专注行动.  </p>
<p>哈佛大学 曾经做过一个跟踪调查, 调查对象是 一群智力,学历,生活环境都差不多的年轻人;<br>发现 90% 的人没有目标, 6% 的人有模糊的目标, 4% 的人有清晰明确的目标;<br>20 年后, 那 4% 的 有明确目标的人 在生活, 工作, 事业上比另外 96% 的人都要成功;<br>不可思议的是, 4% 的人拥有的 财富总和 超过了 96% 的人的财富总和.   </p>
<p>“成功是 <strong>目标的达成</strong>, 其它的都是这句话的注解.” –博恩.崔西  </p>
<p>我觉得目标 分 短期 和 长期 两种, 长期目标可以宏大,<br>但短期目标一定要 控制在超出自己能力一点点的地方.<br>总结:<br>没有目标 -&gt; 碌碌无为;<br>短期目标太大 -&gt; 总是失败;<br><strong>跳一跳能够得着的短期目标</strong> -&gt; 良性循环 (不断成长).  </p>
<h2 id="4-艾森豪威尔法则"><a href="#4-艾森豪威尔法则" class="headerlink" title="4 艾森豪威尔法则"></a>4 艾森豪威尔法则</h2><p>分清主次, 高效成事.  </p>
<p>事有轻重缓急, 有的时候我们会发现一个人很忙, 但是当你问他忙啥时(为啥这么忙?),<br>他却说不出所以然. 可能就是因为 他忙的都是 轻的事, 不重要的事, 琐碎的事.   </p>
<p>艾森豪威尔分类法:<br><strong><font color="#ff9900">A: 必须要做的事</font></strong> ;<br><strong><font color="#8a00e6">B: 应该要做的事</font></strong> ;<br><strong>C: 量力而为的事</strong> ;<br>D: 可委托他人去做的事;<br><del>E: 应该删除的事</del> .  </p>
<p>可以每天把自己要做的事 按照 上面的分类 划分;<br>同样的道理, 可以把自己 1-5 年的要做的事情列出来, 然后按优先级分类, 比如:<br><strong><font color="#ff9900">A: 最想做的事(必须要做的事)</font></strong> ;<br><strong><font color="#8a00e6">B: 应该要做的事</font></strong> ;<br>C: 做了会更好, 不做也无大碍的事.  </p>
<p><strong>到底是什么偷走了你的时间?</strong><br>想明白的话, 拿出纸笔, 按照艾森豪威尔原则 规划一下.  </p>
<p>这里有一个苏格拉底的故事:<br>苏格拉底 往罐子里装 鹅卵石, 装满后;<br>往罐子里装 碎石子, 装满后;<br>往罐子里装 沙子, 装满后;<br>往罐子里装 水, 装满.<br>苏格拉底说: 如果你不先将大的鹅卵石放进去, 也许以后再也没有机会放进去了.  </p>
<p><strong>做事前一定要把 事情分个等级, 科学安排时间给重要的事, 不要胡子眉毛一把抓.</strong>  </p>
<h2 id="5-酝酿效应"><a href="#5-酝酿效应" class="headerlink" title="5 酝酿效应"></a>5 酝酿效应</h2><p>灵感来自偶然, 有时不期而至.  </p>
<p>遇到某个难题, 冥思苦想不得其解, 花了几个小时仍一无所获,<br>暂时想忘掉它, 休息一会或酝酿(小憩一下, 喝杯茶, 或者干脆隔一段时间), 可能就茅塞顿开了.  </p>
<p>心理学家认为, 人在酝酿中, 存在 <strong>潜意识推理</strong> , 存储在记忆力的相关信息在 潜意识里组合, 而在穿插其它的事情的时候突然找到答案.  </p>
<h2 id="6-基利定理"><a href="#6-基利定理" class="headerlink" title="6 基利定理"></a>6 基利定理</h2><p>失败是成功之母.  </p>
<p>人一生中有很多机会, 我们要有承受失败的勇气, 一次比一次更好.<br>一个人的人生是否丰富, 不能看他的年龄, 而要看他生命的过程是否多彩.  </p>
<h2 id="7-蘑菇定律"><a href="#7-蘑菇定律" class="headerlink" title="7 蘑菇定律"></a>7 蘑菇定律</h2><p>新人, 想成蝶? 先破茧!!!  </p>
<p>蘑菇在阴暗的地方, 没有阳光, 自生自灭, 不被人关注;<br>只有长到足够高的时候, 才开始被人们注意到.  </p>
<p>如果想在职场中有所作为, 就要先适应它的游戏规则;<br>待到实力壮大, 羽翼丰满之后, 再通过自己的能力制定新的规则.  </p>
<h2 id="8-青蛙法则"><a href="#8-青蛙法则" class="headerlink" title="8 青蛙法则"></a>8 青蛙法则</h2><p>生于忧患, 死于安乐.  </p>
<p>35岁危机是说 许多人到35岁, 一事无成, 在机会面前不敢尝试.<br>时刻充电, 但是也要充足了(不是只有你一个在充电), 因为:<br>“不够优秀什么时候都会被淘汰.”  </p>
<h2 id="9-鲁尼恩定律"><a href="#9-鲁尼恩定律" class="headerlink" title="9 鲁尼恩定律"></a>9 鲁尼恩定律</h2><p>戒骄戒躁, 做笑到最后的大赢家.  </p>
<p>别人称赞你的时候, 想想自己的远大计划,<br>相比将来的宏伟蓝图, 现在只是万里长征的第一步.  </p>
<p>为自己的工作结果 制定标准, 严格落实到最后一个环节, 不要认为事情快要完成了 就掉以轻心, 毛毛躁躁.  </p>
<h2 id="10-链状效应"><a href="#10-链状效应" class="headerlink" title="10 链状效应"></a>10 链状效应</h2><p>想抱怨就微笑.</p>
<p>抱怨解决不了问题.</p>
<p>谁也不希望别人的 消极情绪 影响到自己的好心情, 所以想对别人抱怨的时候, 就微笑.  </p>
<h2 id="11-刻板效应"><a href="#11-刻板效应" class="headerlink" title="11 刻板效应"></a>11 刻板效应</h2><p>偏见的认知 源于 记忆中的刻板.  </p>
<p>题外话: 我觉得, 在某些情况下, 记忆中的刻板 也有好处;<br>Exceptions can be found to any rule. 不在辩论.  </p>
<p>不要以偏概全, 扩大视野, 少一点主观性, 多角度思考.  </p>
<h2 id="12-古德曼定律"><a href="#12-古德曼定律" class="headerlink" title="12 古德曼定律"></a>12 古德曼定律</h2><p>没有沉默, 就没有沟通.  </p>
<p>这个世界需要说出来的勇气, 更需要听进去的耐心.  </p>
<h2 id="13-沉默的螺旋"><a href="#13-沉默的螺旋" class="headerlink" title="13 沉默的螺旋"></a>13 沉默的螺旋</h2><p>人们在表达自己的观点时, 如果看到这个观点广受欢迎, 这类观点就越发大胆的扩散; 如果发现某一个观点很少有人理会, 即使自己赞同也会保持沉默.  </p>
<p>沉默的螺旋告诉我们, 生活的环境, 周围的人都会影响到我们.<br>比如: 周围的人都在努力, 自己也不甘人后; 周围的人都在玩耍, 自己也不愿孤单独处.  </p>
<p>沉默螺旋随处可见, 有积极的影响, 也有消极的影响.  </p>
<p>总之, 不要让别人的言行左右了自己的前进方向;<br>毕竟, 有主见才有魅力.  </p>
<h2 id="14-羊群效应"><a href="#14-羊群效应" class="headerlink" title="14 羊群效应"></a>14 羊群效应</h2><p>集体里的人们往往会盲目从众, 在集体的运动中丧失独立的判断.<br>羊群效应 也叫 从众心理.  </p>
<p>群众的眼睛可能不是雪亮的.  </p>
<h2 id="15-犯人船理论"><a href="#15-犯人船理论" class="headerlink" title="15 犯人船理论"></a>15 犯人船理论</h2><p>制度比人治更有效.  </p>
<p>18 世纪, 英国政府 支付费用 委托私人船主 运送囚犯到澳大利亚;<br>运到澳洲时, 4082 个囚犯死了498 个, 死亡率超过 10%;<br>对此, 英政府实施了一个新制度, 政府不再按照走上船的囚犯人数支付费用, 而按照活着到达澳洲的人数支付费用;<br>然后死亡率 降到了 1% 以下.  </p>
<h2 id="16-鲶鱼效应"><a href="#16-鲶鱼效应" class="headerlink" title="16 鲶鱼效应"></a>16 鲶鱼效应</h2><p>让外来的鲇鱼制造紧张的气氛.  </p>
<p>挪威人喜食沙丁鱼, 活鱼比死鱼价格高许多;<br>渔民为了能把活得沙丁鱼带回渔港, 通常会在鱼槽中放一条鲇鱼;<br>鲶鱼的存在让沙丁鱼十分紧张, 四处游动;<br>这样一条条活鱼就回到了渔港.<br>如果不放鲇鱼的话, 大部分沙丁鱼会窒息而死.  </p>
<p>对企业而言, 将”鲇鱼” 加进来, 会制造一些紧张气氛, 让企业焕发活力.<br>对个人而言, 给自己找一条 “鲇鱼”, 保持适度的压力.  </p>
<h2 id="17-参与定律"><a href="#17-参与定律" class="headerlink" title="17 参与定律"></a>17 参与定律</h2><p><strong><font color="#1a75ff">参与是支持的前提.</font></strong>  </p>
<p>如果想让别人支持你的决策, 就让他参与决策的讨论.  </p>
<h2 id="18-吸引力法则"><a href="#18-吸引力法则" class="headerlink" title="18 吸引力法则"></a>18 吸引力法则</h2><p>我们在一起很合得来.  </p>
<p>如果有人问你: “为什么选择他/她 作为另一半呢? 漂亮? 帅气? 聪明? 有钱? “<br>你给出的答案往往是: “我们在一起很合得来.”  </p>
<p>通常情况下, A 喜欢的人, 是那些也喜欢 A 的人.  </p>
<p>几乎没有人是完全自信的, 大多数人都需要别人对自己的肯定;<br>这样一来, 那些喜欢我们的人, 通过对我们的肯定, 追求等,<br>便为我们喜欢他们打下了基础.  </p>
<p>敞开心扉, 放开思想, 抛弃负面情绪, 然后:<br>“跟着感觉走, 像风一样自由.”  </p>
<h2 id="19-酸葡萄甜柠檬定律"><a href="#19-酸葡萄甜柠檬定律" class="headerlink" title="19 酸葡萄甜柠檬定律"></a>19 酸葡萄甜柠檬定律</h2><p>只要你愿意, 总有理由幸福.  </p>
<p>&lt;&lt;伊索寓言&gt;&gt; 中有个故事:<br>一只饥饿的狐狸路过 果林时, 看到架子上有许多葡萄;<br>于是就去摘, 可是怎么也够不到;<br>就在失望的时候, 狐狸却笑道: “那些葡萄还没有长熟, 肯定是酸溜溜的.”<br>于是它高兴地走开了.  </p>
<p>一句自我安慰, 让狐狸走出沮丧, 变得快乐起来.  </p>
<p>酸葡萄式的自我安慰很常见, 如,<br>单身族: “一个人多好, 多自在.”<br>农村人: “城里不好, 人多环境差.”<br>城里人: “农村不好, 交通不便.”<br>…</p>
<p>与 “酸葡萄” 对立的是 “甜柠檬” 心理.<br>甜柠檬心理:<br>人们对得到的东西, 尽管不满意, 也坚持认为是好的.  </p>
<p>生活不可能十全十美, 幸福者都懂得适度的运用 “酸葡萄” 和 “甜柠檬”.  </p>
<h2 id="20-幸福递减定律"><a href="#20-幸福递减定律" class="headerlink" title="20 幸福递减定律"></a>20 幸福递减定律</h2><p>当你饿的时候, 给你一块面包, 你吃起来会很香;<br>给你第二块, 可能就没有第一块那么香了;<br>第三块, 第四块… 最后就一点都不香了.  </p>
<p>饥饿者得到的面包数量不断增加, 幸福感却减少了. 这便是幸福递减定律.<br>事实上, 由于我们的内心发生了变化, 对幸福失去了敏感.  </p>
<p>因为幸福递减的特性, 我们必须要有一颗感恩之心.  </p>
<h2 id="21-野马结局"><a href="#21-野马结局" class="headerlink" title="21 野马结局"></a>21 野马结局</h2><p>不生气是一种修行.  </p>
<p>野马结局来源于一个故事:<br>野马受不了吸血蝙蝠的叮咬, 暴怒而亡.<br>但是吸血蝙蝠的叮咬并不足以杀死野马.<br><del>(有可能是新冠肺炎)</del>  </p>
<p>一个生气/生闷气 的人, 生理上会产生一系列的变化, 导致人体器官损伤.  </p>
<p>当我们生气的时候可以转移注意力.  </p>
<p>最后看一个故事:<br>在古老的西藏, 有一个叫爱地巴的人, 每次生气和人起争执的时候, 就以很快的速度跑回家去, 绕着自己的房子和土地跑三圈, 然后坐在田地边喘气.<br>爱地巴工作非常勤劳努力, 他的房子越来越大, 土地也越来越广, 但不管房地有多大, 只要与人争论生气, 他还是会绕着房子和土地绕三圈, 爱地巴为何每次生气都绕着房子和土地绕三圈? 所有认识他的人, 心理都起疑惑, 但是不管怎么问他, 爱地巴都不愿意说明.  </p>
<p>直到有一天, 爱地巴很老, 他的房地又已经太广大, 他生气, 拄着拐杖艰难的绕着土地跟房子, 等他好不容易走三圈, 太阳都下山, 爱地巴独自坐在田边喘气.<br>他的孙子在身边恳求他：”阿公, 你已经年纪大, 这附近地区的人也没有人的土地比你更大, 您不能再像从前, 一生气就绕着土地跑啊！您可不可以告诉我这个秘密, 为什么您一生气就要绕着土地跑上三圈?”    </p>
<p>爱地巴禁不起孙子恳求, 终于说出隐藏在心中多年的秘密.<br>他说：”<strong>年轻时, 我一和人吵架、争论、生气, 就绕着房地跑三圈, 边跑边想, 我的房子这么小, 土地这么小, 我哪有时间, 哪有资格去跟人家生气, 一想到这里, 气就消了, 于是就把所有时间用来努力工作.</strong>“  </p>
<p>孙子问到：”阿公, 你年纪老, 又变成最富有的人, 为什么还要绕着房地跑？”<br>爱地巴笑着说：”<strong>我现在还是会生气, 生气时绕着房地走三圈, 边走边想, 我的房子这么大, 土地这么多, 我又何必跟人计较? 一想到这, 气也消了.</strong>“  </p>
<p><img src="https://mitre.oss-cn-hangzhou.aliyuncs.com/blog-2020/murphy.jpeg" alt="Murphy">  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/28/postgreSQL简单配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/28/postgreSQL简单配置/" itemprop="url">postgreSQL简单配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-28T13:17:51+08:00">
                2020-02-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="卸载-yum-方式安装的-postgreSQL"><a href="#卸载-yum-方式安装的-postgreSQL" class="headerlink" title="卸载 yum 方式安装的 postgreSQL"></a>卸载 yum 方式安装的 postgreSQL</h1><p>用以下两个命令查看 <strong>系统信息</strong> :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a</span><br><span class="line"></span><br><span class="line">uname -a</span><br></pre></td></tr></table></figure></p>
<p>卸载 postgreSQL :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum 删除软件包</span></span><br><span class="line">sudo yum remove postgresql*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除相关目录文件：</span></span><br><span class="line">sudo rm -rf  /var/lib/pgsql</span><br><span class="line">sudo rm -rf  /usr/pgsql*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除pg相关用户组/用户</span></span><br><span class="line">sudo userdel -r postgres</span><br><span class="line">sudo groupdel postgres</span><br></pre></td></tr></table></figure></p>
<h1 id="源码方式安装-postgreSQL"><a href="#源码方式安装-postgreSQL" class="headerlink" title="源码方式安装 postgreSQL"></a>源码方式安装 postgreSQL</h1><p><a href="https://www.postgresql.org/download/" target="_blank" rel="noopener">postgreSQL 官网</a> 介绍的安装方式有多种.  </p>
<p>这里简单介绍一下 编译源码 这种安装方式:<br>1, 下载源码<a href="https://www.postgresql.org/ftp/source/" target="_blank" rel="noopener">(点击下载)</a>;<br>2, 解压并进入 postgresql-version 目录, 打开 INSTALL<br>3, 按照 INSTALL 文件的 指示安装:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">su</span><br><span class="line">make install</span><br><span class="line">adduser postgres</span><br><span class="line">mkdir /usr/<span class="built_in">local</span>/pgsql/data</span><br><span class="line">chown postgres /usr/<span class="built_in">local</span>/pgsql/data</span><br><span class="line">su - postgres</span><br><span class="line"><span class="comment"># 初始化数据库</span></span><br><span class="line">/usr/<span class="built_in">local</span>/pgsql/bin/initdb -D /usr/<span class="built_in">local</span>/pgsql/data</span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">/usr/<span class="built_in">local</span>/pgsql/bin/pg_ctl -D /usr/<span class="built_in">local</span>/pgsql/data -l logfile start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据库 test</span></span><br><span class="line">/usr/<span class="built_in">local</span>/pgsql/bin/createdb <span class="built_in">test</span></span><br><span class="line"><span class="comment"># 以 postgres role 连接到 test 数据库</span></span><br><span class="line">/usr/<span class="built_in">local</span>/pgsql/bin/psql <span class="built_in">test</span></span><br></pre></td></tr></table></figure></p>
<p>提示:<br>如果 <code>./configure</code> 提示 缺少 lib 则安装对应的 lib , 比如:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install readline-devel -y</span><br><span class="line">sudo yum install zlib-devel.x86_64 -y</span><br></pre></td></tr></table></figure></p>
<p>start 与 stop :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切到 postgres 用户, 进入 ~/.bashrc , 把 bin 添加到 PATH</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/pgsql/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># start</span></span><br><span class="line">pg_ctl -D /usr/<span class="built_in">local</span>/pgsql/data/ -l logfile start</span><br><span class="line"><span class="comment"># status</span></span><br><span class="line">pg_ctl -D /usr/<span class="built_in">local</span>/pgsql/data/ -l logfile status</span><br><span class="line"><span class="comment"># stop</span></span><br><span class="line">pg_ctl -D /usr/<span class="built_in">local</span>/pgsql/data/ -l logfile stop</span><br></pre></td></tr></table></figure></p>
<h1 id="远程访问-postgreSQL"><a href="#远程访问-postgreSQL" class="headerlink" title="远程访问 postgreSQL"></a>远程访问 postgreSQL</h1><p>Client authentication is controlled by a configuration file,<br>which traditionally is named <strong>pg_hba.conf</strong> and is stored in the database cluster’s data directory.<br>(HBA stands for <strong>host-based authentication</strong>.)<br>A default pg_hba.conf file is installed when the data directory is initialized by initdb.   </p>
<p>修改 以下两个文件 :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1, host-based authentication 配置文件:</span></span><br><span class="line">sudo vim /usr/<span class="built_in">local</span>/pgsql/data/pg_hba.conf</span><br><span class="line"><span class="comment"># 添加一行</span></span><br><span class="line">host    all             all             0.0.0.0/0               md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2, 全局配置文件:</span></span><br><span class="line">sudo vim /usr/<span class="built_in">local</span>/pgsql/data/postgresql.conf</span><br><span class="line"><span class="comment"># 修改一行</span></span><br><span class="line">listen_addresses = <span class="string">'*'</span></span><br><span class="line"><span class="comment"># defaults to 'localhost'; use '*' for all</span></span><br></pre></td></tr></table></figure></p>
<p>然后重启 postgreSQL .  </p>
<h1 id="修改-role-密码"><a href="#修改-role-密码" class="headerlink" title="修改 role 密码"></a>修改 role 密码</h1><p>terminal 截取片段:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[postgres@shumingly ~]$</span><br><span class="line">[postgres@shumingly ~]$ psql -h localhost -U postgres test</span><br><span class="line">psql (12.0)</span><br><span class="line">Type &quot;help&quot; for help.</span><br><span class="line"></span><br><span class="line">test=# ALTER USER postgres WITH PASSWORD &apos;国际通用密码&apos;;</span><br><span class="line">ALTER ROLE</span><br><span class="line">test=# \q</span><br><span class="line">[postgres@shumingly ~]$</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/22/2020-Exploring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/02/22/2020-Exploring/" itemprop="url">2020-Exploring</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-22T22:35:56+08:00">
                2020-02-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇 blog 原本名称应该是 “2019-探索”;<br>因为 本文是对 2019 年的总结.<br>但是, 我写这片 blog 时已经是 2020 年的 2 月了;<br>之前一直在忙着工作的事情, 耽搁了总结.<br>不过, 我还是决定以后把总结放在后一年写, 然后用题目 <strong>表达后一年的状态</strong>.  </p>
<p>不出意外的话, 明年的题目应该是, 2021-再出发.</p>
<h1 id="1-总结-2019"><a href="#1-总结-2019" class="headerlink" title="1 总结 2019"></a>1 总结 2019</h1><p>看了 18年底写的<a href="https://mitrecx.github.io/2018/12/31/2018-%E9%9D%A9%E6%96%B0/" target="_blank" rel="noopener">2019年的计划</a>, “革新” 基本上是成功了.  </p>
<h2 id="1-1-以下是-2019-的目标及完成得分"><a href="#1-1-以下是-2019-的目标及完成得分" class="headerlink" title="1.1 以下是 2019 的目标及完成得分"></a>1.1 以下是 2019 的目标及完成得分</h2><p>目标1:<br>开源框架掌握一套(0.4);<br>没有掌握透彻, 仅仅达到简单的工作需要, 出了问题无法快速解决.  </p>
<p>目标2:<br>技术氛围好的工作(0.9);<br>9月份从宇信离职来到别样.  </p>
<p>目标3:<br><strong><font color="red">读英文文档的能力(0.3)</font></strong>;<br>做了一些尝试, 比如打印文档阅读, 读英文文档能力有所提高, 但是离无障碍阅读还有很大距离.  </p>
<p>目标4:<br>提高博客质量(0.2);<br>有时工作中有问题我会看自己的博客, 但能看的只是个位数.  </p>
<p>目标5:<br>管理学/心理学书籍阅读(0.6);<br>读了4-5本书, 包括&lt;&lt;瞬变&gt;&gt;, &lt;&lt;情商&gt;&gt;, &lt;&lt;见识&gt;&gt;, &lt;&lt;你只是看起来很努力&gt;&gt;.  有的没完全读完.  </p>
<p>总结来看, <strong>英文水平</strong> 和 博客质量 两个目标脱了后腿;<br>英文水平 的提高是 <strong>至关重要</strong> 的, 是我个人目标中 “百年大计”.  </p>
<h2 id="1-2-2019-年事件回顾"><a href="#1-2-2019-年事件回顾" class="headerlink" title="1.2 2019 年事件回顾"></a>1.2 2019 年事件回顾</h2><p><strong>2019年2月初</strong>, 过完春节回到江阴农商行工作;<br><strong>2019年2月初</strong>, 刚到江阴3天, 就被调到(常州)江南农商行, 在常州期间自学了一些东西, 包括设计模式, Maven, JS等;<br><strong>2019年4月</strong>, 回到寿县考驾照科目三, 没过;<br><strong>2019年4月17</strong>, 调我 和 桑前进 到上海兴业银行;<br><strong>2019年4月底</strong>, 回到寿县考驾照科目三, 通过;<br><strong>2019年9月27</strong>, 从宇信离职;<br>宇信很大, 到我离职时, 我已经从边缘的实施(江阴) 到部门重点实施(常州) 再到总部重点研发(上海), 经历了许多考验.<br>这个过程我用了1年零2个月.<br>在 辛伟 领导下的 宇信兴业项目组中, 我度过了1年中最充实的6个月;<br>在工作中, 在个人成长中, 辛伟都给了我很大的帮助, 非常感谢辛伟.<br>还有上海的同事, 还有超奇, 前进, 杨杰, 兴业这段时间很辛苦, 也很幸福…  </p>
<p><strong>2019年10月1</strong>, 搬离芳华路, 来到唐镇, 感谢大鹏帮我搬家.  </p>
<p><strong>2019年10月28</strong>, 入职别样, 别样是一个技术氛围很好的公司, 同时也很年轻;<br>和宇信的工作不同, 别样的程序是现成的, 大量的逻辑, 大量的代码;<br>开始的工作是有一点困难的, 因为一个简单的开发任务必须理解清楚之前的逻辑, 才能把自己的功能加进去.<br>从现在来看, 显然我已经度过了开始的那个困难时期;<br>不过, 我知道要想提高知名度, 仅仅按部就班完成工作是远远不够的.<br>在别样, 我才刚刚起步, 还有很长的路要走.  </p>
<h1 id="2-探索-2020-年"><a href="#2-探索-2020-年" class="headerlink" title="2 探索 2020 年"></a>2 探索 2020 年</h1><p>和宇信的不稳定相比, 别样则好多了.<br>既然有了稳定的环境, 下一步就是 <strong>探索</strong> 了.<br>别样研发部有几个大神级的人物, 他们非常值得我学习.  </p>
<p>探索 分为两个方面: 技术 和 心智.  </p>
<h2 id="2-1-2020-年-OKR"><a href="#2-1-2020-年-OKR" class="headerlink" title="2.1 2020 年 OKR"></a>2.1 2020 年 OKR</h2><table>
<thead>
<tr>
<th>序号</th>
<th>Objectives and Key Results(目标和主要成果)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>掌握 Java 并发编程, 阅读所有的 JUC 代码;</td>
</tr>
<tr>
<td>2</td>
<td>掌握 23 中设计模式(画UML), 设计原则熟稔于心;</td>
</tr>
<tr>
<td>3</td>
<td><strong>英文文档阅读能力, 基本无障碍</strong>, 完成以下文档阅读:  <br><a href="https://kafka.apache.org/" target="_blank" rel="noopener">kafka</a> + <a href="https://zookeeper.apache.org/" target="_blank" rel="noopener">zookeeper</a> 文档阅读;  <br><a href="https://www.dropwizard.io/" target="_blank" rel="noopener">dropwizard</a> 文档阅读;  <br><a href="https://redis.io/" target="_blank" rel="noopener">Redis</a> 文档阅读;</td>
</tr>
<tr>
<td>4</td>
<td><strong>明天早晚各一小时英语(一点,喜马拉雅,或笔记)</strong>:    <br>为了保证学习质量,  <br>没有不可抗拒的因素, 必须11:50前休息, 7:30前起床,    <br>9月份报考 TOEFL, 目标 90分;</td>
</tr>
<tr>
<td>5</td>
<td>读书清单:   <br>浪潮之巅,  <br>事实,  <br>人月神话,  <br>NLP思维,  <br>深度思考,  <br>人性的弱点,<br>贫穷的本质;</td>
</tr>
<tr>
<td>6</td>
<td>每周两道算法题:   <br>读 算法导论 并做记录;</td>
</tr>
<tr>
<td>7</td>
<td>一次长途旅行;</td>
</tr>
<tr>
<td>8</td>
<td>每月一次技术分享, 仅限技术.</td>
</tr>
</tbody>
</table>
<h2 id="2-2-一点感触"><a href="#2-2-一点感触" class="headerlink" title="2.2 一点感触"></a>2.2 一点感触</h2><p>过年的时候父母在催 强强 找对象,<br>这种事情, 一千个读者有一千个哈姆雷特, 因人而异.<br>不过父母也是一片好心, 我可以理解.  </p>
<p>2020 年 1 月 20 号(事实上2019年12月就有人感染了), 在武汉爆发的 <strong>新型冠状病毒(2019-nCoV/SARS-CoV2)</strong>, 现在似乎有好转的迹象了;<br>这个病毒和 2003 年的非典(重症急性呼吸综合征（SARS）为一种由SARS冠状病毒（SARS-CoV）引起的急性呼吸道传染病) 都是冠状病毒.<br>SARS 病毒 <strong>至今尚无肯定有效抗病毒药物治疗</strong>.<br>新冠病毒 目前也没有有效药物, 美国的 <strong>Remdesivir（瑞德西韦）</strong> 似乎有效,<br>但是 双盲实验 到4月份结果才能出来, 也就是说 4月份才能确定它是否有效.  </p>
<p>新冠病毒 延长了年假, 推迟了开学时间, 复工时间, 大部分的商场和餐厅已经一个月没有营业了.<br>武汉封城, 即使非湖北人员, 复工前也要隔离14天.<br>距离放年假已经一个月了(1月24号放假), 本周是我第一周在公司上班, 一楼只有我和姜地两个人.<br>上班在地铁公交上人也寥寥无几.<br>一个病毒就改变了我们的生活.  </p>
<p>新冠病毒 据推测是 来自于野生动物-中华菊头蝠,<br>人类对大自然还不够了解, 至少目前是的.  </p>
<p><img src="https://mitre.oss-cn-hangzhou.aliyuncs.com/blog-2020/saras-cov2.jpeg" alt="附一张感染数据图">  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/27/shell-script-批量启动服务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/27/shell-script-批量启动服务/" itemprop="url">shell script: 批量启动服务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-27T12:08:15+08:00">
                2019-09-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/shell/" itemprop="url" rel="index">
                    <span itemprop="name">shell</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>目标:<br>写一个 shell 脚本, 启动多个 worker 服务.<br>(worker 服务 用于处理 消息中间件 里的消息)  </p>
<p>先了解一些基础知识, 然后利用这些基础知识 <a href="#multi-start">完成目标</a>.  </p>
<h1 id="1-读取命令行参数"><a href="#1-读取命令行参数" class="headerlink" title="1 读取命令行参数"></a>1 读取命令行参数</h1><table>
<thead>
<tr>
<th>变量</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>$0</td>
<td>当前脚本的文件名</td>
</tr>
<tr>
<td>$n</td>
<td>传递给脚本或函数的参数. 第一个参数是 $1，第二个参数是 $2</td>
</tr>
<tr>
<td>$#</td>
<td>传递给脚本或函数的 参数个数</td>
</tr>
<tr>
<td>$*</td>
<td>传递给脚本或函数的 <strong>所有参数</strong></td>
</tr>
<tr>
<td>$@</td>
<td>传递给脚本或函数的 <strong>所有参数</strong></td>
</tr>
<tr>
<td>$?</td>
<td>上个命令的退出状态，或函数的返回值。</td>
</tr>
<tr>
<td>$$</td>
<td>当前Shell进程ID</td>
</tr>
</tbody>
</table>
<p>注意 $* 和 $@ 的区别:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$* 获得到的参数是 数组类型, <span class="string">"$*"</span> 获得的参数是 字符串类型</span><br><span class="line"></span><br><span class="line"><span class="variable">$@</span> 和 <span class="string">"<span class="variable">$@</span>"</span> 获得的参数 都是 数组类型</span><br></pre></td></tr></table></figure></p>
<p>示例代码 <strong>t2.sh</strong> :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> ---<span class="string">"print each param from \$*"</span></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> $*</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$var</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> ---<span class="string">"print each param from \"\$*\""</span></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> <span class="string">"$*"</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$var</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> ---<span class="string">"print each param from \$@"</span></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> <span class="variable">$@</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$var</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> ---<span class="string">"print each param from \"\$@\""</span></span><br><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"<span class="variable">$var</span>"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></p>
<p><code> ./t2.sh mitre cherry</code>  执行结果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">---print each param from $*</span><br><span class="line">mitre</span><br><span class="line">cherry</span><br><span class="line">---print each param from &quot;$*&quot;</span><br><span class="line">mitre cherry</span><br><span class="line">---print each param from $@</span><br><span class="line">mitre</span><br><span class="line">cherry</span><br><span class="line">---print each param from &quot;$@&quot;</span><br><span class="line">mitre</span><br><span class="line">cherry</span><br></pre></td></tr></table></figure></p>
<h1 id="2-Shell-基本运算"><a href="#2-Shell-基本运算" class="headerlink" title="2 Shell 基本运算"></a>2 Shell 基本运算</h1><p>Shell 支持多种运算符，包括：<br>1, 算数运算符<br>2, 关系运算符<br>3, 逻辑运算符<br>4, 字符串运算符(略)<br>5, 文件测试运算符(略)  </p>
<h2 id="2-1-算数运算"><a href="#2-1-算数运算" class="headerlink" title="2.1 算数运算"></a>2.1 算数运算</h2><p>原生 bash 不支持简单的数学运算，但是可以通过其他命令来实现，比如 expr 或 awk.  </p>
<p>expr 是一款表达式计算工具，使用它能完成表达式的求值操作.<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">val=`expr 2 + 2`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"两数之和为 : <span class="variable">$val</span>"</span></span><br></pre></td></tr></table></figure></p>
<p>运行结果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">两数之和为 : 4</span><br></pre></td></tr></table></figure></p>
<p><strong><font color="red">注意: </font></strong><br>1, 表达式 和 <strong><font color="#8a00e6">运算符</font></strong> 之间要有空格，例如 <strong>2<font color="#8a00e6">+</font>2</strong> 是不对的，必须写成 <strong>2 <font color="#8a00e6">+</font> 2</strong>，这与我们熟悉的大多数编程语言不一样.<br>2, 完整的 表达式 要被 ` ` 包含.  </p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>举例</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加</td>
<td>`expr $a + $b` 结果为 30。</td>
</tr>
<tr>
<td>-</td>
<td>减</td>
<td>`expr $a - $b` 结果为 -10。</td>
</tr>
<tr>
<td>*</td>
<td>乘</td>
<td>`expr $a * $b` 结果为  200。</td>
</tr>
<tr>
<td>/</td>
<td>除</td>
<td>`expr $b / $a` 结果为 2。</td>
</tr>
<tr>
<td>%</td>
<td>取余</td>
<td>`expr $b % $a` 结果为 0。</td>
</tr>
</tbody>
</table>
<h2 id="2-2-关系运算"><a href="#2-2-关系运算" class="headerlink" title="2.2 关系运算"></a>2.2 关系运算</h2><p><strong>关系运算符</strong> 只支持 <strong>数字</strong> ，不支持字符串，除非字符串的值是数字.  </p>
<p>假定变量 a 为 10，变量 b 为 20:  </p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>举例  </th>
</tr>
</thead>
<tbody>
<tr>
<td>-eq</td>
<td>equal</td>
<td>[ $a -eq $b ] 返回 false</td>
</tr>
<tr>
<td>-ne</td>
<td>not equal</td>
<td>[ $a -ne $b ] 返回 true</td>
</tr>
<tr>
<td>-gt</td>
<td>greater than</td>
<td>[ $a -gt $b ] 返回 false</td>
</tr>
<tr>
<td>-lt</td>
<td>less than</td>
<td>[ $a -lt $b ] 返回 true</td>
</tr>
<tr>
<td>-ge</td>
<td>greater than or equal</td>
<td>[ $a -ge $b ] 返回 false</td>
</tr>
<tr>
<td>-le</td>
<td>less than or equal</td>
<td>[ $a -le $b ] 返回 true</td>
</tr>
</tbody>
</table>
<h2 id="2-3-逻辑运算"><a href="#2-3-逻辑运算" class="headerlink" title="2.3 逻辑运算"></a>2.3 逻辑运算</h2><p>假定变量 a 为 10，变量 b 为 20:</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>说明</th>
<th>举例</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;&amp;</td>
<td>与 AND</td>
<td>[[ $a -lt 123 &amp;&amp; $b -gt 123 ]] 返回 false</td>
</tr>
<tr>
<td>&#124;&#124;</td>
<td>或 OR</td>
<td>[[ $a -lt 123 &#124;&#124; $b -gt 123 ]] 返回 true</td>
</tr>
<tr>
<td>!</td>
<td>非</td>
<td>见下例</td>
</tr>
</tbody>
</table>
<p>例子:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ ! 8 -eq 9 ]] ; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"8 not equal 9"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"8 equal 9"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></p>
<p>运行结果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8 not equal 9</span><br></pre></td></tr></table></figure></p>
<h1 id="multi-start">3 多服务启动脚本</h1>

<p>了解前面的基础知识, 写 一个启动多个服务的脚本 很简单了:  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">java_dir=<span class="string">"/app/jdk1.8.0_191/bin/java"</span></span><br><span class="line">start_port=4242</span><br><span class="line">worker_cnt=1</span><br><span class="line">jar_name=<span class="string">"worker-0.0.1-SNAPSHOT.jar"</span></span><br><span class="line"></span><br><span class="line">usage()</span><br><span class="line">&#123;</span><br><span class="line">  (<span class="built_in">echo</span> <span class="string">"使用方法: <span class="variable">$0</span> 起始端口号 worker个数"</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"起始端口号 必须大于 0"</span></span><br><span class="line">   <span class="built_in">echo</span> <span class="string">"worke 个数必须大于 0 同时小于16"</span></span><br><span class="line">   ) 1&gt;&amp;2</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 限制参数输入</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -ne 2 ]; <span class="keyword">then</span></span><br><span class="line">  usage</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断起始端口号是否 合法</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$1</span> -gt 0 ] 2&gt;/dev/null ;<span class="keyword">then</span>  </span><br><span class="line">  start_port=<span class="variable">$1</span></span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">  usage</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span>   </span><br><span class="line"><span class="comment"># worker 个数必须是大于0的整数</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$2</span> -gt 0 &amp;&amp; <span class="variable">$2</span> -lt 16 ]] 2&gt;/dev/null ;<span class="keyword">then</span>  </span><br><span class="line">  worker_cnt=<span class="variable">$2</span></span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">  usage</span><br><span class="line">  <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span>   </span><br><span class="line"><span class="comment"># 删除日志文件</span></span><br><span class="line">rm nohup*.out</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"正在启动..."</span></span><br><span class="line"><span class="keyword">for</span> ((i=0;i&lt;<span class="variable">$worker_cnt</span>;i++)); <span class="keyword">do</span></span><br><span class="line">  <span class="comment">#echo `expr $start_port + $i`</span></span><br><span class="line">  port=`expr <span class="variable">$start_port</span> + <span class="variable">$i</span>`</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"nohup "</span><span class="variable">$&#123;java_dir&#125;</span><span class="string">" -Xms1024m -Xmx1024m -jar <span class="variable">$&#123;jar_name&#125;</span> --server.port=<span class="variable">$&#123;port&#125;</span> &gt; nohup<span class="variable">$&#123;port&#125;</span>.out 2&gt;&amp;1 &amp;"</span></span><br><span class="line">  nohup <span class="string">"<span class="variable">$&#123;java_dir&#125;</span>"</span> -Xms1024m -Xmx1024m -jar <span class="variable">$&#123;jar_name&#125;</span> --server.port=<span class="variable">$&#123;port&#125;</span> &gt; nohup<span class="variable">$&#123;port&#125;</span>.out 2&gt;&amp;1 &amp;  </span><br><span class="line">  sleep 4</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"启动完成!"</span></span><br></pre></td></tr></table></figure>
<p><strong>说明:</strong><br><code>1&gt;&amp;2</code> 把 <strong>标准输出</strong> 重定向到 <strong>标准错误</strong> .<br>因为 标准输出 和 标准错误 最终都是输出到 终端.<br>所以加或不加 <code>1&gt;&amp;2</code>, 运行结果是一样的 .</p>
<p><code>2&gt;/dev/null</code> 把 标准错误 重定向到 <strong>空设备文件</strong> 中.  </p>
<h1 id="4-关闭多个进程"><a href="#4-关闭多个进程" class="headerlink" title="4 关闭多个进程"></a>4 关闭多个进程</h1><p>一次性启动了多个进程, 一个一个的手动 kill, 挺费事的.<br>不如 写一个脚本, 一次性关闭 所有 worker 进程:  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">ps -ef | grep worker-0.0.1-SNAPSHOT | awk <span class="string">'&#123;print $2&#125;'</span> | xargs -I&#123;&#125;  <span class="built_in">kill</span> -9 &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>因为 ps 进程 也会产生一个 pid, kill 的 时候会提示:<br><strong>kill 27846: No such process</strong><br>这是因为 ps 进程 在 执行 kill命令前就 已经 关闭了.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p>1 <a href="https://www.cnblogs.com/kingstrong/p/6026896.html" target="_blank" rel="noopener">shell 命令行参数</a><br>2 <a href="https://www.runoob.com/linux/linux-shell-basic-operators.html" target="_blank" rel="noopener">shell 基本运算符</a><br>3 <a href="https://github.com/LARG/utaustinvilla3d/blob/master/start.sh" target="_blank" rel="noopener">start.sh</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/Redis-安装与配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/Redis-安装与配置/" itemprop="url">Redis 安装与配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-26T14:14:56+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Redis/" itemprop="url" rel="index">
                    <span itemprop="name">Redis</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-Redis-简介"><a href="#1-Redis-简介" class="headerlink" title="1 Redis 简介"></a>1 Redis 简介</h1><p><a href="https://redis.io/topics/introduction" target="_blank" rel="noopener">Redis</a> is an open source (BSD licensed), <strong>in-memory data structure store</strong>, used as a database, cache and message broker.<br>redis是一个开源 (bsd许可) 的 <strong>内存数据结构存储</strong>，用作数据库、缓存和消息代理。  </p>
<p>Redis is written in ANSI C and works in most POSIX systems like Linux, *BSD, OS X without external dependencies.<br>Redis 用 ANSI C 语言编写, 能够无需任何外部依赖地 运行在大多数 POSIX 系统中, 如, Linux, BSD, OS X.  </p>
<p>目前, <a href="https://redis.io" target="_blank" rel="noopener">Redis 官网</a> 提供的最新版本是 5.0.5.  </p>
<h1 id="2-阿里云主机-CentOS-安装并配置-Redis"><a href="#2-阿里云主机-CentOS-安装并配置-Redis" class="headerlink" title="2 阿里云主机 CentOS 安装并配置 Redis"></a>2 阿里云主机 CentOS 安装并配置 Redis</h1><h2 id="2-1-下载与安装"><a href="#2-1-下载与安装" class="headerlink" title="2.1 下载与安装:"></a>2.1 <a href="https://redis.io/download" target="_blank" rel="noopener">下载与安装</a>:</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-5.0.5.tar.gz</span><br><span class="line">tar zxf redis-5.0.5.tar.gz</span><br><span class="line"><span class="built_in">cd</span> redis-5.0.5</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<h2 id="2-2-配置"><a href="#2-2-配置" class="headerlink" title="2.2 配置"></a>2.2 配置</h2><p>在 解压后的目录 redis-5.0.5 下, 有一个 redis.conf 文件.<br>redis.conf 就是 Redis 服务器的配置文件.  </p>
<p>修改 redis.conf 文件, 设置外网可访问:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭保护模式</span></span><br><span class="line">protected-mode no</span><br><span class="line"><span class="comment"># 不限 IP 访问</span></span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line"><span class="comment"># 修改默认端口</span></span><br><span class="line">port 6342</span><br><span class="line"><span class="comment"># 设置密码 为123</span></span><br><span class="line">requirepass 123</span><br></pre></td></tr></table></figure></p>
<p>把 redis-5.0.5/src 添加到 PATH 环境变量:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新建一个 sh 脚本</span></span><br><span class="line">vim /etc/profile.d/redis.sh</span><br><span class="line"><span class="comment"># 在脚本中 添加环境变量</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:绝对路径/redis-5.0.5/src</span><br><span class="line"><span class="comment"># 使配置立即生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/bashrc</span><br></pre></td></tr></table></figure></p>
<h2 id="2-3-配置-云主机的-安全组"><a href="#2-3-配置-云主机的-安全组" class="headerlink" title="2.3 配置 云主机的 安全组"></a>2.3 配置 云主机的 安全组</h2><p>如下开放 6342 端口:  </p>
<p><img src="https://mitre.oss-cn-hangzhou.aliyuncs.com/blog2019/pic09/redis.png" alt>  </p>
<h2 id="2-4-运行-Redis"><a href="#2-4-运行-Redis" class="headerlink" title="2.4 运行 Redis"></a>2.4 运行 Redis</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 运行 Redis</span></span><br><span class="line">redis-server redis.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端 连接</span></span><br><span class="line">redis-cli -h IP地址 -p 端口号 -a 密码</span><br></pre></td></tr></table></figure>
<h1 id="3-Redis-数据类型"><a href="#3-Redis-数据类型" class="headerlink" title="3 Redis 数据类型"></a>3 Redis 数据类型</h1><p>Redis 支持五种 基本的 数据类型：<br>1, string (字符串)<br>2, hash (哈希)<br>3, list (列表)<br>4, set (集合)<br>5, zset (sorted set: 有序集合)  </p>
<h2 id="3-1-string"><a href="#3-1-string" class="headerlink" title="3.1 string"></a>3.1 string</h2><p><strong>string 类型</strong> 是 Redis 最基本的数据类型，string 类型的值最大能存储 512MB.<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6342&gt; SET name <span class="string">"Mitre"</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6342&gt; GET name</span><br><span class="line"><span class="string">"Mitre"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3-2-hash"><a href="#3-2-hash" class="headerlink" title="3.2 hash"></a>3.2 hash</h2><p><strong>hash 类型</strong> 是一个 key(string 类型) 和 value 的映射表，hash 特别适合用于存储对象.<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6342&gt; HMSET person name <span class="string">"Mitre"</span> age 24</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6342&gt; HGET person name</span><br><span class="line"><span class="string">"Mitre"</span></span><br><span class="line">127.0.0.1:6342&gt; HGET person age</span><br><span class="line"><span class="string">"24"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3-3-list-双向链表"><a href="#3-3-list-双向链表" class="headerlink" title="3.3 list 双向链表"></a>3.3 list 双向链表</h2><p><strong>list 类型</strong> 是简单的字符串列表，按照插入顺序排序。<br>可以添加一个元素到列表的头部(左边)或者尾部 (右边).<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6342&gt; LPUSH langs <span class="string">"Java"</span> <span class="string">"C++"</span> <span class="string">"Python"</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6342&gt; LPUSH langs <span class="string">"C#"</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6342&gt; RPUSH langs <span class="string">"C"</span></span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6342&gt; LRANGE langs 0 10</span><br><span class="line">1) <span class="string">"C#"</span></span><br><span class="line">2) <span class="string">"Python"</span></span><br><span class="line">3) <span class="string">"C++"</span></span><br><span class="line">4) <span class="string">"Java"</span></span><br><span class="line">5) <span class="string">"C"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="3-4-set"><a href="#3-4-set" class="headerlink" title="3.4 set"></a>3.4 set</h2><p><strong>set 类型</strong> 是 string 类型的无序集合.<br>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1).<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6342&gt; SADD companies <span class="string">"IBM"</span> <span class="string">"google"</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6342&gt; SADD companies <span class="string">"amazon"</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6342&gt; SMEMBERS companies</span><br><span class="line">1) <span class="string">"google"</span></span><br><span class="line">2) <span class="string">"IBM"</span></span><br><span class="line">3) <span class="string">"amazon"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set 插入重复数据时, 会忽略掉本次插入</span></span><br><span class="line">127.0.0.1:6342&gt; SADD companies <span class="string">"amazon"</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure></p>
<h2 id="3-5-zset"><a href="#3-5-zset" class="headerlink" title="3.5 zset"></a>3.5 zset</h2><p>zset 和 set 一样也是 string类型 元素的集合, 且不允许重复的成员.<br>不同的是 每个元素 都会关联一个 double类型 的分数.<br>redis正是通过分数来为集合中的成员进行从小到大的排序.<br>zset的成员是唯一的, 但分数 (score) 可以重复.<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6342&gt; ZADD billboard 3 <span class="string">"Mitre"</span> 6 <span class="string">"Cherry"</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6342&gt; ZADD billboard 1 <span class="string">"Owen"</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6342&gt; ZRANGEBYSCORE billboard 0 10</span><br><span class="line">1) <span class="string">"Owen"</span></span><br><span class="line">2) <span class="string">"Mitre"</span></span><br><span class="line">3) <span class="string">"Cherry"</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/17/RabbitMQ-安装和内置命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/17/RabbitMQ-安装和内置命令/" itemprop="url">RabbitMQ 安装和内置命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-17T18:40:52+08:00">
                2019-09-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/消息中间件/" itemprop="url" rel="index">
                    <span itemprop="name">消息中间件</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-RabbitMQ-背景"><a href="#1-RabbitMQ-背景" class="headerlink" title="1. RabbitMQ 背景"></a>1. RabbitMQ 背景</h1><p>虽然在同步消息通讯的世界里有很多公开标准 (如 COBAR的 IIOP , 或者是 SOAP 等) .<br>但是在异步消息处理中却不是这样, 只有大企业有一些商业实现 (如微软的 MSMQ , IBM 的 Websphere MQ 等), 在 2006 年的 6 月, Cisco 、Redhat、iMatix 等联合制定了 AMQP (Advanced Message Queue, 高级消息队列协议).  </p>
<p>RabbitMQ 是一个 用 erlang 语言 编写的 AMQP 的 <strong>开源实现</strong> .  </p>
<p>RabbitMQ 是由 RabbitMQ Technologies Ltd 开发并且提供商业支持.<br>该公司在 2010年4月 被 SpringSource ( VMWare的一个部门 ) 收购.<br>在2013年5月被并入 Pivotal (Spring 框架就是 Pivotal 开发的).<br>其实 VMWare , Pivotal 和 EMC 本质上是一家的.  </p>
<h1 id="2-下载并安装-RabbitMQ"><a href="#2-下载并安装-RabbitMQ" class="headerlink" title="2. 下载并安装 RabbitMQ"></a>2. 下载并安装 RabbitMQ</h1><p>目前, RabbitMQ 最新的发布版本是 3.7.17 . 有关发行说明, 参见 <a href="https://www.rabbitmq.com/changelog.html" target="_blank" rel="noopener">changelog</a> .<br>安装方法参见这个 <a href="https://www.rabbitmq.com/download.html" target="_blank" rel="noopener">页面</a> . 不管是 Linux, BSD, UNIX, 还是 Windows, 还是 MacOS 都有对应的 安装指南.<br>最简单的安装方式 是用 <a href="https://www.rabbitmq.com/install-rpm.html#package-cloud" target="_blank" rel="noopener">PackageCloud Yum Repository</a> 安装.<br>安装步骤如下:  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">curl -s https://packagecloud.io/install/repositories/rabbitmq/erlang/script.rpm.sh | sudo bash</span><br><span class="line">yum -y install erlang</span><br><span class="line">curl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.rpm.sh | sudo bash</span><br><span class="line">yum -y install rabbitmq-server</span><br><span class="line"><span class="comment"># 查看 安装包信息</span></span><br><span class="line">yum info erlang</span><br><span class="line">yum info rabbitmq-server</span><br><span class="line"><span class="comment"># 启动 rabbitmq</span></span><br><span class="line">systemctl start rabbitmq-server</span><br></pre></td></tr></table></figure>
<p><strong>如果 安装主机无法上网, 那么就要采用离线安装了</strong>.  </p>
<p>简单说明一下, 如何 在 RedHat 6.7 上离线安装 RabbitMQ (工作环境的原因, 我就是这么安装的):<br>1, 下载 <a href="https://packagecloud.io/rabbitmq/erlang" target="_blank" rel="noopener">erlang-22.0.7-1.el6.x86_64.rpm</a>.<br>2, 下载 <a href="http://www.rpmfind.net/linux/rpm2html/search.php?query=socat(x86-64" target="_blank" rel="noopener">socat-1.7.2.3-1.el6.x86_64.rpm</a>), el 表示Red Hat <strong>Enterprise Linux</strong>, EL6 表示 企业版 Linux 6.x.<br>3, 下载<a href="https://www.rabbitmq.com/install-rpm.html#downloads" target="_blank" rel="noopener">rabbitmq-server-3.7.17-1.el6.noarch.rpm</a>.<br>4, 用 root 用户 执行如下命令:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -ivh erlang-22.0.7-1.el6.x86_64.rpm</span><br><span class="line">sudo rpm -ivh socat-1.7.2.3-1.el6.x86_64.rpm</span><br><span class="line">sudo rpm -ivh rabbitmq-server-3.7.17-1.el6.noarch.rpm</span><br></pre></td></tr></table></figure></p>
<p>5, 启动 RabbitMQ:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service rabbitmq-server start</span><br></pre></td></tr></table></figure></p>
<h1 id="3-RabbitMQ-基本概念"><a href="#3-RabbitMQ-基本概念" class="headerlink" title="3. RabbitMQ 基本概念"></a>3. RabbitMQ 基本概念</h1><p><strong><font color="#2eb82e">Broker</font></strong>: 简单来说就是消息队列服务器实体(代理).  </p>
<p><strong><font color="#2eb82e">Exchange</font></strong>: 消息交换机，它指定消息按什么规则，路由到哪个队列.  </p>
<p><strong>Queue</strong>: 消息队列载体，每个消息都会被投入到一个或多个队列.  </p>
<p><strong><font color="#2eb82e">Binding</font></strong>: 绑定，它的作用就是把exchange和queue按照路由规则绑定起来.  </p>
<p><strong>Routing Key</strong>: 路由关键字，exchange根据这个关键字进行消息投递.  </p>
<p><strong><font color="#2eb82e">vhost</font></strong>: 虚拟主机，一个broker里可以开设多个vhost，用作不同用户的权限分离.  </p>
<p><strong>channel</strong>: 消息通道，在客户端的每个连接里，可建立多个channel，每个channel代表一个会话任务.  </p>
<p><strong><font color="#2eb82e">producer</font></strong>: 消息生产者，就是投递消息的程序.  </p>
<p><strong><font color="#2eb82e">consumer</font></strong>: 消息消费者，就是接受消息的程序.  </p>
<h1 id="4-RabbitMQ-常用命令"><a href="#4-RabbitMQ-常用命令" class="headerlink" title="4. RabbitMQ 常用命令"></a>4. RabbitMQ 常用命令</h1><h2 id="4-1-服务启动与关闭"><a href="#4-1-服务启动与关闭" class="headerlink" title="4.1 服务启动与关闭"></a>4.1 服务启动与关闭</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动</span></span><br><span class="line">service rabbitmq-server start</span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">service rabbitmq-server stop</span><br><span class="line"><span class="comment"># 重启</span></span><br><span class="line">service rabbitmq-server restart</span><br></pre></td></tr></table></figure>
<h2 id="4-2-RabbitMQ-提供的-命令行工具"><a href="#4-2-RabbitMQ-提供的-命令行工具" class="headerlink" title="4.2 RabbitMQ 提供的 命令行工具"></a>4.2 RabbitMQ 提供的 命令行工具</h2><p>RabbitMQ comes with multiple <strong>Command Line Tools</strong>, Different tools cover different usage scenarios :</p>
<p><strong><font color="#8a00e6">rabbitmqctl</font></strong> for service management and general operator tasks.<br><strong><font color="#ff9900">rabbitmq-diagnostics</font></strong> for diagnostics and health checking.<br><strong><font color="#8a00e6">rabbitmq-plugins</font></strong>  for plugin management.<br><strong><font color="#ff9900">rabbitmqadmin</font></strong>  for operator tasks over HTTP API.  </p>
<p>以上 4 个 命令行工具 都可以用 help 参数 查看使用方法, 例如:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 rabbitmqctl 帮助</span></span><br><span class="line">rabbitmqctl <span class="built_in">help</span></span><br><span class="line"><span class="comment"># 查看 rabbitmqctl 添加用户帮助</span></span><br><span class="line">rabbitmqctl <span class="built_in">help</span> add_user</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 rabbitmq-plugins 帮助</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">help</span></span><br></pre></td></tr></table></figure></p>
<p>静下心来把 帮助文档 读一遍, 同时把 <a href="https://www.rabbitmq.com/cli.html" target="_blank" rel="noopener">官网说明</a> 读一遍, 基本上所有命令就都能理解了.  </p>
<hr>
<p>简单看下 <strong><font color="#8a00e6">rabbitmqctl</font></strong> 和 <strong><font color="#8a00e6">rabbitmq-plugins</font></strong> 命令行工具 提供的的常用命令 .  </p>
<p><strong><font color="#8a00e6">rabbitmqctl</font></strong> 是 RabbitMQ 附带的原生的 CLI 工具(CLI tool).  </p>
<p><strong><font color="#8a00e6">rabbitmqctl</font></strong> 主要提供一些 管理操作:  </p>
<ul>
<li>Stopping node  </li>
<li>Access to node status, effective configuration, health checks  </li>
<li><strong>Virtual host management</strong>  </li>
<li>User and permission management  </li>
<li>Policy management  </li>
<li>Listing queues, connections, channels, exchanges, consumers  </li>
<li><strong>Cluster membership management</strong>  </li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用户列表</span></span><br><span class="line">rabbitmqctl list_users</span><br><span class="line"><span class="comment"># 新增</span></span><br><span class="line">rabbitmqctl add_user mitre mitre</span><br><span class="line"><span class="comment"># 删除</span></span><br><span class="line">rabbitmqctl delete_user mitre</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置角色</span></span><br><span class="line">rabbitmqctl set_user_tags mitre administrator</span><br><span class="line"><span class="comment"># 设置用户权限 和 vhost</span></span><br><span class="line"><span class="comment"># rabbitmqctl  set_permissions  [--vhost &lt;vhost&gt;] &lt;username&gt; &lt;conf&gt; &lt;write&gt; &lt;read&gt;</span></span><br><span class="line">rabbitmqctl  set_permissions  --vhost / mitre . . .</span><br></pre></td></tr></table></figure>
<p><strong><font color="#8a00e6">rabbitmq-plugins</font></strong> is a tool that <strong>manages plugins</strong>: lists, enables and disables them.  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出所有 插件</span></span><br><span class="line">rabbitmq-plugins list</span><br><span class="line"><span class="comment"># 启用 web 页面管理插件</span></span><br><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management</span><br></pre></td></tr></table></figure>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p>1 <a href="https://www.rabbitmq.com/download.html" target="_blank" rel="noopener">Downloading and Installing RabbitMQ</a><br>2 <a href="https://blog.csdn.net/Alger_magic/article/details/82868267" target="_blank" rel="noopener">Centos7 离线安装RabbitMQ,并配置集群</a><br>3 <a href="https://www.cnblogs.com/dwlsxj/p/RabbitMQ.html" target="_blank" rel="noopener">RabbitMQ基础知识</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/03/道阻且长/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/03/道阻且长/" itemprop="url">道阻且长</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-03T17:29:54+08:00">
                2019-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="燥热的夏天"><a href="#燥热的夏天" class="headerlink" title="燥热的夏天"></a>燥热的夏天</h1><p>2018 年 7 月 2 号, 只身一人来到江阴(江阴农商行), 带着迷茫和不安, 第一份工作, 我不知道自己能干什么.<br>一周的时间 掌握了 增删改查 前后端代码(当然, 这依赖于框架的便利).<br>又用一周的时间掌握了 客户端 与 服务端接口的开发(同样, 这依赖于框架和ESB的便利).<br>接下来一直到9月底, 每天加班, 边学边工作, 和克乾两个人 完成了 “物联网动产贷” 项目的大半开发工作.<br>9月底, 项目上线.  </p>
<p>项目中用到的框架 是 宇信 产品部开发的 EMP 框架, 框架底层实现基于 SSM (SpringMVC+Spring+MyBatis) web框架.  </p>
<p>整体架构:<br>servlet 容器(开发在 Tomcat 中运行, 以 war 包方式 发布在 WebLogic 中运行).<br><del>druid 连接池?</del> 不记得用的是什么连接池了, 事务控制 是java原生的 java.sql.Connection 控制的.<br>SSM框架, EMP封装后 开发基本上就是配置, 写一写 SQL 语句.<br>Oracle 数据库.<br>构建工具, 好像是 ant.<br>版本控制工具, svn.<br>freemarker 模板引擎, 用于生成 部分 java 类 和 xml 配置.<br>IBM 的 AIX 服务器.  </p>
<p>感触:<br>江阴农商行非常棒, 领导 nice, 同事 nice, 测试 nice.<br>web 后端技术方面, 比较落后, 还在使用 Java 5 (Java 最新版本是 Java SE 12).  </p>
<p>在江阴农商行 待了 将近 7 个月, 首次接触到 web 框架, 读框架源码, 学习 servlet, Java 多线程 和 反射, Oracle, WebLogic 等等, 这 7 个月加了很多班, 也学到了很多.  </p>
<h1 id="贫瘠的春天"><a href="#贫瘠的春天" class="headerlink" title="贫瘠的春天"></a>贫瘠的春天</h1><p>2019 年 2 月 13 号, 年后上班的第二天, 我被调到了常州(江南农商行).<br>我们部门最大的项目组 在 江南农商行 , 基本上整个部门里能力最强的 项目经理 都在这里了.   </p>
<p>“信贷集中作业平台” , 这是我做的第二个 web 项目.<br>这个项目一期的工作就是 集中管理 30 多个 业务系统, 工作内容和江阴完全一样, 而且996 工作制.   </p>
<p>干了两个月, 一期项目上线了, 我也提离职了, 原因是 “工作中所用的 web 技术太过陈旧”.   </p>
<p>感触:<br><strong>只有把时间用在对的地方, 才能创造出美丽的东西.</strong><br>我在江南一直为项目尽心尽力, 其间, 因为加班发了一次烧, 一个人在医院吊水到半夜…<br>人生中最苦逼 的两个月, 已经没有不走的理由了.  </p>
<h1 id="4月"><a href="#4月" class="headerlink" title="4月"></a>4月</h1><p>2019 年 4 月 17 号 下午, 我来到了上海, 直接到 兴业银行 的项目组报到(之前没有辞职成功, 被调到了上海).    </p>
<p>这次的项目 是一个 微服务架构 的 “资产托管系统”.  </p>
<p>辛总(项目经理) 直接问了我一下技术问题, 包括 Spring Cloud, dubbo, 分布式, 微服务等, 对这一类技术我了解一点, 仅此而已.  </p>
<p>于是, 每天 6 点下班后, 回到住所学习(主要是看视频), 学到 夜里1点多, 早上 8:50 起床, 9:30 之前到公司.<br>坚持一个多月以后, 我才把工作中遇到的技术上的问题全部被攻克.  </p>
<p>然后, 辛总让我一个人 用 Spring Batch 重构 数据读取模块(从 flat 文件, dbf, xml, excel, log 文件中读取数据,加工处理, 插入数据库表. 同时支持配置化读取, 多文件混合读取), 项目组中没有一个人会用 Spring Batch.<br>我边自学边开发(辛总在 job 内的 step 分区方面给了我很大帮助), 大约用了一个月的时间, 重构开发工作完成.  </p>
<p>架构:<br>Spring boot: starter 依赖的支持 减少了太多的配置.<br>Spring Cloud : 注册中心, 网关, uaa(User Account and Authentication).<br>SpringMVC.<br>ORM 框架 MyBatis.<br>Oracle 数据库.<br>构建工具 Maven.<br>版本控制工具 svn.<br>缓存 Redis.<br>Spring Batch 和 RabbitMQ.<br>Nginx.<br>前端: 基于 vue 的 YuFp 前端框架(公司产品部开发).  </p>
<p>感触:<br>2019 年 7 月 3 号, 工作已经一年了, 时间过得太快了.<br>道阻且长, 必须要目标明确.  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/27/CentOS7-自动备份数据库-oracle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/27/CentOS7-自动备份数据库-oracle/" itemprop="url">CentOS7 定时备份数据库-oracle</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-27T17:17:35+08:00">
                2019-06-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-命令行-导入-导出-数据库表"><a href="#1-命令行-导入-导出-数据库表" class="headerlink" title="1 命令行 导入/导出 数据库表"></a>1 命令行 导入/导出 数据库表</h1><p>导入/导出 oracle 数据库的表里的数据, 需要用到 oracle 数据库的两个命令: <code>imp</code> 和 <code>exp</code>.<br><a href="https://mitrecx.github.io/2019/01/03/CentOS7-%E5%AE%89%E8%A3%85-Oracle-Database-12c-R2/" target="_blank" rel="noopener">安装</a>过数据库的机器, 就会有这两个命令.  </p>
<h2 id="1-1-exp-导出数据"><a href="#1-1-exp-导出数据" class="headerlink" title="1.1 exp 导出数据"></a>1.1 exp 导出数据</h2><p><code>exp</code> 导出 faext用户下的 所有的表(包括表结构和数据), 存储过程, 视图等:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp faext/password@47.96.111.222:1521/S460 file=/home/oracle/Documents/test.dmp owner=faext</span><br></pre></td></tr></table></figure></p>
<p>导出参数解释 :<br><code>exp</code> <strong><font color="#2eb82e">用户名/密码@数据库ip:端口/SID</font> <font color="#ff9900">file=导出文件名称</font> <font color="#1a75ff">owner=数据用户名</font></strong>    </p>
<p>仅仅导出某几张表 :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp faext/password@47.96.111.222:1521/S460 file=/home/oracle/Documents/test.dmp tables=tableName1, tableName2</span><br></pre></td></tr></table></figure></p>
<p>exp 命令 有许多参数可以选择, 参考 :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp <span class="built_in">help</span>=y</span><br></pre></td></tr></table></figure></p>
<h2 id="1-2-imp-导入数据"><a href="#1-2-imp-导入数据" class="headerlink" title="1.2 imp 导入数据"></a>1.2 imp 导入数据</h2><p>把 20190627.dmp 文件中的数据 全部(full=y)导入 指定数据库中:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp system/oracle@localhost:1521/S460 file=/home/oracle/Documents/20190627.dmp full=y</span><br></pre></td></tr></table></figure></p>
<p>把 20190627.dmp 文件中的 指定表 tableName1 的数据 导入指定数据库中:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp system/oracle@localhost:1521/S460 file=/home/oracle/Documents/20190627.dmp tables=tableName1</span><br></pre></td></tr></table></figure></p>
<p>imp 命令 有许多参数可以选择, 参考:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imp <span class="built_in">help</span>=y</span><br></pre></td></tr></table></figure></p>
<h1 id="2-Linux-定时任务"><a href="#2-Linux-定时任务" class="headerlink" title="2 Linux 定时任务"></a>2 Linux 定时任务</h1><p>CentOS 定时任务 是 通过 <strong>cron(crond) 系统服务</strong> 来控制的.  这个系统服务是默认是 开机启动的.<br>查看 <strong>cron(crond) 系统服务</strong> :<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service crond status</span><br></pre></td></tr></table></figure></p>
<h2 id="2-1-定时任务示例"><a href="#2-1-定时任务示例" class="headerlink" title="2.1 定时任务示例"></a>2.1 定时任务示例</h2><p>配置 <strong>crontab</strong> 实现 定时执行 指定的脚本:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开配置文件:  </span></span><br><span class="line">crontab -e</span><br><span class="line"></span><br><span class="line"><span class="comment">#把 以下内容 复制到 配置文件中</span></span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">MAILTO=oracle</span><br><span class="line">*/1 * * * * date &gt; /home/oracle/Documents/1.txt</span><br></pre></td></tr></table></figure></p>
<p>这样就完成了一个简单的 <strong>定时任务</strong>:<br>每分钟执行一次 <code>date</code> 命令, 把执行结果 写入1.txt 文件.   </p>
<p>查看定时任务配置:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br></pre></td></tr></table></figure></p>
<p>查看定时任务 执行 <strong>日志</strong>:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tail -f /var/<span class="built_in">log</span>/cron</span><br></pre></td></tr></table></figure></p>
<p>回看一下 定时任务的 配置文件:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># SHELL环境变量</span><br><span class="line">SHELL=/bin/bash</span><br><span class="line"># PATH环境变量</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">#邮件发送给指定的用户</span><br><span class="line">MAILTO=oracle</span><br><span class="line"></span><br><span class="line"># 每分钟执行一次</span><br><span class="line">*/1 * * * * date &gt; /home/oracle/Documents/1.txt</span><br></pre></td></tr></table></figure></p>
<p>crontab 配置中 有一个坑:<br><strong>所有的 用户的环境变量 都会失效</strong> !<br><strong>系统自带的环境变量会失效, 自己配置的环境变量也会失效.</strong>    </p>
<p>从上面的内容可以看到 配置了 <strong>PATH</strong> 环境变量, 这样我们才能 各个 bin 中的命令.  </p>
<p><strong><font color="#8a00e6">crontab 文件定时代码格式</font></strong>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minute hour day month week command</span><br></pre></td></tr></table></figure></p>
<p><strong><font color="#1a75ff">minute</font></strong>: 表示分钟，可以是从0到59之间的任何整数。<br><strong><font color="#1a75ff">hour</font></strong>: 表示小时，可以是从0到23之间的任何整数。<br><strong><font color="#1a75ff">day</font></strong>: 表示日期，可以是从1到31之间的任何整数。<br><strong><font color="#1a75ff">month</font></strong>: 表示月份，可以是从1到12之间的任何整数。<br><strong><font color="#1a75ff">week</font></strong>: 表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。<br><strong><font color="#1a75ff">command</font></strong>: 要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。  </p>
<p>星号 (*)：代表所有可能的值，例如: month字段是星号 表示 (在满足其它字段的制约条件后) 每月都执行该任务.<br>逗号 (,)：用逗号隔开的值指定一个列表范围，例如: hour段 “1,4,17” 表示 1点4点17点执行该任务.<br>正斜线 (/)：正斜线指定时间的间隔频率，例如: minute段 “*/2” 表示每(间隔)两分钟执行一次.  </p>
<h2 id="2-2-定时备份数据库表"><a href="#2-2-定时备份数据库表" class="headerlink" title="2.2 定时备份数据库表"></a>2.2 定时备份数据库表</h2><p>shell 脚本如下, (每天)备份 faext 用户的所有数据,  只保留 10天 之内的备份文件:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">. /etc/profile</span><br><span class="line"><span class="comment"># set environment variable</span></span><br><span class="line">. /home/oracle/.bash_profile</span><br><span class="line"></span><br><span class="line">bakPath=<span class="string">'/home/oracle/Documents/faextDBBak'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">currentDate=`date +%Y%m%d`;</span><br><span class="line"></span><br><span class="line"><span class="comment"># remove data 10 days ago</span></span><br><span class="line">find <span class="variable">$&#123;bakPath&#125;</span> -mtime +10 -name <span class="string">"*.dmp"</span> -<span class="built_in">exec</span> rm -rf &#123;&#125; \;</span><br><span class="line"></span><br><span class="line"><span class="comment"># back up remote database tables</span></span><br><span class="line">/u01/app/oracle/product/12.2.0.1/db_1/bin/exp faext/passwd@47.96.111.222:1521/S460 file=<span class="variable">$&#123;bakPath&#125;</span>/<span class="variable">$&#123;currentDate&#125;</span>.dmp owner=faext &amp;&gt; /dev/null;</span><br><span class="line"></span><br><span class="line"><span class="comment"># chmod</span></span><br><span class="line">chmod 755 <span class="variable">$&#123;bakPath&#125;</span>/<span class="variable">$&#123;currentDate&#125;</span>.dmp;</span><br></pre></td></tr></table></figure></p>
<p>crontab 文件(<code>crontab -e</code>)配置 如下, 每天 19:00 执行定时任务:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SHELL=/bin/bash</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">MAILTO=oracle</span><br><span class="line"></span><br><span class="line"># For details see man 4 crontabs</span><br><span class="line"></span><br><span class="line"># Example of job definition:</span><br><span class="line"># .---------------- minute (0 - 59)</span><br><span class="line"># |  .------------- hour (0 - 23)</span><br><span class="line"># |  |  .---------- day of month (1 - 31)</span><br><span class="line"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="line"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="line"># |  |  |  |  |</span><br><span class="line"># *  *  *  *  * user-name  command to be executed</span><br><span class="line">0 19 * * * sh /home/oracle/Documents/faextDBBak/DBBak.sh</span><br></pre></td></tr></table></figure></p>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h2><p>一: <strong><font color="red">crontab 默认是没有 环境变量的</font></strong>, 一定要自己配置, 否则定时任务不会成功执行.<br>二: /etc/crontab 是 root 级的定时任务配置文件, 普通用户 用<code>crontab -e</code> 配置.  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/20/设计模式-2-装饰者模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/20/设计模式-2-装饰者模式/" itemprop="url">设计模式-2 装饰者模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-20T18:35:53+08:00">
                2019-05-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/20/设计模式-1-策略模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/20/设计模式-1-策略模式/" itemprop="url">设计模式-1 策略模式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-20T18:30:46+08:00">
                2019-05-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/设计模式/" itemprop="url" rel="index">
                    <span itemprop="name">设计模式</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-策略模式简介"><a href="#1-策略模式简介" class="headerlink" title="1 策略模式简介"></a>1 策略模式简介</h1><p>先看一下 策略模式 的定义:<br>策略模式 定义了一个 <strong>算法/策略族</strong>, 把族内各个 算法/策略 分别封装起来, 让他们之间可以 <strong>相互替换</strong> .<br>此模式让 <strong>算法的变化</strong> 独立于 算法的调用者.  </p>
<p>可以简单的理解为: 封装策略族.  </p>
<p>策略模式 包含了 三种 <strong>OO设计原则</strong> :<br>1, <strong>封装变化</strong>.<br>2, <strong>针对接口编程, 不针对实现编程</strong>.<br>3, <strong>多用组合(composition) , 少用继承(inheritance)</strong>.  </p>
<p>先看一个 UML 图, 它是介绍 策略模式 的一个简单例子. 例子虽简单, 但足以让读者理解 策略模式.<br>例子来源于 “HeadFirst 设计模式” 这本书.    </p>
<p><img src="https://mitre.oss-cn-hangzhou.aliyuncs.com/blog2019/pic09/strategyP1.png" alt></p>
<h1 id="2-慢慢走近策略模式"><a href="#2-慢慢走近策略模式" class="headerlink" title="2 慢慢走近策略模式"></a>2 慢慢走近策略模式</h1><p>设计一个模拟鸭子的应用:<br>1, 鸭子的种类有多种.<br>如, 红头鸭, 绿头鸭, 橡皮鸭, 北京烤鸭等.<br>2, 每种鸭子的外部特征(display) <strong>都不一样</strong> .<br>如, 红头鸭 头是红色的, 绿头鸭 头是绿色的, 橡皮鸭 是黄色的玩具鸭…<br>3, 每种鸭子的飞行(fly)行为, 鸣叫(quack)行为 <strong>可能一样, 也可能不一样</strong>.<br>如, 红头鸭 和 绿头鸭 一次能飞 几百米远, 橡皮鸭 和 北京烤鸭 不会飞. 红头鸭 呱呱叫, 绿头鸭 嘎嘎叫, 橡皮鸭和北京烤鸭不会叫.    </p>
<h2 id="2-1-用继承-来完成鸭子应用"><a href="#2-1-用继承-来完成鸭子应用" class="headerlink" title="2.1 用继承 来完成鸭子应用"></a>2.1 用继承 来完成鸭子应用</h2><p>设计一个 抽象的 鸭子超类(superclass) :  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> Duck&#123;</span><br><span class="line">    <span class="comment">//每种鸭子的外部特征 都不一样</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">"能飞很远"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">"呱呱叫"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>红头鸭 , 绿头鸭, 橡皮鸭 分别 继承 Duck 类:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedheadDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.print(<span class="string">"头是红色的鸭子"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GreenheadDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.print(<span class="string">"头是绿色的鸭子"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.print(<span class="string">"嘎嘎叫"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RubberDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.print(<span class="string">"黄色的橡皮玩具鸭"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      System.out.print(<span class="string">"不会飞"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.print(<span class="string">"不会叫"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>三种鸭子(红头鸭 , 绿头鸭, 橡皮鸭 ) 都 实现(重写) 了 Duck 类 的 display 方法. 同时, 每种鸭子按照自身特性决定要不要 重写 fly 方法 和 quack 方法.  </p>
<p>利用 <strong>继承</strong> 带来的 缺点:<br>1, 代码在多个子类中 重复.<br>2, 很难知道鸭子的全部行为. 比如, 以后要在 Duck 中加一个 游泳/潜水方法 swim(), 每个子类都要加, 如果有几十种鸭子, 就比较糟糕了.<br>3, <strong>运行时的行为不能改变</strong>.  </p>
<p>这种 只利用 <strong>继承</strong> 完成的 鸭子应用 并不可取.<br>下面 看一下 用 <strong>接口</strong> 来 完成 鸭子应用.  </p>
<h2 id="2-2-利用接口-完成鸭子应用"><a href="#2-2-利用接口-完成鸭子应用" class="headerlink" title="2.2 利用接口 完成鸭子应用"></a>2.2 利用接口 完成鸭子应用</h2><p>设计一个 抽象的 鸭子超类(superclass) :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> Duck&#123;</span><br><span class="line">    <span class="comment">//每种鸭子的外部特征 都不一样</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>设计 一个 飞行接口 Flyable:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Flyable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>设计 一个 鸣叫接口 Quackable:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Quackable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>有了 Duck类, Flyable接口, Quackable接口, 就可以让 所有的鸭子类都 <strong>继承</strong> Duck 类, <strong>实现</strong> Flyable 和 Quackable 接口.   </p>
<p>利用 <strong>接口</strong> 依然存在 缺点:<br>1, 代码在多个子类中 重复.<br>2, 很难知道鸭子的全部行为. 比如, 以后要加一个 游泳/潜水方法 swim(), 可以写一个 Swimable接口, 让所有鸭子实现, 鸭子类多的话 实现起来也比较糟糕.<br>3, Flyable接口, Quackable接口 运行时可以改变. 但是从鸭子对象的角度来看, <strong>运行时的行为 依然不能改变</strong>.  </p>
<p>可以看出, 单纯地 用 <strong>接口</strong> 或 用 <strong>继承</strong> 来 完成 鸭子应用, 都是有很大缺陷的.  </p>
<h1 id="3-策略模式"><a href="#3-策略模式" class="headerlink" title="3 策略模式"></a>3 策略模式</h1><p><strong><font color="#ff9900">设计原则-封装变化</font></strong>:<br>找出应用中 可能需要变化的部分, 把它们独立出来, 不要和那些不需要变化的代码混在一起.  </p>
<p><strong>封装变化</strong> 的设计原则, 可以这样理解:<br>把 <strong>会变化的部分 取出并封装起来</strong>, 以便以后可以 改动或扩充此部分, 而不会影响其他不需要变化的部分.  </p>
<p><strong>封装变化</strong> , 几乎是每个设计模式背后的 精神所在.  </p>
<h2 id="3-1-策略模式-封装变化的部分"><a href="#3-1-策略模式-封装变化的部分" class="headerlink" title="3.1 策略模式-封装变化的部分"></a>3.1 策略模式-封装变化的部分</h2><p>Duck 类 的 fly() 和 quack() 会随着鸭子的不同 而 不同.<br>但是 有些鸭子的 fly() 或 quack() 是相同的.  </p>
<p>如此这般, 我们可以 把鸭子变化的 行为封装起来.  </p>
<p><strong>为什么 封装 fly 和 quack, 却不封装 display()</strong> ?<br>这里只是为了说明 策略模式 的思想,  如果愿意的话 也可以 封装 display, 毕竟 display 也是 变化的部分.<br>设计模式 是一些构造 <strong>面向对象编程的 经验的总结</strong>, 利用设计模式 可以 设计出 <strong>弹性的,可复用的,易维护的</strong> 的系统.<br>如果没有 <strong>设计模式</strong> 可用, 可以参照 <strong>OO设计原则</strong> 进行设计.  </p>
<p>要注意, 我们利用 <strong>设计模式</strong> 的目的是 设计出 <strong>弹性的,可复用的,易维护的</strong> 的系统.<br>如果能达到此目的, 不一定非要 “一毫不差” 地 套用 设计模式.<br>事实上, 工作中的设计 通常会涉及到 多种设计模式混合使用.  </p>
<p><strong><font color="#ff9900">设计原则-针对接口编程</font></strong>:<br>针对 <strong>接口</strong> 编程, 而不是针对 <strong>实现</strong> 编程.  </p>
<p>设计 两个 接口 FlyBehavior 和 QuackBehavior.<br>FlyBehavior 用于 指定鸭子的 飞行行为:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>QuackBehavior 用于 指定鸭子的 鸣叫行为:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在, <strong>不让 Duck 实现 FlyBehavior 和 QuackBehavior</strong>, 而是 用 指定的 实现类 实现这两个接口. 这样就可以 <strong>复用</strong> 实现类的实现.  </p>
<p>FlyBehavior 和 QuackBehavior 的实现类如下(把它们都写在一起为了方便阅读) :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyLongDistance</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"一次 能飞50米~~~~~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyNoWay</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"不会飞~"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuackGaGa</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"嘎.嘎..嘎嘎嘎嘎...."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuackMute</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"不会叫."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="3-2-策略模式-把变化的实现-组合起来"><a href="#3-2-策略模式-把变化的实现-组合起来" class="headerlink" title="3.2 策略模式-把变化的实现 组合起来"></a>3.2 策略模式-把变化的实现 组合起来</h2><p><strong><font color="#ff9900">设计原则- 多用组合, 少用继承</font></strong>:<br>“有一个”(组合) 可能比 “是一个”(继承) 更好.  </p>
<p>每一种鸭子 都有 一个 FlyBehavior 和一个 QuackBehavior . 这样好将鸭子的 飞行行为 和 鸣叫行为 交给 FlyBehavior 和 QuackBehavior 处理.<br>而 Duck 要做的就是 把 这些 行为对象 <strong>组合</strong> 起来.  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> FlyBehavior flyBehavior;</span><br><span class="line">    <span class="keyword">private</span> QuackBehavior quackBehavior;</span><br><span class="line">    <span class="comment">// 鸭子的样子</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">// 鸭子飞</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        flyBehavior.fly();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 鸭子叫</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        quackBehavior.quack();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// setter</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFlyBehavior</span><span class="params">(FlyBehavior flyBehavior)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.flyBehavior = flyBehavior;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuackBehavior</span><span class="params">(QuackBehavior quackBehavior)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.quackBehavior = quackBehavior;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用 <strong>策略模式</strong> 编写的 鸭子应用 已经完成了, 再看一遍 开篇的 UML 图:<br><img src="https://mitre.oss-cn-hangzhou.aliyuncs.com/blog2019/pic09/strategyP1.png" alt>  </p>
<h2 id="3-3-测试"><a href="#3-3-测试" class="headerlink" title="3.3 测试"></a>3.3 测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    FlyBehavior flyLong = <span class="keyword">new</span> FlyLongDistance();</span><br><span class="line">    FlyBehavior flyNoWay = <span class="keyword">new</span> FlyNoWay();</span><br><span class="line">    QuackBehavior quackGaGa = <span class="keyword">new</span> QuackGaGa();</span><br><span class="line">    QuackBehavior quackMute = <span class="keyword">new</span> QuackMute();</span><br><span class="line"></span><br><span class="line">    Duck redheadDuck = <span class="keyword">new</span> RedheadDuck(flyLong, quackGaGa);</span><br><span class="line">    Duck rubberDuck = <span class="keyword">new</span> RubberDuck(flyNoWay, quackMute);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"红头鸭出场: "</span>);</span><br><span class="line">    redheadDuck.display();</span><br><span class="line">    redheadDuck.fly();</span><br><span class="line">    redheadDuck.quack();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n橡皮鸭出场: "</span>);</span><br><span class="line">    rubberDuck.display();</span><br><span class="line">    rubberDuck.fly();</span><br><span class="line">    rubberDuck.quack();</span><br><span class="line">    System.out.println(<span class="string">"-----给橡皮鸭装一个喇叭------"</span>);</span><br><span class="line">    rubberDuck.setQuackBehavior(quackGaGa);</span><br><span class="line">    rubberDuck.quack();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">红头鸭出场:</span><br><span class="line">红头鸭: 头是红色</span><br><span class="line">一次 能飞50米~~~~~</span><br><span class="line">嘎.嘎..嘎嘎嘎嘎....</span><br><span class="line"></span><br><span class="line">橡皮鸭出场:</span><br><span class="line">黄色的橡皮鸭</span><br><span class="line">不会飞~</span><br><span class="line">不会叫.</span><br><span class="line">-----给橡皮鸭装一个喇叭------</span><br><span class="line">嘎.嘎..嘎嘎嘎嘎....</span><br></pre></td></tr></table></figure></p>
<h1 id="4-策略模式应用"><a href="#4-策略模式应用" class="headerlink" title="4 策略模式应用"></a>4 策略模式应用</h1><p>在 jdk 中的应用:<br>Comparator<t> 接口是一个 比较器, 用于指定 比较规则.<br>工具类 Arrays 提供了一个 自然顺序比较器 NaturalOrder(实现了 Comparator<t> 接口), Arrays 的 sort() 方法 利用 NaturalOrder 实现大小排序.<br>Arrays 的众多 sort() 重载方法中, 有 需要传入 Comparator<t> 参数的 sort() 方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] a, Comparator&lt;? <span class="keyword">super</span> T&gt; c)</span></span></span><br></pre></td></tr></table></figure></t></t></t></p>
<p>这样我们可以根据 需要, 选用不同的 比较器.  </p>
<p>可以看出:<br>Comparator<t> 就是 <strong>策略族接口</strong>, NaturalOrder 是 Comparator 的 具体实现 (用户可以自行实现更多的 Comparator), Array 的 sort() 方法 根据传入的不同的 Comparator 来在 运行时 改变排序规则.   </t></p>
<p>策略模式的 现实应用场景:<br>不同 会员等级 的打折, 大众会员不打折, 黄金会员打9折, 白金会员打8折…</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1 <a href="https://www.cnblogs.com/lewis0077/p/5133812.html" target="_blank" rel="noopener">深入解析策略模式</a><br>2 <a href>HeadFirst 设计模式</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/16/第三范式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/16/第三范式/" itemprop="url">第三范式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-16T17:54:12+08:00">
                2019-05-16
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关系数据库中的关系必须满足一定的要求。<br>数据库的 <strong>范式</strong> 是数据库设计所需要满足的规范。<br>只有理解数据库的范式，才能设计出高效率、优雅的数据库，否则可能会设计出错误的数据库.  </p>
<p>主要有六种范式：<br>第一范式.<br>第二范式.<br><strong>第三范式</strong>.<br>BC范式.<br>第四范式.<br>第五范式.<br>满足最低要求的叫第一范式，简称 <strong>1NF</strong> . 在第一范式基础上进一步满足一些要求的为第二范式，简称 <strong>2NF</strong> . 其余依此类推.</p>
<p>范式越高:<br>优点: 可以避免数据冗余.<br>缺点: 性能就会越差, 需要联系多个表才能得到所需要数据, 并且操作会 更困难.  </p>
<p>权衡利弊, <strong>一般项目会使用 第三范式</strong>.<br>数据冗余小, 且 方便管理.  </p>
<h1 id="第一范式-1NF"><a href="#第一范式-1NF" class="headerlink" title="第一范式(1NF)"></a>第一范式(1NF)</h1><p>1NF是关系模式应具备的 最起码的条件，<strong>如果数据库设计不能满足第一范式，就不称为关系型数据库</strong>.  </p>
<p>定义：如果 关系模式R 的每个 关系r 的属性都是不可分的数据项，那么就称R是第一范式的模式.<br>例如 (学生信息表)：  </p>
<table>
<thead>
<tr>
<th>学生编号</th>
<th>姓名</th>
<th>性别</th>
<th>联系方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>20080901</td>
<td>张三</td>
<td>男</td>
<td>email:zs@126.com,phone:88886666</td>
</tr>
<tr>
<td>20080902</td>
<td>李四</td>
<td>女</td>
<td>email:ls@126.com,phone:66668888</td>
</tr>
</tbody>
</table>
<p>以上的表就不符合，第一范式：联系方式字段可以再分.<br>满足 第一范式(1NF) 的表结构应该如下:  </p>
<table>
<thead>
<tr>
<th>学生编号</th>
<th>姓名</th>
<th>性别</th>
<th>电子邮件</th>
<th>电话</th>
</tr>
</thead>
<tbody>
<tr>
<td>20080901</td>
<td>张三</td>
<td>男</td>
<td>zs@126.com</td>
<td>88886666</td>
</tr>
<tr>
<td>20080902</td>
<td>李四</td>
<td>女</td>
<td>ls@126.com</td>
<td>66668888</td>
</tr>
</tbody>
</table>
<h1 id="第二范式（2NF）"><a href="#第二范式（2NF）" class="headerlink" title="第二范式（2NF）"></a>第二范式（2NF）</h1><p>定义：如果 关系模式R 是 1NF，且每个 非主属性 <strong>完全函数依赖于</strong> <a href="https://www.jianshu.com/p/8743a3414537" target="_blank" rel="noopener">候选键</a>，那么就称R是第二范式.  </p>
<p>例如 (产品流水凭证模板表), 产品代码 和 交易类型 是联合 <strong>主键</strong>:  </p>
<table>
<thead>
<tr>
<th>产品代码</th>
<th>交易类型</th>
<th>产品名称</th>
<th>凭证模板代码</th>
<th>差额凭证模板代码</th>
</tr>
</thead>
<tbody>
<tr>
<td>p1</td>
<td>666</td>
<td>产品A</td>
<td>t1</td>
<td>tt1</td>
</tr>
<tr>
<td>p2</td>
<td>777</td>
<td>产品B</td>
<td>t2</td>
<td>tt1</td>
</tr>
<tr>
<td>p1</td>
<td>888</td>
<td>产品A</td>
<td>t1</td>
<td>tt1</td>
</tr>
</tbody>
</table>
<p>通过  产品代码 和 交易类型 可以确定 凭证模板代码, 差额凭证模板代码, 产品名称,  所以 可以把 (产品代码, 交易类型) 作为主键.<br>但是, 产品名称 并不完全 依赖于 (产品代码, 交易类型), 只要 产品代码 就能确定 产品名称, 这种依赖叫 <strong>不完全依赖</strong> (或部分依赖).</p>
<p>第二范式 不能有 <strong>不完全依赖</strong> .  </p>
<p>修改后, 满足第二范式:  </p>
<table>
<thead>
<tr>
<th>产品代码</th>
<th>交易类型</th>
<th>凭证模板代码</th>
<th>差额凭证模板代码</th>
</tr>
</thead>
<tbody>
<tr>
<td>p1</td>
<td>666</td>
<td>t1</td>
<td>tt1</td>
</tr>
<tr>
<td>p2</td>
<td>777</td>
<td>t2</td>
<td>tt1</td>
</tr>
<tr>
<td>p1</td>
<td>888</td>
<td>t1</td>
<td>tt1</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>产品代码</th>
<th>产品名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>p1</td>
<td>产品A</td>
</tr>
<tr>
<td>p2</td>
<td>产品B</td>
</tr>
</tbody>
</table>
<h1 id="第三范式（3NF）"><a href="#第三范式（3NF）" class="headerlink" title="第三范式（3NF）"></a>第三范式（3NF）</h1><p>定义: 首先要满足第二范式，其次 <strong>非主属性</strong> 之间不存在函数依赖.  </p>
<p>由于满足了第二范式，表示每个 非主属性 都函数依赖于 主键。如果 非主属性 之间存在了 函数依赖，就会存在 <strong>传递依赖</strong>，这样就不满足第三范式。</p>
<p>例如 (产品流水凭证模板表), 产品代码 和 交易类型 是联合 <strong>主键</strong>:  </p>
<table>
<thead>
<tr>
<th>产品代码</th>
<th>交易类型</th>
<th>凭证模板代码</th>
<th>差额凭证模板代码</th>
<th>差额凭证模板名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>p1</td>
<td>66</td>
<td>t1</td>
<td>tt1</td>
<td>差额A</td>
</tr>
<tr>
<td>p2</td>
<td>777</td>
<td>t2</td>
<td>tt1</td>
<td>差额A</td>
</tr>
<tr>
<td>p1</td>
<td>888</td>
<td>t1</td>
<td>tt1</td>
<td>差额A</td>
</tr>
</tbody>
</table>
<p>差额凭证模板代码 依赖于 主键  (产品代码, 交易类型), 差额凭证模板名称 依赖于 差额凭证模板 代码, 这就存在 <strong>传递依赖</strong>, 不满足第三范式.  </p>
<p>修改 使其满足 第三范式 :  </p>
<table>
<thead>
<tr>
<th>产品代码</th>
<th>交易类型</th>
<th>凭证模板代码</th>
<th>差额凭证模板代码</th>
</tr>
</thead>
<tbody>
<tr>
<td>p1</td>
<td>66</td>
<td>t1</td>
<td>tt1</td>
</tr>
<tr>
<td>p2</td>
<td>777</td>
<td>t2</td>
<td>tt1</td>
</tr>
<tr>
<td>p1</td>
<td>888</td>
<td>t1</td>
<td>tt1</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>差额凭证模板代码</th>
<th>差额凭证模板名称</th>
</tr>
</thead>
<tbody>
<tr>
<td>tt1</td>
<td>差额A</td>
</tr>
</tbody>
</table>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1: <a href="https://aijuans.iteye.com/blog/1629645" target="_blank" rel="noopener">数据库设计的三大范式</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/09/java-动态代理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/09/java-动态代理/" itemprop="url">Java 动态代理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-09T15:10:32+08:00">
                2019-04-09
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近看 《HeadFirst 设计模式》 看到 <strong>代理模式</strong> ，包括 <em>远程代理</em>，<em>保护代理</em>，<em>虚拟代理</em> 等。<br>其中 <em>保护代理</em> 是使用 Java API的 <strong>动态代理</strong> 实现的。  </p>
<p>此外， Spring AOP 底层也是 <strong>动态代理</strong> 实现的。<br>于是，借此机会学习一下 Java动态代理。  </p>
<h1 id="1-动态代理"><a href="#1-动态代理" class="headerlink" title="1 动态代理"></a>1 动态代理</h1><p>Java 在 java.lang.reflect 包中有自己的代理支持，利用这个包 可以实现在运行时 动态地创建 一个代理类，实现一个或多个接口，并将方法转发(dispatch)到指定的类。<br>因为实际的代理类是 <strong>运行时创建</strong> 的， 于是称此技术为：动态代理。  </p>
<p>Java 动态代理 类图：<br><img src="http://mitre.oss-cn-hangzhou.aliyuncs.com/blog2019/pic04/2019-04-09_221058.png" alt></p>
<h1 id="2-Java-动态代理-API"><a href="#2-Java-动态代理-API" class="headerlink" title="2 Java 动态代理 API"></a>2 Java 动态代理 API</h1><p>Java 动态代理 API 提供了一个 <strong>接口 InvocationHandler</strong> 和 一个 <strong>类 Proxy</strong> 。<br>正是 InvocationHandler 和 Proxy 让我们可以用简单的代码实现 动态代理 。  </p>
<h2 id="2-1-InvocationHandler-接口"><a href="#2-1-InvocationHandler-接口" class="headerlink" title="2.1 InvocationHandler 接口"></a>2.1 InvocationHandler 接口</h2><p>InvocationHandler is the interface implemented by the invocation handler of a proxy instance.<br>Each proxy instance has an associated invocation handler.<br>When a method is invoked on a proxy instance, the method invocation is encoded and dispatched to the invoke method of its invocation handler.<br>InvocationHandler 是由 代理对象 的 <strong>调用处理器</strong> 实现的。<br>每一个 代理对象 都有一个对应的 <strong>调用处理器</strong>。<br>当一个 代理实例 的方法被调用时， 这个方法调用 会委派调用  <strong>调用处理器</strong> 的方法。  </p>
<p>InvocationHandler 接口 只有一个方法：<br><strong><font color="red">Object</font> <font color="#8a00e6">invoke</font>(<font color="red">Object</font> proxy, <font color="red">Method</font> method, <font color="red">Object[]</font> args)</strong><br>Processes a method invocation on a proxy instance and returns the result.<br>动态代理 最重要的就是 要实现 <strong><font color="#8a00e6">invoke</font></strong> 方法，<strong>代理对象</strong> 利用 <strong><font color="#8a00e6">invoke</font></strong> 完成对 <strong>被代理对象</strong> 中的方法的调用。    </p>
<h2 id="2-2-Proxy-类"><a href="#2-2-Proxy-类" class="headerlink" title="2.2 Proxy 类"></a>2.2 Proxy 类</h2><p>Proxy provides static methods for creating dynamic proxy classes and instances, and it is also the superclass of all dynamic proxy classes created by those methods.<br><strong>Proxy</strong> 提供了 <strong>创建动态代理类</strong> 和 实例 的 静态方法。Proxy 同时是 所有 动态代理类(由其静态方法创建) 的超类。  </p>
<p>Proxy 有一个成员变量，一个构造方法，和四个 静态成员方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 成员变量</span></span><br><span class="line"><span class="keyword">protected</span> InvocationHandler h;</span><br><span class="line"><span class="comment">// 构造方法</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">Proxy</span><span class="params">(InvocationHandler h)</span></span>;</span><br><span class="line"><span class="comment">// 静态成员方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> InvocationHandler <span class="title">getInvocationHandler</span><span class="params">(Object proxy)</span></span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt; getProxyClass(ClassLoader loader, Class&lt;?&gt;... interfaces);</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isProxyClass</span><span class="params">(Class&lt;?&gt; cl)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>创建 动态代理对象时 用 <strong><font color="#8a00e6">newProxyInstance</font></strong> 方法，Java API 对此方法介绍如下：<br>Returns an instance of a proxy class for the specified interfaces that dispatches method invocations to the specified invocation handler.<br>返回指定接口的代理对象，此代理对象 能够把 对代理对象的方法调用 委派让 调用处理器 执行。<br><strong>简而言之，客户调用 代理对象的方法， 代理对象会调用 InvocationHandler 的 invoke 方法， 然后 invoke 方法 调用 被代理对象的对应方法。</strong><br><strong>这样在客户看来，调用代理对象 就像 调用原对象(被代理对象) 一样。</strong>  </p>
<p><strong><font color="#8a00e6">newProxyInstance</font></strong> 方法的三个参数：<br><strong><font color="#ff9900">loader </font></strong>: 一个ClassLoader对象，由此ClassLoader对象来对生成的代理对象进行加载。<br><strong><font color="#ff9900">interfaces </font></strong>: 一个Interface对象的数组，值是被代理对象实现的接口。代理对象会宣称实现了这些接口，这样就能 用代理对象 调用这组接口中的方法了。<br><strong><font color="#ff9900">h </font></strong>: 一个InvocationHandler对象，当动态代理对象在调用方法的时候，会调用此 InvocationHandler 对象 的 invoke 方法。  </p>
<h1 id="3-动态代理示例"><a href="#3-动态代理示例" class="headerlink" title="3 动态代理示例"></a>3 动态代理示例</h1><p>再看一遍 Java动态代理 的类图：<br><img src="http://mitre.oss-cn-hangzhou.aliyuncs.com/blog2019/pic04/2019-04-09_221058.png" alt><br>Java API 已经提供了 <strong>Proxy 类</strong> 和 <strong>InvocationHandler 接口</strong> ， 因此，只要写一个 <strong><font color="#2eb82e">Subject 接口</font></strong>， 一个 <strong><font color="#2eb82e">Subject 的实现类</font></strong>，和 一个 <strong><font color="#2eb82e">InvocationHandler 的实现类</font></strong> 就行了。  </p>
<p>下面是示例的具体代码。  </p>
<p><strong><font color="#2eb82e">Subject 接口</font></strong> :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">	<span class="function">String <span class="title">location</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">printLocation</span><span class="params">(String s)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><font color="#2eb82e">Subject 的实现类</font></strong> :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">location</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"江苏省常州市金坛区江南农商银行"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printLocation</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">		System.out.println(s+<span class="string">"江南"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><font color="#2eb82e">InvocationHandler 的实现类</font></strong> :<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Subject subject;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteInvocationHandler</span><span class="params">(Subject subject)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.subject=subject;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"invoke 方法被调用"</span>);</span><br><span class="line">		Object o=method.invoke(subject, args);</span><br><span class="line">		<span class="keyword">return</span> o;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注意对比看类图，<strong>InvocationHandler 是实现动态代理的关键！</strong> InvocationHandler 的实现类 <strong>有一个 (has-A)</strong> RealSubject 被代理对象，invoke 方法 正是调用 此对象的 方法 实现动态代理的。  </p>
<p>测试代码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxyDrive</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IllegalArgumentException, ClassNotFoundException </span>&#123;</span><br><span class="line">		<span class="comment">// 原对象(被代理对象)</span></span><br><span class="line">		Subject subject = <span class="keyword">new</span> RealSubject();</span><br><span class="line"></span><br><span class="line">		InvocationHandler ih = <span class="keyword">new</span> ConcreteInvocationHandler(subject);</span><br><span class="line">		<span class="comment">// 代理对象</span></span><br><span class="line">		Subject proxySubject = (Subject) Proxy.newProxyInstance(Class.forName(<span class="string">"cn.mitre.subject.RealSubject"</span>).getClassLoader(),  Class.forName(<span class="string">"cn.mitre.subject.RealSubject"</span>).getInterfaces(), ih);</span><br><span class="line">		<span class="comment">// 代理对象 代理了 原对象，于是可以把 代理对象 当成原对象使用</span></span><br><span class="line">		proxySubject.printLocation(<span class="string">"四月"</span>);</span><br><span class="line">		System.out.println(proxySubject.location());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>输出结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">invoke 方法被调用</span><br><span class="line">四月江南</span><br><span class="line">invoke 方法被调用</span><br><span class="line">江苏省常州市金坛区江南农商银行</span><br></pre></td></tr></table></figure></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1、 HeadFirst 设计模式<br>2、 <a href="https://www.cnblogs.com/xiaoluo501395377/p/3383130.html" target="_blank" rel="noopener">java的动态代理机制详解</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/20/构建工具Maven笔记一-HelloWorld/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/20/构建工具Maven笔记一-HelloWorld/" itemprop="url">构建工具Maven笔记一: HelloWorld</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-03-20T22:09:13+08:00">
                2019-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Maven/" itemprop="url" rel="index">
                    <span itemprop="name">Maven</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-构建工具"><a href="#1-构建工具" class="headerlink" title="1 构建工具"></a>1 构建工具</h1><p>构建 ( build ) 是把项目源代码变成项目产品的过程。其中包含编译，测试，打包，部署等工作。  </p>
<p>常见的构建工具：<br><strong><font color="green">Make</font></strong> 是最早的构建工具，Stuart Feldman 于 1977 年在 Bell实验室 创建。 Make 由 <strong>Makefile</strong> 脚本文件驱动。常用于C++ 项目。  </p>
<p><strong><font color="green">Apache Ant</font></strong> (Another Neat Tool 另一个简洁的工具), Ant 像是Java版本的 Make。 Ant 由 <strong>build.xml</strong> 构建配置文件驱动。它最早用来构建 Tomcat， 现在已经逐渐被 <strong>Maven</strong> 和 <strong>Gradle</strong> 取代了。  </p>
<p><strong><font color="green">Apache Maven</font></strong> 是在 Ant 之后流行的构建工具。Maven 项目的核心是 <strong>pom.xml</strong> 文件。POM (Project Object Model 项目对象模型) 定义了项目的基本信息。  </p>
<p><strong><font color="green">Gradle</font></strong> 是一个基于Apache Ant和Apache Maven概念的项目自动化构建工具。Gradle 使用基于 <strong>Groovy</strong> 的特定领域语言(DSL)来声明项目设置，抛弃了基于XML的各种繁琐配置。    </p>
<h1 id="2-Window10-安装-Maven"><a href="#2-Window10-安装-Maven" class="headerlink" title="2 Window10 安装 Maven"></a>2 Window10 安装 Maven</h1><p><a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">Apache Maven 下载地址</a>, 点击下载 apache-maven-3.6.0-bin.tar.gz 即可。<br>下载完成后：<br>1、 解压<br>2、 配置环境变量 M2_HOME 指向 解压的 Maven 目录<br>3、 配置环境变量 Path， 添加一项 <strong>%M2_HOME%\bin</strong><br>4、 win+R , cmd 打开终端 输入 <code>echo %M2_HOME%</code> , 检查环境变量是否配置好<br>5、 终端输入， <code>mvn -v</code> 查看 Maven 版本。显示版本即可。  </p>
<h1 id="3-Maven项目入门程序"><a href="#3-Maven项目入门程序" class="headerlink" title="3 Maven项目入门程序"></a>3 Maven项目入门程序</h1><h2 id="3-1-编写-pom-xml-文件"><a href="#3-1-编写-pom-xml-文件" class="headerlink" title="3.1 编写 pom.xml 文件"></a>3.1 编写 pom.xml 文件</h2><p>创建一个文件夹/项目目录 hello-world , 在此文件夹下 创建 pom.xml 文件。<br>pom.xml 文件内容如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.mitre<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-world<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Maven Hello World Project<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>&lt;project&gt;</strong> 是 所有 pom.xml 的根元素。<br>modelVersion 指定了当前 POM模型 的版本，对于 Maven3 来说，只能是4.0.0。<br><strong>groupId</strong> 定义了项目属于哪个组。 groupId一般是 公司域名倒写.(点)项目名，例如，com.bilibili.myapp。<br><strong>artifactId</strong> 定义了当前 Maven项目在 组中唯一的构件id。<br><strong>version</strong>  指定了Maven项目当前的版本。<br>name 元素 声明了项目名称，name元素不是必须的，为了方便查看常声明name元素。  </p>
<p><strong><font color="orange">groupId</font></strong>, <strong><font color="orange">artifactId</font></strong>, <strong><font color="orange">version</font></strong>, 这 3 个元素定义了一个项目的基本坐标。在Maven项目中，任何jar、 pom、 war都是基于这 3 个元素区分的。    </p>
<h2 id="3-2-编写主代码"><a href="#3-2-编写主代码" class="headerlink" title="3.2 编写主代码"></a>3.2 编写主代码</h2><p>在 hello-world 文件夹下(与pom.xml同级目录)，创建文件<br><code>src/main/java/cn/mitre/helloworld/HelloWorld.java</code> 。<br>HelloWorld.java 代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mitre.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Hello Maven"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="keyword">new</span> HelloWorld().sayHello());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><font color="red">注意</font></strong>：java 代码放在 src/main/java/ 目录下 是为了遵循 Maven 的约定，这样无需额外的配置。  </p>
<p>打开终端，进入到 项目目录(hello-world)下，执行以下命令进行 <strong>编译</strong>：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean compile</span><br></pre></td></tr></table></figure></p>
<p>clean 会清除输出目录 target。<br>compile 会编译项目主代码。  </p>
<h2 id="3-3-编写测试代码"><a href="#3-3-编写测试代码" class="headerlink" title="3.3 编写测试代码"></a>3.3 编写测试代码</h2><p>Maven 项目默认的测试代码 目录是 src/test/java 。<br>和编写主代码一个道理，创建文件<br>src/test/java/cn/mitre/helloworld/HelloWorldTest.java<br>编写测试代码之前，需要在 pom.xml 中配置 单元测试 JUnit 依赖：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.mitre<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-world<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Maven Hello World Project<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Maven 会根据 <strong><font color="orange">groupId</font></strong>, <strong><font color="orange">artifactId</font></strong>, <strong><font color="orange">version</font></strong> 定位并下载 junit-4.7.jar 。<br>scope 指定了依赖范围，test 表示只对测试代码有效， compile 表示对主代码和测试代码都有效。  </p>
<p>有了测试依赖，就可以编写测试代码了：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mitre.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertEquals;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldTest</span></span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSayHello</span><span class="params">()</span></span>&#123;</span><br><span class="line">		HelloWorld helloWorld = <span class="keyword">new</span> HelloWorld();</span><br><span class="line">		String result=helloWorld.sayHello();</span><br><span class="line">		assertEquals(<span class="string">"Hello Maven"</span>, result); <span class="comment">//测试 result 是否等于 "Hello Maven"</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>JUnit4 要求所有的测试方法以 test 开头， 同时加上 @Test 注解。  </p>
<p>测试代码写完后， 打开终端，执行以下命令完成 <strong>测试</strong>：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean <span class="built_in">test</span></span><br></pre></td></tr></table></figure></p>
<p>Maven 在执行 <strong>测试</strong> 之前，会自动 <strong>编译</strong> 主代码和测试代码。  </p>
<h2 id="3-4-打包和运行"><a href="#3-4-打包和运行" class="headerlink" title="3.4 打包和运行"></a>3.4 打包和运行</h2><p>终端执行以下命令 进行 <strong>打包</strong>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br></pre></td></tr></table></figure></p>
<p>Maven 在执行 <strong>打包</strong> 之前， 会自动 <strong>编译</strong> 和 <strong>测试</strong> 。<br><strong>打包</strong> 命令执行成功后，会在输出目录 target 下 生成一个 名称为 artifact-version.jar 的包。  </p>
<p>如果想让其他 Maven 项目直接引用这个 jar 包，还需要执行 <strong>安装</strong> 命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean install</span><br></pre></td></tr></table></figure></p>
<p>Maven 在执行 <strong>安装</strong> 之前， 会自动 <strong>打包</strong>。<br><strong>install</strong> 命令执行成功后，可以在本地仓库对应的目录(C:\Users\cx141.m2\repository\cn\mitre\hello-world\1.0-SNAPSHOT)看到 pom 和 jar 文件。  </p>
<h2 id="3-5-生成可执行的-jar-文件-可选"><a href="#3-5-生成可执行的-jar-文件-可选" class="headerlink" title="3.5 生成可执行的 jar 文件(可选)"></a>3.5 生成可执行的 jar 文件(可选)</h2><p>在上面的 HelloWorld 类里 有一个 main 方法，默认 <strong>打包</strong> 生成的 jar 是不可以执行的。<br>为了生成可执行的 jar 包， 需要借助 maven-shade-plugin 插件， 在 pom.xml 文件中 配置该插件：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.mitre<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hello-world<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Maven Hello World Project<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">transformers</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">transformer</span> <span class="attr">implementation</span>=<span class="string">"org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>cn.mitre.helloworld.HelloWorld<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">transformer</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">transformers</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>配置 mainClass 元素为 cn.mitre.helloworld.HelloWorld ，项目在 <strong>打包</strong> 时，会把该信息放在 MANIFEST 中。<br>有了 main 方法信息，再执行 <code>mvn clean install</code> 就会在 target 目录下生成两个 jar ， 分别是 hello-world-1.0-SNAPSHOT.jar 和 original-hello-world-1.0-SNAPSHOT.jar 。前者是带 mainClass 信息可运行的 jar， 后者是原生的 jar。<br>打开终端，进入到项目目录，执行 hello-world-1.0-SNAPSHOT.jar ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar target\hello-world-1.0-SNAPSHOT.jar</span><br></pre></td></tr></table></figure></p>
<p>执行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello Maven</span><br></pre></td></tr></table></figure></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1、 Maven 实战【许晓斌】</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/13/Java-反射机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/13/Java-反射机制/" itemprop="url">Java 反射机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-13T09:57:17+08:00">
                2019-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-反射概述"><a href="#1-反射概述" class="headerlink" title="1 反射概述"></a>1 反射概述</h1><p>在程序运行时，<strong>对于任意一个类，都能获得这个类的所有的属性和方法</strong>；<br>对于任意一个对象，都能够调用它的任意一个方法和属性(包括私有的方法和属性)。<br>这种 动态获取的类信息 以及 动态调用对象的方法 的功能 就称为java语言的反射机制。  </p>
<p>要想对一个类进行反射，必须先获取该类的 字节码文件(.class)。反射是通过 <strong><font color="red">Class类</font></strong> 中的方法实现的。<br>每一个 <strong>类</strong> 对应着一个 <strong>字节码文件</strong> 也就对应着一个 <strong>Class类型对象</strong>，也就是字节码文件对象。  </p>
<p>获取Class对象的三种方式:<br>1、通过类名获取 类名.class<br>2、通过对象获取 对象名.getClass()<br>3、<strong><font color="#1a75ff">通过全类名获取 Class.forName(全类名)</font></strong>  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1-类名.class</span></span><br><span class="line">  Class s1Class=Student.class;</span><br><span class="line">  System.out.println(s1Class.getName());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2-对象名.getClass</span></span><br><span class="line">  Student s2=<span class="keyword">new</span> Student();</span><br><span class="line">  Class s2Class=s2.getClass();</span><br><span class="line">  System.out.println(s2Class.getName());</span><br><span class="line">  System.out.println(s1Class==s2Class);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3-Class.forName</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    Class s3Class = Class.forName(<span class="string">"domain.Student"</span>);</span><br><span class="line">    System.out.println(s3Class.getName());</span><br><span class="line">    System.out.println(s2Class==s3Class);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">domain.Student</span><br><span class="line">domain.Student</span><br><span class="line">true</span><br><span class="line">domain.Student</span><br><span class="line">true</span><br></pre></td></tr></table></figure></p>
<p>从上面程序结果可以看出，一个类Student 只有一个 类类型Class 对象，不论Class对象是如何创建的，不论Class对象创建多少次。  </p>
<p>事实上, 通过 <code>ClassLoader</code> 也能 获取 Class对象:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; clazz = MitreTest.class.getClassLoader().loadClass((<span class="string">"cn.mitrecx.Hello"</span>));</span><br></pre></td></tr></table></figure></p>
<h1 id="2-获取构造方法-并调用–newInstance"><a href="#2-获取构造方法-并调用–newInstance" class="headerlink" title="2 获取构造方法 并调用–newInstance"></a>2 获取构造方法 并调用–newInstance</h1><p><strong>Class对象</strong> 获取 <strong><font color="red">所有 public 构造函数</font></strong>： <font color="#8a00e6">getConstructors()</font>  </p>
<p>获取 <strong><font color="red">所有构造函数(声明的构造函数)</font></strong>： <font color="#8a00e6">getDeclaredConstructors()</font>  </p>
<p>获取 <strong><font color="red">指定的 public 构造函数</font></strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Constructor&lt;T&gt; <span class="title">getConstructor</span><span class="params">(Class&lt;?&gt;... parameterTypes)</span>  </span></span><br><span class="line"><span class="function"><span class="comment">//getConstructor 的参数 要和 某个构造函数的参数一致，才能获取到对应的构造函数</span></span></span><br></pre></td></tr></table></figure></p>
<p>获取 <strong><font color="red">指定的 非public 构造函数</font></strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Constructor&lt;T&gt; <span class="title">getDeclaredConstructor</span><span class="params">(Class&lt;?&gt;... parameterTypes)</span></span></span><br><span class="line"><span class="function"><span class="comment">// 一样的道理，getDeclaredConstructor 的参数 要和 某个构造函数的参数一致</span></span></span><br></pre></td></tr></table></figure></p>
<p>Constructor对象 通过调用 <strong><font color="#8a00e6">newInstance方法</font></strong> 创建对象。  </p>
<p>示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReflectDemo2</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    Class&lt;?&gt; clazz = Class.forName(<span class="string">"domain.Student"</span>);</span><br><span class="line">    System.out.println(<span class="string">"===获取所有public构造函数"</span>);</span><br><span class="line">    Constructor[] constructorArrayPub = clazz.getConstructors();</span><br><span class="line">    <span class="keyword">for</span> (Constructor c : constructorArrayPub) &#123;</span><br><span class="line">      System.out.println(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n===获取所有的构造方法(声明的构造函数)"</span>);</span><br><span class="line">    Constructor[] constructorArrayAll = clazz.getDeclaredConstructors();</span><br><span class="line">    <span class="keyword">for</span> (Constructor c : constructorArrayAll) &#123;</span><br><span class="line">      System.out.println(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n===获取指定的 public构造方法"</span>);</span><br><span class="line">    Constructor constructor1 = clazz.getConstructor(java.lang.String.class, <span class="keyword">int</span>.class, <span class="keyword">char</span>.class);</span><br><span class="line">    Object obj = constructor1.newInstance(<span class="string">"嘉宣"</span>, <span class="number">24</span>, <span class="string">'M'</span>);</span><br><span class="line">    System.out.println(obj);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n===获取指定的 private构造方法"</span>);</span><br><span class="line">    Constructor constructor2 = clazz.getDeclaredConstructor(java.lang.String.class, <span class="keyword">int</span>.class);</span><br><span class="line">    constructor2.setAccessible(<span class="keyword">true</span>);<span class="comment">// private方法，调用之前必须设置为可见</span></span><br><span class="line">    Object obj2 = constructor2.newInstance(<span class="string">"嘉文"</span>, <span class="number">26</span>);</span><br><span class="line">    System.out.println(obj2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">===获取所有public构造函数</span><br><span class="line">public domain.Student(java.lang.String,int,char)</span><br><span class="line">public domain.Student()</span><br><span class="line"></span><br><span class="line">===获取所有的构造方法(声明的构造函数)</span><br><span class="line">public domain.Student(java.lang.String,int,char)</span><br><span class="line">private domain.Student(java.lang.String,int)</span><br><span class="line">protected domain.Student(java.lang.String)</span><br><span class="line">public domain.Student()</span><br><span class="line"></span><br><span class="line">===获取指定的 public构造方法</span><br><span class="line">姓名:嘉宣 年龄:24 性别:M</span><br><span class="line"></span><br><span class="line">===获取指定的 private构造方法</span><br><span class="line">姓名:嘉文 年龄:26 性别:</span><br></pre></td></tr></table></figure></p>
<h1 id="3-获取成员变量-并调用–set"><a href="#3-获取成员变量-并调用–set" class="headerlink" title="3 获取成员变量 并调用–set"></a>3 获取成员变量 并调用–set</h1><p><strong>Class对象</strong> 获取 <strong><font color="red">所有 public 成员变量</font></strong>： <font color="#8a00e6">getFields()</font>  </p>
<p>获取 <strong><font color="red">所有 成员变量</font></strong>： <font color="#8a00e6">getDeclaredFields()</font>  </p>
<p>获取 <strong><font color="red">指定变量名的 成员变量</font></strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Field <span class="title">getDeclaredField</span><span class="params">(String name)</span></span></span><br></pre></td></tr></table></figure></p>
<p>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Constructor c=clazz.getConstructor(String.class,<span class="keyword">int</span>.class,<span class="keyword">char</span>.class);</span><br><span class="line">Student student=(Student) c.newInstance(<span class="string">"cherry"</span>,<span class="number">24</span>,<span class="string">'F'</span>);</span><br><span class="line">System.out.println(<span class="string">"\n===指定字段名的 private 字段"</span>);</span><br><span class="line">Field fieldName=clazz.getDeclaredField(<span class="string">"name"</span>);</span><br><span class="line">System.out.println(fieldName);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为字段赋值，因为是 private字段，所以要先设置为可访问的</span></span><br><span class="line">fieldName.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 直接给对象的 成员变量赋值</span></span><br><span class="line">fieldName.set(student,<span class="string">"xun"</span>);</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure></p>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">===指定字段名的 private 字段</span><br><span class="line">private java.lang.String domain.Student.name</span><br><span class="line">姓名:xun 年龄:24 性别:F</span><br></pre></td></tr></table></figure></p>
<p>获取 <strong><font color="red">指定变量名的 public 成员变量</font></strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Field <span class="title">getField</span><span class="params">(String name)</span></span></span><br></pre></td></tr></table></figure></p>
<h1 id="4-获取成员方法并调用–invoke"><a href="#4-获取成员方法并调用–invoke" class="headerlink" title="4 获取成员方法并调用–invoke"></a>4 获取成员方法并调用–invoke</h1><p><strong>Class对象</strong> 获取 <strong><font color="red">所有 public 成员方法(包括继承来的方法)</font></strong>： <font color="#8a00e6">getMethods(String name)</font>   </p>
<p>获取 <strong><font color="red">所有 成员方法(没有来继承的方法)</font></strong>： <font color="#8a00e6">getDeclaredMethods(String name)</font>    </p>
<p>获取 <strong><font color="red">指定的方法名和参数类型的 public 成员方法</font></strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// name 是方法名，其他参数 指定 方法的变量类型</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Method <span class="title">getMethod</span><span class="params">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br></pre></td></tr></table></figure></p>
<p>例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Constructor constructor=clazz.getConstructor(String.class,<span class="keyword">int</span>.class,<span class="keyword">char</span>.class);</span><br><span class="line">Student student=(Student)constructor.newInstance(<span class="string">"轩辕荣耀"</span>,<span class="number">21</span>,<span class="string">'M'</span>);</span><br><span class="line">Method methodSetName=clazz.getMethod(<span class="string">"setName"</span>, String.class);</span><br><span class="line"><span class="comment">/* invoke 调用方法 */</span></span><br><span class="line">methodSetName.invoke(student, <span class="string">"永强"</span>);</span><br><span class="line">System.out.println(student);</span><br></pre></td></tr></table></figure></p>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">姓名:永强 年龄:21 性别:M</span><br></pre></td></tr></table></figure></p>
<p>获取 <strong><font color="red">指定的方法名和参数类型的 成员方法</font></strong>：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Method <span class="title">getDeclaredMethod</span><span class="params">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br></pre></td></tr></table></figure></p>
<p><strong><font color="#8a00e6">invoke</font></strong> private方法之前，必须 <strong><font color="#8a00e6">setAccessible(true)</font></strong>。  </p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1、 <a href="https://www.cnblogs.com/whgk/p/6122036.html" target="_blank" rel="noopener">Java中反射机制详解</a><br>2、 <a href="https://blog.csdn.net/sinat_38259539/article/details/71799078" target="_blank" rel="noopener">Java基础之—反射</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/11/Java-I-O-学习系列四-RandomAccessFile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/11/Java-I-O-学习系列四-RandomAccessFile/" itemprop="url">Java I/O 学习系列四: RandomAccessFile</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-11T16:08:14+08:00">
                2019-02-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-RandomAccessFile-简介"><a href="#1-RandomAccessFile-简介" class="headerlink" title="1 RandomAccessFile 简介"></a>1 RandomAccessFile 简介</h1><h2 id="1-1-API-docs-对-RandomAccessFile-的描述"><a href="#1-1-API-docs-对-RandomAccessFile-的描述" class="headerlink" title="1.1 API docs 对 RandomAccessFile 的描述"></a>1.1 API docs 对 RandomAccessFile 的描述</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Object</span><br><span class="line">      |__java.io.RandomAccessFile</span><br></pre></td></tr></table></figure>
<p>Instances of this class support both reading and writing to a random access file.<br>A random access file behaves like a large array of bytes stored in the file system.<br>There is a kind of cursor, or index into the implied array, called <strong><font color="#ff9900">the file pointer</font></strong>;<br><strong>input operations</strong> read bytes starting at the file pointer and advance the file pointer past the bytes read.   </p>
<p>If the random access file is created in read/write mode, then <strong>output operations</strong> are also available;<br>output operations write bytes starting at the file pointer and advance the file pointer past the bytes written.<br>Output operations that write past the current end of the implied array cause the array to be extended.<br>The file pointer can be read by the <strong><font color="#8a00e6">getFilePointer</font></strong> method and set by the <strong><font color="#8a00e6">seek</font></strong> method.  </p>
<p>It is generally true of all the reading routines in this class that if <strong>end-of-file</strong> is reached before the desired number of bytes has been read, an <strong><font color="#ff0000">EOFException</font></strong> (which is a kind of IOException) is thrown.<br>If any byte cannot be read for any reason other than end-of-file, an IOException other than(除了) EOFException is thrown.<br>In particular, an <strong><font color="#ff0000">IOException</font></strong> may be thrown if the stream has been closed.<br>RandomAccessFile类 在读取程序中，如果在读取完 所需的字节数 之前到达 文件结尾，将会抛出 EOFException 。<br>除 读到文件结尾 之外的任何原因，导致不能读取到 字节，将会抛出 IOException。  </p>
<h2 id="1-2-RandomAccessFile-的作用"><a href="#1-2-RandomAccessFile-的作用" class="headerlink" title="1.2 RandomAccessFile 的作用"></a>1.2 RandomAccessFile 的作用</h2><p>RandomAccessFile 类 实现了 DataInput 和 DataOutput 接口，所以 RandomAccessFile类 既可以读也可以写。  </p>
<p>RandomAccessFile 可以 <strong><font color="#ff0000">访问文件</font></strong> 的任意位置，并且支持 读取和写入 操作。  </p>
<h2 id="1-3-构造函数"><a href="#1-3-构造函数" class="headerlink" title="1.3 构造函数"></a>1.3 构造函数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RandomAccessFile</span><span class="params">(String name, String mode)</span> <span class="keyword">throws</span> FileNotFoundException</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RandomAccessFile</span><span class="params">(File file, String mode)</span> <span class="keyword">throws</span> FileNotFoundException</span></span><br></pre></td></tr></table></figure>
<p>mode 参数用于指定访问模式：<br>“r” 只读<br>“rw” 读写<br>“rws” 读写，同时对文件的内容或 元数据(metadata) 的更新 同步写入底层存储设备<br>“rwd” 读写，同时对文件的内容的更新 同步写入底层存储设备</p>
<h1 id="2-RandomAccessFile-用法示例"><a href="#2-RandomAccessFile-用法示例" class="headerlink" title="2 RandomAccessFile 用法示例"></a>2 RandomAccessFile 用法示例</h1><h2 id="2-1-写入和读取文件"><a href="#2-1-写入和读取文件" class="headerlink" title="2.1 写入和读取文件"></a>2.1 写入和读取文件</h2><p><strong><font color="#8a00e6">writeUTF</font></strong> 方法 使用 modified UTF-8 encoding 以独立于机器的方式把字符串写入文件。  </p>
<p>用 <strong><font color="#8a00e6">writeUTF</font></strong> 方法 把中文字符串写入文件中，直接打开文件看到的是 <strong><font color="#ff0000">乱码</font></strong>。<br>使用 <strong>指定的write 方法</strong>(如，writeUTF，writeInt，writeLong等) 写入，应该使用 <strong>对应的read 方法</strong>(如，readUTF，readInt，readLong等)读取。  </p>
<p>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//写入</span></span><br><span class="line">  write();</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    RandomAccessFile raf=<span class="keyword">new</span> RandomAccessFile(<span class="string">"C:\\Users\\cx141\\Desktop\\credit\\1.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">    String s=raf.readUTF();</span><br><span class="line">    String s2=raf.readUTF();</span><br><span class="line">    <span class="keyword">int</span> s3=raf.readInt();</span><br><span class="line">    System.out.println(s+s2+s3);</span><br><span class="line">    raf.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"C:\\Users\\cx141\\Desktop\\credit\\1.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">    raf.writeUTF(<span class="string">"hello world."</span>);</span><br><span class="line">    raf.writeUTF(<span class="string">"你好 "</span>);</span><br><span class="line">    raf.writeInt(<span class="number">123</span>);</span><br><span class="line">    raf.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hello world.你好 123</span><br></pre></td></tr></table></figure></p>
<h2 id="2-2-在文件结尾插入"><a href="#2-2-在文件结尾插入" class="headerlink" title="2.2 在文件结尾插入"></a>2.2 在文件结尾插入</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"C:\\Users\\cx141\\Desktop\\credit\\2.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">    raf.seek(raf.length());</span><br><span class="line">    raf.write(<span class="string">"\r\n江阴农商银行"</span>.getBytes());</span><br><span class="line">    raf.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序执行后 文件2.txt 内容如下(不 <strong><font color="#ff0000">乱码</font></strong>)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">中华人民共和国</span><br><span class="line">美利坚合众国</span><br><span class="line">江阴农商银行</span><br></pre></td></tr></table></figure></p>
<p>注：读取文件 可以按行读<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"C:\\Users\\cx141\\Desktop\\credit\\2.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">String line = raf.readLine();</span><br><span class="line"><span class="keyword">while</span> (line != <span class="keyword">null</span>) &#123;</span><br><span class="line">  System.out.println(<span class="keyword">new</span> String(line.getBytes(<span class="string">"ISO-8859-1"</span>), <span class="string">"GBK"</span>));</span><br><span class="line">  line = raf.readLine();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="2-3-在文件的任意位置插入"><a href="#2-3-在文件的任意位置插入" class="headerlink" title="2.3 在文件的任意位置插入"></a>2.3 在文件的任意位置插入</h2><p>RandomAccessFile 在 任意位置pos插入 会覆盖pos后面原有的数据。<br>只要把pos后面的内容先保存在一个临时文件中，待插入完成后，再把临时文件中的内容添加到 原文件结尾即可。  </p>
<p>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 指定一个插入位置</span></span><br><span class="line">  <span class="keyword">int</span> pos = <span class="number">14</span>;</span><br><span class="line">  File temp = <span class="keyword">new</span> File(<span class="string">"C:\\Users\\cx141\\Desktop\\credit\\temp.txt"</span>);</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    temp.createNewFile();</span><br><span class="line">    RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"C:\\Users\\cx141\\Desktop\\credit\\2.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">    FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(temp);</span><br><span class="line">    raf.seek(pos);</span><br><span class="line">    <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 把 seek 后的数据全部存储到临时文件中</span></span><br><span class="line">    <span class="keyword">while</span> (-<span class="number">1</span> != (num = raf.read(buffer))) &#123;</span><br><span class="line">      fos.write(buffer, <span class="number">0</span>, num);</span><br><span class="line">    &#125;</span><br><span class="line">    fos.close();</span><br><span class="line">    raf.seek(pos);</span><br><span class="line">    raf.write(<span class="string">"今天成立了"</span>.getBytes());</span><br><span class="line">    FileInputStream fis = <span class="keyword">new</span> FileInputStream(temp);</span><br><span class="line">    <span class="comment">// 把临时文件内容 添加到原文件结尾</span></span><br><span class="line">    <span class="keyword">while</span> (-<span class="number">1</span> != (num = fis.read(buffer))) &#123;</span><br><span class="line">      raf.write(buffer, <span class="number">0</span>, num);</span><br><span class="line">    &#125;</span><br><span class="line">    fis.close();</span><br><span class="line">    raf.close();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>程序执行后，2.txt 文件内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">中华人民共和国今天成立了</span><br><span class="line">美利坚合众国</span><br><span class="line">江阴农商银行</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/24/Java-I-O-学习系列三-字符流/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Java-I-O-学习系列三-字符流/" itemprop="url">Java I/O 学习系列三: 字符流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T15:29:34+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-为什么需要字符流"><a href="#1-为什么需要字符流" class="headerlink" title="1 为什么需要字符流"></a>1 为什么需要字符流</h1><p>纯英文环境下，只要 <strong>字节流</strong> 就能完成一切任务。  </p>
<p>在中文环境下，<strong>字节流</strong> 也能完成大多数 I/O 操作。<br>但是遇到 读取中文文本文件，或 写入中文到文件中 这种操作时，就需要 <strong><font color="#2eb82e">字符流</font></strong> 了。</p>
<p>注意：<br>复制中文文本文件 <strong>字节流</strong> 可以做。<br>但是 读取中文文本文件 并 打印到控制台 这种操作 <strong>字节流</strong> 做不了，<br>因为不知道中文字符占 2个字节(GBK) 还是 3个字节(UTF-8)，所以无法准确获取中文字符。<br>这种情况下，<strong><font color="#2eb82e">字符流</font></strong> 就能 准确地获取到 中文字符。因为 <strong><font color="#2eb82e">字符流</font></strong> 是 按字符读取文件的。</p>
<h1 id="2-Reader-和-Writer"><a href="#2-Reader-和-Writer" class="headerlink" title="2 Reader 和 Writer"></a>2 Reader 和 Writer</h1><p>Reader 是一个 <strong>抽象类</strong>， Writer 也是一个 <strong>抽象类</strong> 。  </p>
<h2 id="2-1-Reader"><a href="#2-1-Reader" class="headerlink" title="2.1 Reader"></a>2.1 Reader</h2><h3 id="Reader-简介"><a href="#Reader-简介" class="headerlink" title="Reader 简介"></a>Reader 简介</h3><p><strong>Abstract class for reading character streams</strong>.<br>The only methods that a subclass must implement are read(char[], int, int) and close().<br>Most subclasses, however, will override some of the methods defined here in order to provide higher efficiency, additional functionality, or both.<br><strong>Reader 是一个 读取字符流 的抽象类</strong>。<br>Reader 的子类 必须实现 read(char[], int, int) 和 close() 方法。<br>然而，大多数子类 为了提高效率或附加功能 会覆盖许多其他的方法。  </p>
<h3 id="Fields"><a href="#Fields" class="headerlink" title="Fields"></a>Fields</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用于同步流的操作。为提高效率，Reader的子类应该用此字段 而不是 this对象 或 synchronized方法</span></span><br><span class="line"><span class="keyword">protected</span> Object lock;</span><br></pre></td></tr></table></figure>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Closes the stream and releases any system resources associated with it.</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Marks the present position in the stream.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mark</span><span class="params">(<span class="keyword">int</span> readAheadLimit)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Tells whether this stream supports the mark() operation.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">markSupported</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Reads a single character.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Reads characters into an array. 读取多个字符放在 cbuf 数组里</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">char</span>[] cbuf)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Reads characters into a portion of an array.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">char</span>[] cbuf, <span class="keyword">int</span> off,<span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Attempts to read characters into the specified character buffer.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(CharBuffer target)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Tells whether this stream is ready to be read.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">ready</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Resets the stream.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Skips n个 characters.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">skip</span><span class="params">(<span class="keyword">long</span> n)</span> <span class="keyword">throws</span> IOException</span></span><br></pre></td></tr></table></figure>
<h3 id="Reader-的直接子类"><a href="#Reader-的直接子类" class="headerlink" title="Reader 的直接子类"></a>Reader 的直接子类</h3><p><strong>BufferedReader</strong><br>CharArrayReader<br>FilterReader<br><strong>InputStreamReader</strong><br>PipedReader<br>StringReader  </p>
<h2 id="2-2-Writer"><a href="#2-2-Writer" class="headerlink" title="2.2 Writer"></a>2.2 Writer</h2><p><strong>Abstract class for writing to character streams</strong>.<br>The only methods that a subclass must implement are write(char[], int, int), flush(), and close().<br>Most subclasses, however, will override some of the methods defined here in order to provide higher efficiency, additional functionality, or both.<br><strong>Writer 是一个写入字符流的 抽象类</strong>。<br>Writer 的子类必须要实现(覆盖) write(char[], int, int), flush(), 和 close() 方法。<br>然而，大多数子类 为了提高效率或附加功能 会覆盖许多其他的方法。  </p>
<h3 id="Fields-1"><a href="#Fields-1" class="headerlink" title="Fields"></a>Fields</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用于同步流的操作。 为提高效率，Writer的子类应该用此字段 而不是 this对象 或 synchronized方法</span></span><br><span class="line"><span class="keyword">protected</span> Object lock;</span><br></pre></td></tr></table></figure>
<h3 id="Methods-1"><a href="#Methods-1" class="headerlink" title="Methods"></a>Methods</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Appends the specified character to this writer.</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Writer <span class="title">append</span><span class="params">(<span class="keyword">char</span> c)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Appends the specified character sequence to this writer.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Writer <span class="title">append</span><span class="params">(CharSequence csq)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Appends a subsequence of the specified character sequence to this writer.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Writer <span class="title">append</span><span class="params">(CharSequence csq, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Closes the stream, flushing it first.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Flushes the stream.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes an array of characters.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">char</span>[] cbuf)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a portion of an array of characters. 写入字符数组的一部分。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">char</span>[] cbuf, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a single character.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> c)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a string.</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(String str)</span> <span class="keyword">throws</span> IOException</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a portion of a string. 写入字符串的一部分。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(String str, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException</span></span><br></pre></td></tr></table></figure>
<h3 id="Writer-的直接子类"><a href="#Writer-的直接子类" class="headerlink" title="Writer 的直接子类"></a>Writer 的直接子类</h3><p><strong>BufferedWriter</strong><br>CharArrayWriter<br>FilterWriter<br><strong>OutputStreamWriter</strong><br>PipedWriter<br>PrintWriter<br>StringWriter  </p>
<h1 id="3-InputStreamReader-和-OutputStreamWriter"><a href="#3-InputStreamReader-和-OutputStreamWriter" class="headerlink" title="3 InputStreamReader 和 OutputStreamWriter"></a>3 InputStreamReader 和 OutputStreamWriter</h1><p>继承关系：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Reader</span><br><span class="line">   |__InputStreamReader</span><br><span class="line"></span><br><span class="line">Writer</span><br><span class="line">   |__OutputStreamWriter</span><br></pre></td></tr></table></figure></p>
<h2 id="3-1-InputStreamReader"><a href="#3-1-InputStreamReader" class="headerlink" title="3.1 InputStreamReader"></a>3.1 InputStreamReader</h2><p>public class InputStreamReader extends Reader  </p>
<h3 id="InputStreamReader-简介"><a href="#InputStreamReader-简介" class="headerlink" title="InputStreamReader 简介"></a>InputStreamReader 简介</h3><p><strong>An InputStreamReader is a bridge from byte streams to character streams</strong>: It reads bytes and decodes them into characters using a specified charset.<br>The charset that it uses may be specified by name or may be given explicitly, or the platform’s default charset may be accepted.<br><strong>InputStreamReader 是 字节流 到 字符流 的桥梁：</strong> InputStreamReader 读取字节 并 使用指定的字符集 解码为字符。<br>InputStreamReader 使用的字符集 可以通过名称指定，也可以显式给定，或者接受平台默认的字符集。  </p>
<p>每次调用 InputStreamReader 的 read 方法 可能导致从 <strong>底层字节输入流(underlying byte-input stream)</strong> 读取一个或多个字节。<br>为了能有效的将字节转为字符，从 基础流中 提前读取的字节数 可能超过 当前读取操作所需的字节数。<br>为了获得最高效率，一般在 BufferedReader 中 包装(wrapping) 一个 InputStreamReader ，例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br></pre></td></tr></table></figure></p>
<h3 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Creates an InputStreamReader that uses the default charset.</span></span><br><span class="line">InputStreamReader(InputStream in)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates an InputStreamReader that uses the given charset.</span></span><br><span class="line">InputStreamReader(InputStream in, Charset cs)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates an InputStreamReader that uses the given charset decoder.</span></span><br><span class="line">InputStreamReader(InputStream in, CharsetDecoder dec)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates an InputStreamReader that uses the named charset.</span></span><br><span class="line">InputStreamReader(InputStream in, String charsetName)</span><br></pre></td></tr></table></figure>
<h2 id="3-2-OutputStreamWriter"><a href="#3-2-OutputStreamWriter" class="headerlink" title="3.2 OutputStreamWriter"></a>3.2 OutputStreamWriter</h2><p>public class OutputStreamWriter extends Writer</p>
<h3 id="OutputStreamWriter-简介"><a href="#OutputStreamWriter-简介" class="headerlink" title="OutputStreamWriter 简介"></a>OutputStreamWriter 简介</h3><p><strong>An OutputStreamWriter is a bridge from character streams to byte streams</strong>: Characters written to it are encoded into bytes using a specified charset.<br>The charset that it uses may be specified by name or may be given explicitly, or the platform’s default charset may be accepted.<br><strong>OutputStreamWriter 是字符流 到 字节流 的桥梁</strong>： 使用指定的字符集编码字符 后写入。<br>OutputStreamWriter 使用的字符集 可以通过名称指定，也可以显式给定，或者接受平台默认的字符集。  </p>
<p>每次调用 OutputStreamWriter 的 write 方法都会 对待处理的字符调用 编码转换器(encoding converter)。<br>字节被写入 <strong>底层输入层流(underlying output stream)</strong> 之前被累计放在 <strong>缓冲区</strong> 中。<br>缓冲区 的大小可以指定，但通常默认的大小足以满足大多数情况。<br>注意，传递给 write 方法的 字符不会被缓冲。  </p>
<p>为了获得最高效率，一般在 BufferedWriter 中 包装(wrapping) 一个 OutputStreamWriter ，这样可以避免频繁地调用转换器(converter)，例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Writer out = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(System.out));</span><br></pre></td></tr></table></figure></p>
<h3 id="Constructors-1"><a href="#Constructors-1" class="headerlink" title="Constructors"></a>Constructors</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Creates an OutputStreamWriter that uses the default character encoding.</span></span><br><span class="line">OutputStreamWriter(OutputStream out)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates an OutputStreamWriter that uses the given charset.</span></span><br><span class="line">OutputStreamWriter(OutputStream out, Charset cs)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates an OutputStreamWriter that uses the given charset encoder.</span></span><br><span class="line">OutputStreamWriter(OutputStream out, CharsetEncoder enc)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates an OutputStreamWriter that uses the named charset.</span></span><br><span class="line">OutputStreamWriter(OutputStream out, String charsetName)</span><br></pre></td></tr></table></figure>
<h1 id="4-FileReader-和-FileWriter"><a href="#4-FileReader-和-FileWriter" class="headerlink" title="4 FileReader 和 FileWriter"></a>4 FileReader 和 FileWriter</h1><p>继承关系：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Reader</span><br><span class="line">   |__InputStreamReader</span><br><span class="line">               |__FileReader</span><br><span class="line"></span><br><span class="line">Writer</span><br><span class="line">   |__OutputStreamWriter</span><br><span class="line">               |__FileWriter</span><br></pre></td></tr></table></figure></p>
<h2 id="4-1-FileReader"><a href="#4-1-FileReader" class="headerlink" title="4.1 FileReader"></a>4.1 FileReader</h2><h3 id="FileReader-简介"><a href="#FileReader-简介" class="headerlink" title="FileReader 简介"></a>FileReader 简介</h3><p><strong>Convenience class for reading character files</strong>.<br>The constructors of this class assume that the default character encoding and the default byte-buffer size are appropriate.<br>To specify these values yourself, construct an InputStreamReader on a FileInputStream.<br><strong>FileReader 是一个 从文件读取字符的 便利类</strong>。<br>FileWriter 的构造器 全都假定 默认的字符编码和默认的字节缓冲大小 是 符合要求的( 可接受的 )。<br>如果要自己指定这些值得话，需要在 FileInputStream 上构造 InputStreamReader。  </p>
<p>FileReader用于读取字符流。对于读取原始字节流，要使用 FileInputStream。</p>
<h3 id="Constructors-2"><a href="#Constructors-2" class="headerlink" title="Constructors"></a>Constructors</h3><p>和 <strong>(字节)文件输入流 FileInputStream</strong> 一样，有 3 个构造函数，参数分别是 File、FileDescriptor、String：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Creates a new FileReader, given the File to read from.</span></span><br><span class="line">FileReader(File file)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates a new FileReader, given the FileDescriptor to read from.</span></span><br><span class="line">FileReader(FileDescriptor fd)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates a new FileReader, given the name of the file to read from.</span></span><br><span class="line">FileReader(String fileName)</span><br></pre></td></tr></table></figure></p>
<h2 id="4-2-FileWriter"><a href="#4-2-FileWriter" class="headerlink" title="4.2 FileWriter"></a>4.2 FileWriter</h2><h3 id="FileWriter-简介"><a href="#FileWriter-简介" class="headerlink" title="FileWriter 简介"></a>FileWriter 简介</h3><p><strong>Convenience class for writing character files</strong>.<br>The constructors of this class assume that the default character encoding and the default byte-buffer size are acceptable.<br>To specify these values yourself, construct an OutputStreamWriter on a FileOutputStream.<br><strong>FileWriter 是一个 写入字符到文件的 便利类</strong>。<br>FileWriter 的构造器 全都假定 默认的字符编码和默认的字节缓冲大小 是 符合要求的( 可接受的 )。<br>如果要自己指定这些值得话，需要在 FileOutputStream 上构造 OutputStreamWriter。  </p>
<h3 id="Constructors-3"><a href="#Constructors-3" class="headerlink" title="Constructors"></a>Constructors</h3><p>和 <strong>(字节)文件输出流 FileOutputStream</strong> 一样，有 5 个构造函数：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Constructs a FileWriter object given a File object.</span></span><br><span class="line">FileWriter(File file)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Constructs a FileWriter object given a File object.</span></span><br><span class="line">FileWriter(File file, <span class="keyword">boolean</span> append)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Constructs a FileWriter object associated with a file descriptor.</span></span><br><span class="line">FileWriter(FileDescriptor fd)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Constructs a FileWriter object given a file name.</span></span><br><span class="line">FileWriter(String fileName)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Constructs a FileWriter object given a file name with a boolean indicating whether or not to append the data written.</span></span><br><span class="line">FileWriter(String fileName, <span class="keyword">boolean</span> append)</span><br></pre></td></tr></table></figure></p>
<h1 id="5-处理流：BufferedReader-和-BufferedWriter"><a href="#5-处理流：BufferedReader-和-BufferedWriter" class="headerlink" title="5 处理流：BufferedReader 和 BufferedWriter"></a>5 处理流：BufferedReader 和 BufferedWriter</h1><p>继承关系：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Reader</span><br><span class="line">   |__BufferedReader</span><br><span class="line"></span><br><span class="line">Writer</span><br><span class="line">   |__BufferedWriter</span><br></pre></td></tr></table></figure></p>
<h2 id="5-1-BufferedReader"><a href="#5-1-BufferedReader" class="headerlink" title="5.1 BufferedReader"></a>5.1 BufferedReader</h2><h3 id="BufferedReader-简介"><a href="#BufferedReader-简介" class="headerlink" title="BufferedReader 简介"></a>BufferedReader 简介</h3><p><strong>Reads text from a character-input stream, buffering characters so as to provide for the efficient reading of characters, arrays, and lines</strong>.<br>The buffer size may be specified, or the default size may be used. The default is large enough for most purposes.<br><strong>BufferedReader 从 字符输入流 中读取文本，缓冲字符 以便有效地读取字符、数组和行</strong> 。<br>可以指定缓冲区大小，也可以使用默认的缓冲区，在大多数场合默认缓冲区是够用的。  </p>
<p>In general, <strong>each read request made of a Reader causes a corresponding read request to be made of the underlying character or byte stream</strong>.<br>It is therefore advisable to wrap a BufferedReader around any Reader whose read() operations may be costly, such as FileReaders and InputStreamReaders.<br>通常， <strong>Reader 的 read 请求 会触发 相应的 底层的字符或字节流(underlying character or byte stream)的 read 请求</strong>。<br>因此，建议将 BufferedReader 包装在 read() 操作代价高昂的 Reader 上，例如 FileReader 和 InputStreamreader。<br>例如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader in  = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"foo.in"</span>));</span><br></pre></td></tr></table></figure></p>
<h3 id="Constructors-4"><a href="#Constructors-4" class="headerlink" title="Constructors"></a>Constructors</h3><p>BufferedReader 的 构造函数 和 BufferedInputStream 类似：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Creates a buffering character-input stream that uses a default-sized input buffer.</span></span><br><span class="line">BufferedReader(Reader in)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates a buffering character-input stream that uses an input buffer of the specified size.</span></span><br><span class="line">BufferedReader(Reader in, <span class="keyword">int</span> sz)</span><br></pre></td></tr></table></figure></p>
<h3 id="部分-Methods"><a href="#部分-Methods" class="headerlink" title="部分 Methods"></a>部分 Methods</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Reads a single character.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span>	<span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Reads characters into a portion of an array.</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span>	<span class="title">read</span><span class="params">(<span class="keyword">char</span>[] cbuf, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Reads a line of text.</span></span></span><br><span class="line"><span class="function">String	<span class="title">readLine</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<h2 id="5-2-BufferedWriter"><a href="#5-2-BufferedWriter" class="headerlink" title="5.2 BufferedWriter"></a>5.2 BufferedWriter</h2><h3 id="BufferedWriter-简介"><a href="#BufferedWriter-简介" class="headerlink" title="BufferedWriter 简介"></a>BufferedWriter 简介</h3><p><strong>Writes text to a character-output stream, buffering characters so as to provide for the efficient writing of single characters, arrays, and strings</strong>.<br>The buffer size may be specified, or the default size may be accepted. The default is large enough for most purposes.<br><strong>BufferedWriter 把文本写入到 字符输出流，缓冲字符 以便有效地 写入单个字符、数组、字符串</strong>。  </p>
<p>A newLine() method is provided, which uses the platform’s own notion of line separator as defined by the system property line.separator.<br>Not all platforms use the newline character ( <strong>‘\n’</strong> ) to terminate lines.<br>Calling this method to terminate each output line is therefore preferred to writing a newline character directly.<br>BufferedWriter 提供了 newLine() 方法，这个方法是 用平台自己的 行分隔符(line separator) 来换行 (注：行分隔符定义在系统属性 line.separator 中)。<br>不是所有的 platform 都支持  <strong>‘\n’</strong> 换行。<br>因此，调用 newLine() 方法换行 比 直接用 写换行符换行 更可取。  </p>
<p>In general, a Writer sends its output immediately to the underlying character or byte stream.<br>Unless prompt output is required, it is advisable to wrap a BufferedWriter around any Writer whose write() operations may be costly, such as FileWriters and OutputStreamWriters.<br>通常， Writer 会立即发送它的输出 到 底层字符或字节流(the underlying character or byte stream)。<br>除非需要提示输出，否则 建议 使用 BufferedWriter 包装 write() 操作代价高昂的 Writer 上，例如 FileWriter 和 OutputStreamWriter。<br>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PrintWriter out = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(<span class="string">"foo.out"</span>)));</span><br></pre></td></tr></table></figure></p>
<h3 id="Constructors-5"><a href="#Constructors-5" class="headerlink" title="Constructors"></a>Constructors</h3><p>BufferedWriter 的 构造方法 和 BufferedOutputStream 类似：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Creates a buffered character-output stream that uses a default-sized output buffer.</span></span><br><span class="line">BufferedWriter(Writer out)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creates a new buffered character-output stream that uses an output buffer of the given size.</span></span><br><span class="line">BufferedWriter(Writer out, <span class="keyword">int</span> sz)</span><br></pre></td></tr></table></figure></p>
<h3 id="部分-Methods-1"><a href="#部分-Methods-1" class="headerlink" title="部分 Methods"></a>部分 Methods</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Writes a line separator.</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>	<span class="title">newLine</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a portion of an array of characters.</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span>	<span class="title">write</span><span class="params">(<span class="keyword">char</span>[] cbuf, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a single character.</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span>	<span class="title">write</span><span class="params">(<span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// Writes a portion of a String.</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span>	<span class="title">write</span><span class="params">(String s, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span></span></span><br></pre></td></tr></table></figure>
<h1 id="6-PrintWriter"><a href="#6-PrintWriter" class="headerlink" title="6 PrintWriter"></a>6 PrintWriter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java.lang.Object</span><br><span class="line">      |__java.io.Writer</span><br><span class="line">            |__java.io.PrintWriter</span><br></pre></td></tr></table></figure>
<p>PrintWriter 是一种 <strong>字符输出流</strong>。<br>PrintWriter 的构造函数 可以接收的参数类型：<br>1、 file对象<br>2、 字符串对象<br>3、 字节输出流 OutputStream<br>4、 字符输出流 Writer  </p>
<p>示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintWriterDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    BufferedReader bufr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">    <span class="comment">// true表示自动刷新</span></span><br><span class="line">    PrintWriter out = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> FileWriter(<span class="string">"aaaa.txt"</span>), <span class="keyword">true</span>);</span><br><span class="line">    String line = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">while</span> ((line = bufr.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      out.println(line);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="7-综合示例"><a href="#7-综合示例" class="headerlink" title="7 综合示例"></a>7 综合示例</h1><p>待更新…</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1、 <a href="https://docs.oracle.com/javase/8/docs/api/" target="_blank" rel="noopener">Java Standard Edition 8 API Specification</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/23/Java-I-O-学习系列二-字节流/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Java-I-O-学习系列二-字节流/" itemprop="url">Java I/O 学习系列二: 字节流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T08:55:17+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>I/O流</strong> 是 (输入/输出)读取/写入 “文件” 内容的技术。  </p>
<hr>
<h1 id="1-Java-I-O-流简介"><a href="#1-Java-I-O-流简介" class="headerlink" title="1 Java I/O 流简介"></a>1 Java I/O 流简介</h1><p>Java 程序 <strong>通过 I/O流完成 输入/输出</strong>。<br>流是生产和消费信息的抽象。<br>输入流可以是多种不同类型的输入：磁盘文件，键盘，网络；<br>输出流可以是多种不同类型的输出：磁盘文件，控制台，网络。  </p>
<p>Java I/O流 的分类：<br>根据 <strong>流向</strong> 分为 <strong><font color="#1a75ff">输入流</font></strong> 和 <strong><font color="#1a75ff">输出流</font></strong>；<br>根据 <strong>传输数据单位</strong> 分为 <strong><font color="#1a75ff">字节流</font></strong> 和 <strong><font color="#1a75ff">字符流</font></strong>；<br>根据 <strong>功能</strong> 分为 <strong><font color="#1a75ff">节点流</font></strong> 和 <strong><font color="#1a75ff">包装流</font></strong> (见标题4)。</p>
<p><strong>字节流</strong>： Java 所有字节流都直接或间接 继承 InputStream类 和 OutputStream类。<br><strong>字符流</strong>： Java 所有字符流都直接或间接 继承 Reader类 和 Writer类。  </p>
<h1 id="2-InputStream-和-OutputStream"><a href="#2-InputStream-和-OutputStream" class="headerlink" title="2 InputStream 和 OutputStream"></a>2 InputStream 和 OutputStream</h1><p>InputStream类 是抽象类， OutputStream类 也是抽象类。  </p>
<h2 id="2-1-InputStream"><a href="#2-1-InputStream" class="headerlink" title="2.1 InputStream"></a>2.1 InputStream</h2><p>This abstract class is the superclass of all classes representing an input stream of bytes.<br><strong>这个抽象类是 所有字节输入流的 父类</strong>。  </p>
<h3 id="InputStream-主要方法："><a href="#InputStream-主要方法：" class="headerlink" title="InputStream 主要方法："></a>InputStream 主要方法：</h3><p><strong><font color="#2eb82e">abstract int    read()</font></strong>: <strong>Reads the next byte</strong> of data from the input stream. <strong>返回 下一个字节内容(即本次read读取到的字节内容)，返回-1表示一个字节都没有读到(这意味着已经读到文件尾后)</strong>。<br><strong><font color="#2eb82e">int    read(byte[] b)</font></strong>: 等价于 read(byte[] b, 0, b.length)。<strong>返回 实际读取到的字节个数，返回-1表示一个字节都没有读到(这意味着已经读到文件尾后)</strong>。读取到的内容放在 byte数组中。<br><strong><font color="#2eb82e">int    read(byte[] b, int off, int len)</font></strong>: 从输入流中，从0位置开始 读取 len个字节放入 b数组中(注：从off位置开始放)。<strong>返回 实际读取到的字节个数，返回-1表示一个字节都没有读到(这意味着已经读到文件尾后)</strong>。<br><strong><font color="#ff9900">void    mark(int readlimit)</font></strong>: <strong>Marks the current position</strong> in this input stream.<br><strong><font color="#ff9900">void    reset()</font></strong>: Repositions this stream to the position at the time the mark method was last called on this input stream.<br><strong><font color="#ff9900">long    skip(long n)</font></strong>: <strong>Skips over and discards n bytes</strong> of data from this input stream.<br>void    close(): Closes this input stream and releases any system resources associated with the stream.  </p>
<h3 id="InputStream-同包下的直接子类："><a href="#InputStream-同包下的直接子类：" class="headerlink" title="InputStream 同包下的直接子类："></a>InputStream 同包下的直接子类：</h3><p>ByteArrayInputStream<br><strong><font color="#1a75ff">FileInputStream</font></strong><br><strong><font color="#1a75ff">FilterInputStream</font></strong><br>ObjectInputStream<br>PipedInputStream<br>SequenceInputStream<br>StringBufferInputStream    </p>
<h2 id="2-2-OutputStream"><a href="#2-2-OutputStream" class="headerlink" title="2.2 OutputStream"></a>2.2 OutputStream</h2><p>This abstract class is the superclass of all classes representing an output stream of bytes. An output stream accepts output bytes and sends them to some sink.<br><strong>这个抽象类是 所有字节输出流的 父类</strong>。输出流 接收输出字节 并发送到某个接收位置。  </p>
<h3 id="OutputStream-所有方法："><a href="#OutputStream-所有方法：" class="headerlink" title="OutputStream 所有方法："></a>OutputStream 所有方法：</h3><p><strong><font color="#2eb82e">void    write(byte[] b)</font></strong>: 从 byte数组 取 b.length 个字节 写入输出流。等价于write(byte[] b, 0, b.length)。<br><strong><font color="#2eb82e">void    write(byte[] b, int off, int len)</font></strong>: <strong>Writes len bytes</strong> from the specified byte array starting at offset off <strong>to this output stream</strong>. <strong>off 是 在数组b 中的任意一个下标，len表示取 len个字节，off和len必须满足关系：len&lt;=b.length-off</strong>，否则会数组下标越界异常。<br><strong><font color="#2eb82e">abstract void    write(int b)</font></strong>: 写 一个字节数据(b对应的ASCII字符) 到输出流，通常和 int read() 联合使用。<br><strong><font color="#ff9900">void    flush()</font></strong>: Flushes this output stream and forces any buffered output bytes to be written out.<br>void    close(): 略。  </p>
<h3 id="OutputStream-同包下的直接子类："><a href="#OutputStream-同包下的直接子类：" class="headerlink" title="OutputStream 同包下的直接子类："></a>OutputStream 同包下的直接子类：</h3><p>ByteArrayOutputStream<br><strong><font color="#1a75ff">FileOutputStream</font></strong><br><strong><font color="#1a75ff">FilterOutputStream</font></strong><br>ObjectOutputStream<br>PipedOutputStream  </p>
<h1 id="3-节点流-FileInputStream-和-FileOutputStream"><a href="#3-节点流-FileInputStream-和-FileOutputStream" class="headerlink" title="3 节点流: FileInputStream 和 FileOutputStream"></a>3 节点流: FileInputStream 和 FileOutputStream</h1><h2 id="3-1-FileInputStream"><a href="#3-1-FileInputStream" class="headerlink" title="3.1 FileInputStream"></a>3.1 FileInputStream</h2><h3 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h3><p>A <strong>FileInputStream</strong> obtains <strong>input bytes</strong> from a file in a file system. What files are available depends on the host environment.<br><strong>FileInputStream</strong> is meant for reading streams of raw bytes such as image data. For reading streams of characters, consider using FileReader.<br><strong>FileInputStream类</strong> 用于从文件系统的文件中获取 <strong>输入字节流</strong>，文件是否可用取决于 主机环境。<br><strong>FileInputStream类</strong> 常用于读取文件的(原始)字节，如图片文件，视频文件等。如果读取字符文件(字符流)，应该用FileReader，而不是FileInputStream。  </p>
<h3 id="constructors"><a href="#constructors" class="headerlink" title="constructors"></a>constructors</h3><p><strong><font color="#8a00e6">FileInputStream(File file)</font></strong> throws FileNotFoundException：<br>Creates a FileInputStream by opening a connection to an actual file, the file named by the File object file in the file system. <strong>传入File对象，建立文件输入流</strong>。<br><strong><font color="#8a00e6">FileInputStream(String name)</font></strong> throws FileNotFoundException：<br>Creates a FileInputStream by opening a connection to an actual file, the file named by the path name in the file system. <strong>不创建File对象，直接传入文件路径</strong>。<br><strong><font color="#8a00e6">FileInputStream(FileDescriptor fdObj)</font></strong>：<br>Creates a FileInputStream by using the file descriptor fdObj, which represents an existing connection to an actual file in the file system.  </p>
<p><strong>FileInputStream类</strong> 的主要方法 和 <strong>InputStream类</strong> 的基本相同。  </p>
<h3 id="FileInputStream-示例"><a href="#FileInputStream-示例" class="headerlink" title="FileInputStream 示例"></a>FileInputStream 示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    File f=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test/file1.txt"</span>);</span><br><span class="line">    <span class="keyword">int</span> length=<span class="number">10</span>;<span class="comment">//(int)f.length();</span></span><br><span class="line">    <span class="keyword">byte</span>[] b=<span class="keyword">new</span> <span class="keyword">byte</span>[length];</span><br><span class="line">    <span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        FileInputStream fis=<span class="keyword">new</span> FileInputStream(f);</span><br><span class="line">        <span class="keyword">while</span>((num=fis.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"此次读取到的字节个数: "</span>+num);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++)</span><br><span class="line">                System.out.print(b[i]);</span><br><span class="line">            System.out.println();</span><br><span class="line">            String str=<span class="keyword">new</span> String(b,<span class="number">0</span>,num);</span><br><span class="line">            System.out.println(<span class="string">"此次读取到的内容: "</span>+str);</span><br><span class="line">            System.out.println(<span class="string">"-----"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        fis.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>file1.txt 文件内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123456789</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure></p>
<p>程序运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">此次读取到的字节个数: 10</span><br><span class="line">49505152535455565713</span><br><span class="line">此次读取到的内容: 123456789</span><br><span class="line">-----</span><br><span class="line">此次读取到的字节个数: 10</span><br><span class="line">1010410110810811132119111114</span><br><span class="line">此次读取到的内容:</span><br><span class="line">hello wor</span><br><span class="line">-----</span><br><span class="line">此次读取到的字节个数: 2</span><br><span class="line">108100</span><br><span class="line">此次读取到的内容: ld</span><br><span class="line">-----</span><br></pre></td></tr></table></figure></p>
<p>注：<br>由输出结果看，file1.txt 文件中 9后面的回车是占两个字节的。</p>
<h2 id="3-2-FileOutputStream"><a href="#3-2-FileOutputStream" class="headerlink" title="3.2 FileOutputStream"></a>3.2 FileOutputStream</h2><h3 id="简介：-1"><a href="#简介：-1" class="headerlink" title="简介："></a>简介：</h3><p><strong>A file output stream is an output stream for writing data to a File</strong> or to a FileDescriptor. Whether or not a file is available or may be created depends upon the underlying platform. Some platforms, in particular, allow a file to be opened for writing by only one FileOutputStream (or other file-writing object) at a time. In such situations the constructors in this class will fail if the file involved is already open.<br><strong>FileOutputStream is meant for writing streams of raw bytes such as image data</strong>. For writing streams of characters, consider using FileWriter.<br><strong>文件输出流 是把数据写入文件的输出流</strong>。文件是否可用或文件是否可创建取决于底层平台。尤其在某些平台中，一次只能用一个 FileOutputStream流 进行写入。如果文件已经(用文件输出流)打开，那么再创建此文件的文件输出流会失败。<br><strong>文件输出流 是用于写入(原始)字节到文件的流</strong>，常用于写图片，视频等文件。 写入字符的流时应该使用FileWriter 而不是 FileOutputStream。  </p>
<h3 id="constructors-1"><a href="#constructors-1" class="headerlink" title="constructors"></a>constructors</h3><p><strong><font color="#8a00e6">public FileOutputStream(File file)</font></strong> throws FileNotFoundException:<br>Creates a file output stream to write to <strong>the file represented by the specified File object</strong>.  </p>
<p><strong><font color="#8a00e6">FileOutputStream(File file, boolean append)</font></strong> throws FileNotFoundException:<br>Creates a file output stream to write to <strong>the file represented by the specified File object</strong>. If the second argument is true, then bytes will be <strong>written to the end of the file rather than the beginning</strong>.  </p>
<p><strong><font color="#8a00e6">FileOutputStream(String name)</font></strong> throws FileNotFoundException:<br>Creates a file output stream to write to <strong>the file with the specified name</strong>.  </p>
<p><strong><font color="#8a00e6">FileOutputStream(String name, boolean append)</font></strong> throws FileNotFoundException:<br>Creates a file output stream to write to <strong>the file with the specified name</strong>. If the second argument is true, then bytes will be <strong>written to the end of the file rather than the beginning</strong>.   </p>
<p><strong><font color="#8a00e6">FileOutputStream(FileDescriptor fdObj)</font></strong>:<br>Creates a file output stream to write to the specified file descriptor, which represents an existing connection to an actual file in the file system.   </p>
<p><strong>FileOutputStream类</strong> 的主要方法 和 <strong>OutputStream类</strong> 的基本相同。  </p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"C:/Users/cx141/Documents/test/file2.txt"</span>);</span><br><span class="line">        String str=<span class="string">"don't panic."</span>;</span><br><span class="line">        fos.write(str.getBytes());</span><br><span class="line">        fos.write(<span class="number">10</span>);<span class="comment">// ASCII对应的字符是 换行符</span></span><br><span class="line">        fos.write(<span class="number">49</span>);<span class="comment">// ASCII对应的字符是 1</span></span><br><span class="line">        fos.write(<span class="number">97</span>);<span class="comment">// ASCII对应的字符是 a</span></span><br><span class="line">        fos.write(<span class="number">10</span>);</span><br><span class="line">        fos.write(<span class="string">"123456789"</span>.getBytes(),<span class="number">2</span>,<span class="number">7</span>); <span class="comment">//注意：off 和 len 取值 受到byte[] b长度影响</span></span><br><span class="line">        fos.close();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (FileNotFoundException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">don&apos;t panic.</span><br><span class="line">1a</span><br><span class="line">3456789</span><br></pre></td></tr></table></figure></p>
<h1 id="4-处理流-FilterInputStream-和-FilterOutputStream"><a href="#4-处理流-FilterInputStream-和-FilterOutputStream" class="headerlink" title="4 处理流: FilterInputStream 和 FilterOutputStream"></a>4 处理流: FilterInputStream 和 FilterOutputStream</h1><p><strong>节点流</strong>：可以从或向一个特定的地方(节点)读写数据。前面介绍的流 都是节点流。<br><strong>处理流</strong>：对一个已存在的流进行封装/装饰，通过对 封装流调用 实现数据读写。  </p>
<p>FilterInputStream 和 FilterOutputStream 都是 <strong>处理流</strong>。  </p>
<p>Filter这两个流用到了 设计模式中的 <strong>装饰器模式</strong>：<br>FilterInputStream 和 FilterOutputStream 都是 <strong>装饰器模式</strong> 中的 Decorator抽象装饰角色。<br>FilterInputStream 继承 InputStream，同时 FilterInputStream 有一个 InputStream 类型的成员。<br>FilterOutputStream 继承 OutputStream，同时 FilterOutputStream 有一个 OutputStream 类型的成员。  </p>
<p><strong><font color="#1a75ff">FilterInputStream 和 FilterOutputStream  既然作为抽象的装饰器角色存在，所以他们没有什么实质性的方法</font></strong>。  </p>
<h2 id="4-1-FilterInputStream"><a href="#4-1-FilterInputStream" class="headerlink" title="4.1 FilterInputStream"></a>4.1 FilterInputStream</h2><h3 id="FilterInputStream-简介"><a href="#FilterInputStream-简介" class="headerlink" title="FilterInputStream 简介"></a>FilterInputStream 简介</h3><p><strong>A FilterInputStream contains some other input stream, which it uses as its basic source of data, possibly transforming the data along the way or providing additional functionality.</strong><br>The class FilterInputStream itself simply overrides all methods of InputStream with versions that pass all requests to the contained input stream.<br>Subclasses of FilterInputStream may further override some of these methods and may also provide additional methods and fields.<br><strong>FilterInputStream 包含一些其他的输入流，FilterInputStream使用这些输入流作为基本数据源，并为它们提供额外功能</strong>。<br>FilterInputStream类 本身只是简单覆盖 InputStream 中的所有方法 (with versions这段不理解啥意思)。<br>FilterInputStream 的子类可能进一步覆盖一些方法，并且可能添加了额外的方法和字段。  </p>
<h3 id="FilterInputStream-同包下的直接子类"><a href="#FilterInputStream-同包下的直接子类" class="headerlink" title="FilterInputStream 同包下的直接子类"></a>FilterInputStream 同包下的直接子类</h3><p>BufferedInputStream<br>DataInputStream<br>PushbackInputStream<br>LineNumberInputStream  </p>
<h2 id="4-2-FilterOutputStream"><a href="#4-2-FilterOutputStream" class="headerlink" title="4.2 FilterOutputStream"></a>4.2 FilterOutputStream</h2><h3 id="FilterOutputStream-简介"><a href="#FilterOutputStream-简介" class="headerlink" title="FilterOutputStream 简介"></a>FilterOutputStream 简介</h3><p><strong>This class is the superclass of all classes that filter output streams</strong>.<br>These streams sit on top of an already existing output stream (the underlying output stream) which it uses as its basic sink of data, but possibly transforming the data along the way or providing additional functionality.<br>The class FilterOutputStream itself simply overrides all methods of OutputStream with versions that pass all requests to the underlying output stream. Subclasses of FilterOutputStream may further override some of these methods as well as provide additional methods and fields.<br><strong>FilterOutputStream类 是所有过滤输出流的超类</strong>。<br>这些 filter output stream 的作用是 包装其他的流 并提供额外的功能。  </p>
<h3 id="FilterOutputStream-同包下的直接子类"><a href="#FilterOutputStream-同包下的直接子类" class="headerlink" title="FilterOutputStream 同包下的直接子类"></a>FilterOutputStream 同包下的直接子类</h3><p>BufferedOutputStream<br>DataOutputStream<br>PrintStream  </p>
<h1 id="5-处理流-BufferedInputStream-和-BufferedOutputStream"><a href="#5-处理流-BufferedInputStream-和-BufferedOutputStream" class="headerlink" title="5 处理流: BufferedInputStream 和 BufferedOutputStream"></a>5 处理流: BufferedInputStream 和 BufferedOutputStream</h1><p>继承关系：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">InputStream</span><br><span class="line">    |__FilterInputStream</span><br><span class="line">            |__BufferedInputStream</span><br><span class="line"></span><br><span class="line">OutputStream</span><br><span class="line">    |__FilterOutputStream</span><br><span class="line">            |__BufferedOutputStream</span><br></pre></td></tr></table></figure></p>
<p>缓冲输入/输出流 的思想：<br>缓冲输入/输出流 每次 读取/写入 数据时，先把数据放在 <strong>缓冲区</strong>(内存)中，等缓冲区满了(或 <strong>调用flush函数</strong>)再进行 <strong>实际的读写操作</strong>。  </p>
<p>缓冲输入/输出流 读写 <strong>效率</strong> 比其他流高，比如：<br>不带缓冲的输出流，写入文件，每次读几个字节就写几个字节，I/O次数比较多；<br>缓冲输出流，写入文件，可以一次读很多字节，但不向磁盘中写入，只是先放到内存里，等凑够了缓冲区大小的时候一次性写入磁盘，这样可以减少磁盘操作次数，提高写入效率。    </p>
<h2 id="5-1-BufferedInputStream"><a href="#5-1-BufferedInputStream" class="headerlink" title="5.1 BufferedInputStream"></a>5.1 BufferedInputStream</h2><p>BufferedInputStream 为 另一个输入流添加了 mark 和 reset 的功能。<br>BufferedInputStream 对象创建时，同时会创建一个 <strong>内部缓冲区数组</strong>(internal buffer array)。<br>当 read 或 skip 流中的字节时，内部缓冲区会被重新填充。<br>mark 操作会标记输入流中的一个位置，reset 操作 会跳转到最近的 mark 的位置。  </p>
<h3 id="Fields"><a href="#Fields" class="headerlink" title="Fields"></a>Fields</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内部缓冲区数组</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">byte</span>[] buf;</span><br><span class="line"></span><br><span class="line"><span class="comment">// buf 中存储的字节 总数</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 缓冲区当前位置(下标)</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上次调用 mark 时 记录的 pos的值</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span>	markpos;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不理解这个字段的意思</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span>	marklimit;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从 java.io.FilterInputStream 继承的字段</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">volatile</span> InputStream in;</span><br></pre></td></tr></table></figure>
<h3 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用默认buf大小, 8192字节(8KB)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BufferedInputStream</span><span class="params">(InputStream in)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 size 指定的 buf 大小</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BufferedInputStream</span><span class="params">(InputStream in,<span class="keyword">int</span> size)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回 被包装流 的可读取的字节总数 的估计值</span></span><br><span class="line"><span class="function"><span class="keyword">int</span>	<span class="title">available</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 和 InputStream 中的 read 一样：读取下一个字节</span></span><br><span class="line"><span class="function"><span class="keyword">int</span>	<span class="title">read</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 给一个起始位置 off，从字节输入流读取 len个字节 放入b数组中</span></span><br><span class="line"><span class="function"><span class="keyword">int</span>	<span class="title">read</span><span class="params">(<span class="keyword">byte</span>[] b, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查看此流是否支持 mark</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">markSupported</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 同 InputStream：标记当前 位置</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mark</span><span class="params">(<span class="keyword">int</span> readlimit)</span></span>;</span><br><span class="line"><span class="comment">// 同 InputStream</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 同 InputStream</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">skip</span><span class="params">(<span class="keyword">long</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="5-2-BufferedOutputStream"><a href="#5-2-BufferedOutputStream" class="headerlink" title="5.2 BufferedOutputStream"></a>5.2 BufferedOutputStream</h2><p>BufferedOutputStream 包装 <strong>底层输出流(underlying output stream)</strong> 提供缓冲功能。  </p>
<h3 id="Fields-1"><a href="#Fields-1" class="headerlink" title="Fields"></a>Fields</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内部缓冲区数组</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">byte</span>[] buf;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The number of valid bytes in the buffer. 缓冲区数组的有效字节数(即，数组实际大小)</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承 java.io.FilterOutputStream</span></span><br><span class="line"><span class="keyword">protected</span> OutputStream out;</span><br></pre></td></tr></table></figure>
<h3 id="Constructors-1"><a href="#Constructors-1" class="headerlink" title="Constructors"></a>Constructors</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 默认 内部缓冲数组大小 8192字节(8KB)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BufferedOutputStream</span><span class="params">(OutputStream out)</span></span>;</span><br><span class="line"><span class="comment">// 使用 size 指定 内部缓冲数组大小</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">BufferedOutputStream</span><span class="params">(OutputStream out, <span class="keyword">int</span> size)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Methods-1"><a href="#Methods-1" class="headerlink" title="Methods"></a>Methods</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 从 b数组中 取 len 个字节 写入 缓冲输入流</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">byte</span>[] b, <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span></span>;</span><br><span class="line"><span class="comment">// 写指定的字节到 缓冲输出流</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">int</span> b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 还有一些继承来的方法，略</span></span><br></pre></td></tr></table></figure>
<h2 id="5-3-缓冲输入-输出流-示例"><a href="#5-3-缓冲输入-输出流-示例" class="headerlink" title="5.3 缓冲输入/输出流 示例"></a>5.3 缓冲输入/输出流 示例</h2><p>以下四段程序复制的 zip 文件 大小为 1.12GB。  </p>
<p>1、 <strong>FileInputStream/FileOutputStream</strong> 单字节复制：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> begin=System.currentTimeMillis();</span><br><span class="line">    File fileIn=<span class="keyword">new</span> File(<span class="string">"C:\\Users\\cx141\\Downloads\\win64_11gR2_database_1of2.zip"</span>);</span><br><span class="line">    File fileOut=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test/1.zip"</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(fileIn);</span><br><span class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(fileOut);</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((i=fis.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">            fos.write(i);</span><br><span class="line">        &#125;</span><br><span class="line">        fos.close();</span><br><span class="line">        fis.close();</span><br><span class="line">        <span class="keyword">long</span> end=System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">"耗时: "</span>+ (end-begin)/<span class="number">1000</span> +<span class="string">" 秒"</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (FileNotFoundException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//耗时大约 1 个小时</span></span><br></pre></td></tr></table></figure></p>
<p>2、 <strong><font color="red">BufferedInputStream</font>/<font color="red">BufferedOutputStream</font></strong> 单字节复制：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> begin=System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        File f1=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Downloads/win64_11gR2_database_1of2.zip"</span>);</span><br><span class="line">        FileInputStream in = <span class="keyword">new</span> FileInputStream(f1);</span><br><span class="line">        BufferedInputStream bin=<span class="keyword">new</span> BufferedInputStream(in);</span><br><span class="line">        File f2=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test"</span>,<span class="string">"2.zip"</span>);</span><br><span class="line">        FileOutputStream out = <span class="keyword">new</span> FileOutputStream(f2);</span><br><span class="line">        BufferedOutputStream bout=<span class="keyword">new</span> BufferedOutputStream(out);</span><br><span class="line">        <span class="keyword">int</span> b=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((b=bin.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">            bout.write(b);</span><br><span class="line">        &#125;</span><br><span class="line">        bout.flush();</span><br><span class="line">        bin.close();</span><br><span class="line">        bout.close();</span><br><span class="line">        <span class="keyword">long</span> end=System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">long</span> consume=(end-begin)/<span class="number">1000</span>;</span><br><span class="line">        System.out.println(<span class="string">"耗时："</span>+consume+<span class="string">" 秒"</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span>(FileNotFoundException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 耗时：40 秒</span></span><br></pre></td></tr></table></figure></p>
<p><strong>单字节复制时，结果很明显，缓冲流包装文件流复制 比 直接用文件流复制 要快得多</strong>。  </p>
<p>3、 <strong>FileInputStream/FileOutputStream</strong> 多字节(2KB)复制：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> begin=System.currentTimeMillis();</span><br><span class="line">    File fileIn=<span class="keyword">new</span> File(<span class="string">"C:\\Users\\cx141\\Downloads\\win64_11gR2_database_1of2.zip"</span>);</span><br><span class="line">    File fileOut=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test/3.zip"</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        FileInputStream fis = <span class="keyword">new</span> FileInputStream(fileIn);</span><br><span class="line">        FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(fileOut);</span><br><span class="line">        <span class="keyword">int</span> BUFSIZE=<span class="number">1024</span>*<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] b=<span class="keyword">new</span> <span class="keyword">byte</span>[BUFSIZE];</span><br><span class="line">        <span class="keyword">int</span> readLength=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((readLength=fis.read(b,<span class="number">0</span>,BUFSIZE))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            fos.write(b,<span class="number">0</span>,BUFSIZE);</span><br><span class="line">        &#125;</span><br><span class="line">        fos.close();</span><br><span class="line">        fis.close();</span><br><span class="line">        <span class="keyword">long</span> end=System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">"耗时: "</span>+ (end-begin)/<span class="number">1000</span> +<span class="string">" 秒"</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (FileNotFoundException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 耗时：6 秒</span></span><br></pre></td></tr></table></figure></p>
<p>4、 <strong><font color="red">BufferedInputStream</font>/<font color="red">BufferedOutputStream</font></strong> 多字节(2KB)复制：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> begin=System.currentTimeMillis();</span><br><span class="line">    File fileIn=<span class="keyword">new</span> File(<span class="string">"C:\\Users\\cx141\\Downloads\\win64_11gR2_database_1of2.zip"</span>);</span><br><span class="line">    File fileOut=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test/4.zip"</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        FileInputStream fis=<span class="keyword">new</span> FileInputStream(fileIn);</span><br><span class="line">        FileOutputStream fos=<span class="keyword">new</span> FileOutputStream(fileOut);</span><br><span class="line">        <span class="comment">// 缓冲输入/输出流</span></span><br><span class="line">        BufferedInputStream bis=<span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">        BufferedOutputStream bos=<span class="keyword">new</span> BufferedOutputStream(fos);</span><br><span class="line">        <span class="keyword">int</span> BUFSIZE=<span class="number">1024</span>*<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] buf=<span class="keyword">new</span> <span class="keyword">byte</span>[BUFSIZE];</span><br><span class="line">        <span class="keyword">int</span> readLength=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((readLength=bis.read(buf,<span class="number">0</span>,BUFSIZE))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            bos.write(buf,<span class="number">0</span>,readLength);</span><br><span class="line">        &#125;</span><br><span class="line">        bos.flush();</span><br><span class="line">        bis.close();</span><br><span class="line">        bos.close();</span><br><span class="line">        <span class="keyword">long</span> end=System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">"耗时: "</span>+ (end-begin)/<span class="number">1000</span> +<span class="string">" 秒"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//耗时：2 秒</span></span><br></pre></td></tr></table></figure></p>
<p>总结与分析：<br>上面程序中，缓冲流均采用 默认的 8KB 大的 缓冲byte数组。<br>不论是单字节还是多字节复制，利用 <strong>缓冲流</strong> 处理的文件流 都比 普通文件流 要快(因为缓冲到内存，减少了 I/O 次数)。<br>如果文件不大，采用多字节复制，普通文件流操作 和 缓冲流 之间的效率差距并不大！<br><strong><font color="red">缓冲流只有在大幅减少 I/O 次数时，才可能提高效率</font></strong>。  </p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1、 <a href="https://www.cnblogs.com/dongguacai/p/5658388.html" target="_blank" rel="noopener">深入理解JAVA I/O系列二：字节流详解</a><br>2、 <a href="https://docs.oracle.com/javase/8/docs/api/" target="_blank" rel="noopener">Standard Edition 8 API Specification</a><br>3、 <a href="https://www.cnblogs.com/ysocean/p/6854098.html" target="_blank" rel="noopener">Java IO详解（二)——流的分类</a><br>4、 <a href="https://www.cnblogs.com/noteless/archive/2018/09/12/9632812.html" target="_blank" rel="noopener">JavaIO之FilterInputStream FilterOutputStream</a><br>5、 <a href="https://blog.csdn.net/zhaoyanjun6/article/details/54894451" target="_blank" rel="noopener">Java IO流学习总结三：缓冲流</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/22/Java-I-O-学习系列一-File类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/22/Java-I-O-学习系列一-File类/" itemprop="url">Java I/O 学习系列一: File类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-22T11:41:37+08:00">
                2019-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>抽象路径名(abstract pathname)：Java 为了方便对不同命名规则的路径进行统一的处理，以 Java的抽象路径名代表不同系统的路径名。   </p>
<hr>
<p>File 类 简介：<br>1、一个 File类 的对象，表示磁盘上的一个文件/目录。<br>2、File 提供了 (与平台无关的)方法来对磁盘上的 文件/目录 进行操作。  </p>
<p><strong>可见，File类 可以表示文件及操作文件， 但 <font color="red">不能读写文件内容</font>。</strong></p>
<h1 id="1-Constructors"><a href="#1-Constructors" class="headerlink" title="1 Constructors"></a>1 Constructors</h1><p>File 类的 有 4个 constructors：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">File(File parent, String child)</span><br><span class="line"><span class="comment">// 根据 文件或目录 创建File对象</span></span><br><span class="line">File(String pathname)</span><br><span class="line"></span><br><span class="line">File(String parent, String child)</span><br><span class="line"></span><br><span class="line">File(URI uri)</span><br></pre></td></tr></table></figure></p>
<p>注：<br>File 对象 对应的文件/目录 不一定存在。  </p>
<h1 id="2-常用-Methods"><a href="#2-常用-Methods" class="headerlink" title="2 常用 Methods"></a>2 常用 <a href="https://docs.oracle.com/javase/8/docs/api/" target="_blank" rel="noopener">Methods</a></h1><p><strong><font color="#1a75ff">boolean    canRead()</font></strong>  文件/目录 是否可读<br><strong><font color="#1a75ff">boolean    canWrite()</font></strong><br><strong><font color="#1a75ff">boolean    canExecute()</font></strong>  </p>
<p><strong><font color="#1a75ff">boolean    exists()</font></strong> 判断 文件/目录 是否存在，存在返回 true<br><strong><font color="#1a75ff">boolean    createNewFile()</font></strong>  创建 文件/目录<br><strong><font color="#1a75ff">boolean    delete()</font></strong>  删除 文件/目录  </p>
<p><strong><font color="#1a75ff">String    getAbsolutePath()</font></strong> 获取抽象路径名(文件/目录)的绝对路径(文件或目录)<br><strong><font color="#1a75ff">String    getPath()</font></strong>  获取抽象路径名(文件/目录)的路径(文件或目录)<br><strong><font color="#1a75ff">String    getName()</font></strong>  获取文件/目录名  </p>
<p><strong><font color="#1a75ff">boolean    isDirectory()</font></strong>  是目录返回true<br><strong><font color="#1a75ff">boolean    isFile()</font></strong>  是文件返回true  </p>
<p><strong><font color="#1a75ff">long    length()</font></strong>   返回文件的大小(字节)<br><strong><font color="#1a75ff">File[]    listFiles()</font></strong>  返回目录下的所有 文件/目录  </p>
<p><strong><font color="#1a75ff">boolean    mkdir()</font></strong>  创建目录<br><strong><font color="#1a75ff">boolean    mkdirs()</font></strong>  递归创建多次目录  </p>
<h1 id="3-示例"><a href="#3-示例" class="headerlink" title="3 示例"></a>3 示例</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    File f1=<span class="keyword">new</span> File(<span class="string">"C:\\Users\\cx141\\Documents\\test\\file1.txt"</span>);</span><br><span class="line">    <span class="comment">// 指定路径的文件是否存在，存在 exists 返回true</span></span><br><span class="line">    <span class="keyword">if</span>(f1.exists()) &#123;</span><br><span class="line">        System.out.println(<span class="string">"文件名称: "</span>+f1.getName());</span><br><span class="line">        System.out.println(<span class="string">"文件大小: "</span>+f1.length()+<span class="string">" 字节"</span>);</span><br><span class="line">        System.out.println(<span class="string">"文件绝对路径: "</span>+f1.getAbsolutePath());</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"file1.txt 不存在"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//createNewFile 创建文件</span></span><br><span class="line">            f1.createNewFile();</span><br><span class="line">            System.out.println(<span class="string">"file1.txt 文件创建成功"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除文件</span></span><br><span class="line">    File f2 =<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test/file1.txt"</span>);</span><br><span class="line">    f2.delete();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建目录</span></span><br><span class="line">    File f3=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test/dirc2"</span>);</span><br><span class="line">    <span class="keyword">if</span>(f3.exists() &amp;&amp; f3.isDirectory()) &#123;</span><br><span class="line">        System.out.println(<span class="string">"dirc2 目录已存在"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        f3.mkdir(); <span class="comment">//mkdir创建目录， 另：mkdirs 可以递归创建多层目录</span></span><br><span class="line">        System.out.println(<span class="string">"dirc2 目录创建成功"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// listFiles 列出目录中所有的文件和文件夹</span></span><br><span class="line">    File f4=<span class="keyword">new</span> File(<span class="string">"C:/Users/cx141/Documents/test"</span>);</span><br><span class="line">    <span class="keyword">if</span>(f4.isDirectory()) &#123;</span><br><span class="line">        File fList[]=f4.listFiles();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fList.length;i++) &#123;</span><br><span class="line">            System.out.println(fList[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 Windows OS 中，绝对路径写法：<code>C:\Users\cx141\Documents\test\file1.txt</code> ，<br>也可以 <code>C:/Users/cx141/Documents/test/file1.txt</code> 。<br>在 Linux/Unix 中， 绝对路径写法：<code>C:/Users/cx141/Documents/test/file1.txt</code> 。<br>所以，<strong>路径可以统一写作</strong>：<code>C:/Users/cx141/Documents/test/file1.txt</code> 。   </p>
<p>注：<br>在File类中，路径的分隔符是 <code>File.separator</code>   </p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1、 <a href="https://blog.csdn.net/crslee/article/details/51043045?utm_source=blogxgwz2" target="_blank" rel="noopener">JAVA 抽象路径</a><br>2、 <a href="https://www.cnblogs.com/dongguacai/p/5656471.html" target="_blank" rel="noopener">深入理解JAVA I/O系列一：File</a>  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/15/RedHat系的软件包管理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/15/RedHat系的软件包管理/" itemprop="url">RedHat系的软件包管理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-15T15:43:59+08:00">
                2019-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>耳濡目染，不学以能。  —韩愈</p>
<hr>
<h1 id="1-Linux-包管理概述"><a href="#1-Linux-包管理概述" class="headerlink" title="1 Linux 包管理概述"></a>1 Linux 包管理概述</h1><p>Linux 系统按照 包管理系统 可划分为两个派系： RedHat系 和 Debian系。   </p>
<p>RedHat 系(RedHat, CentOS, Fedora, Oracle Linux等)：<br>1、 包格式： <strong>.rpm</strong><br>2、 包管理工具： <strong><font color="red">rpm</font></strong>，<strong><font color="red">yum</font></strong>，dnf(Fedora在yum之后开发的包管理工具)<br><strong>rpm (RPM Package Manager)</strong> 是一个包管理系统。<br><strong>yum (Yellowdog Updater, Modified)</strong> 是一个基于 rpm 的 包管理程序。<br><strong>dnf (Dandified YUM)</strong> , 最近的 Fedora 版本中，dnf 取代了 yum。dnf 是 yum 的一个现代化的分支，它保留了大部分 yum 的接口。  </p>
<p>Debian 系(Debian, Ubuntu等)：<br>1、 包格式： <strong>.deb</strong><br>2、 包管理工具：  <strong><font color="orange">dpkg</font></strong>, apt-cache, apt-get, apt-config, <strong><font color="orange">apt</font></strong><br><strong>APT (Advanced Package Tool, 高级软件包工具)</strong> 是一个 软件接口。<br><strong>dpkg (Debian Package)</strong> 是一个底层的包管理工具。<br><strong>apt</strong> 是一套处理包的工具集 (包含命令 apt)。<br><strong>apt-cache, apt-get, apt-config 命令</strong> 是 apt 命令 的超集 。  </p>
<h1 id="2-RPM-Package-Manager"><a href="#2-RPM-Package-Manager" class="headerlink" title="2 RPM Package Manager"></a>2 RPM Package Manager</h1><p>rpm 命令的用法有3大类：查询和校验包，安装更新和删除，杂项。  </p>
<h2 id="2-1-QUERYING-AND-VERIFYING-PACKAGES"><a href="#2-1-QUERYING-AND-VERIFYING-PACKAGES" class="headerlink" title="2.1 QUERYING AND VERIFYING PACKAGES:"></a>2.1 QUERYING AND VERIFYING PACKAGES:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm &#123;-q|--query&#125; [select-options] [query-options]</span><br><span class="line"></span><br><span class="line">rpm &#123;-V|--verify&#125; [select-options] [verify-options]</span><br></pre></td></tr></table></figure>
<p>select-options, query-options, verify-options, install-options 详细参数参考 <code>man rpm</code>。<br>常用参数：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询 所有已经安装的软件包</span></span><br><span class="line">rpm -qa</span><br><span class="line">rpm -q --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 指定软件包信息</span></span><br><span class="line">rpm -qi yum</span><br><span class="line">rpm -q --info yum</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询软件包相关的文件</span></span><br><span class="line">rpm -ql yum</span><br><span class="line">rpm -q --list yum</span><br></pre></td></tr></table></figure></p>
<h2 id="2-2-INSTALLING-UPGRADING-AND-REMOVING-PACKAGES"><a href="#2-2-INSTALLING-UPGRADING-AND-REMOVING-PACKAGES" class="headerlink" title="2.2 INSTALLING, UPGRADING, AND REMOVING PACKAGES:"></a>2.2 INSTALLING, UPGRADING, AND REMOVING PACKAGES:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rpm &#123;-i|--install&#125; [install-options] PACKAGE_FILE ...</span><br><span class="line"></span><br><span class="line">rpm &#123;-U|--upgrade&#125; [install-options] PACKAGE_FILE ...</span><br><span class="line"></span><br><span class="line">rpm &#123;-F|--freshen&#125; [install-options] PACKAGE_FILE ...</span><br><span class="line"></span><br><span class="line">rpm &#123;-e|--erase&#125; [--allmatches] [--justdb] [--nodeps] [--noscripts]</span><br><span class="line">        [--notriggers] [--test] PACKAGE_NAME ...</span><br></pre></td></tr></table></figure>
<p>常用参数：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装软件包. -v 表示 verbose 冗长输入，-h 表示 hash 井号进度条</span></span><br><span class="line">rpm -ivh xxxx.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># --nodeps  不验证软件包的依赖(no dependencies)</span></span><br><span class="line"><span class="comment"># --force 强制安装，即使覆盖其他包的文件也要安装</span></span><br><span class="line"><span class="comment">#强制安装</span></span><br><span class="line">rpm -ivh --nodeps xxxx.rpm</span><br><span class="line"><span class="comment">#强制卸载</span></span><br><span class="line">rpm -e --nodeps --force xxxx.rpm</span><br></pre></td></tr></table></figure></p>
<h2 id="2-3-MISCELLANEOUS"><a href="#2-3-MISCELLANEOUS" class="headerlink" title="2.3 MISCELLANEOUS:"></a>2.3 MISCELLANEOUS:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm &#123;--querytags|--showrc&#125;</span><br><span class="line"></span><br><span class="line">rpm &#123;--setperms|--setugids&#125; PACKAGE_NAME ...</span><br></pre></td></tr></table></figure>
<h2 id="2-4-软件包的命名"><a href="#2-4-软件包的命名" class="headerlink" title="2.4 软件包的命名"></a>2.4 软件包的命名</h2><p>如下有 3 个 rpm 软件包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum-  3.4.3-161.  el7.  centos.  noarch.rpm</span><br><span class="line">yum-metadata-parser-  1.1.4-10.  el7.  x86_64.rpm</span><br><span class="line">yum-plugin-fastestmirror-  1.1.31-50.  el7.  noarch.rpm</span><br></pre></td></tr></table></figure></p>
<p><strong>rpm 软件包命名规则</strong>：<br>软件名-主版本号.次版本号-修订号. 适用的Linux平台. 适用的硬件平台.rpm  </p>
<p>Linux平台有： centos、el系列(RHEL/centos)。<br>硬件平台有：i386、i686、x86_64、noarch(no architecture, 所有硬件平台通用)。  </p>
<h1 id="3-yum"><a href="#3-yum" class="headerlink" title="3 yum"></a>3 yum</h1><p>rpm 虽然可以安装软件包，但是需要自己安装 <strong>依赖包</strong>。安装依赖 是很一件繁琐的事(需要一个一个一层一层的下载，再安装)。  </p>
<p>通常情况下，安装软件都是用 <strong>yum</strong>，而不是 <strong>rpm</strong>。  </p>
<h2 id="3-1-yum-简介"><a href="#3-1-yum-简介" class="headerlink" title="3.1 yum 简介"></a>3.1 yum 简介</h2><p><strong>yum 可以自动 管理 包间的依赖关系</strong>。和 Debian系 的Advanced Package Tool (APT) 类似，yum与软件仓库(software repositories)一起工作，这些软件仓库可以在本地访问 也能通过网络连接访问。  </p>
<h2 id="3-2-yum-工作原理"><a href="#3-2-yum-工作原理" class="headerlink" title="3.2 yum 工作原理"></a>3.2 yum 工作原理</h2><p><img src="https://mitre.oss-cn-hangzhou.aliyuncs.com/blog-2018-12/yum.png" alt><br>这里只关注客户端，不考虑服务端。  </p>
<p>客户端的配置文件：<font color="#3366ff">/etc/yum.conf</font> 和 <font color="#3366ff">/etc/yum.repos.d/*.repo</font>。  </p>
<p><font color="#3366ff">/etc/yum.conf</font> 包含一个 [main] section，可以通过它设置 全局作用的 yum 选项。  </p>
<p><font color="#3366ff">/etc/yum.conf</font> 文件还可以包含一个或多个 [repository] sections，可以通过他们设置 repository-specific options(特定的仓库选项)。但是，推荐的做法是 在<font color="#3366ff">/etc/yum.repos.d</font> 目录下 新建 .repo 文件， 把 特定的仓库选项 放在 .repo 文件中。  </p>
<p><font color="#3366ff">/etc/yum.conf</font> 文件的 [main] Options 默认设置：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[main]</span><br><span class="line"><span class="comment"># 存储 yum缓存和数据库文件 目录的绝对路径</span></span><br><span class="line">cachedir=/var/cache/yum/<span class="variable">$basearch</span>/<span class="variable">$releasever</span></span><br><span class="line"><span class="comment"># 安装成功后是否保存缓存：0-不保留，1-保留</span></span><br><span class="line">keepcache=0</span><br><span class="line"><span class="comment"># 显示 调试输出： level 取值0到10，值越大debug输出越详细，0-不输出，2-缺省</span></span><br><span class="line">debuglevel=2</span><br><span class="line"><span class="comment"># yum 日志文件 的绝对路径</span></span><br><span class="line">logfile=/var/<span class="built_in">log</span>/yum.log</span><br><span class="line"><span class="comment"># 确切的architecture ： 0-更新包时不考虑确切的 architecture，1-更新时考虑  </span></span><br><span class="line">exactarch=1</span><br><span class="line"><span class="comment"># 废弃处理逻辑(obsoletes processing logic): 0-禁用，1-enable( 取决于包的spec file内容)</span></span><br><span class="line">obsoletes=1</span><br><span class="line"><span class="comment"># GPG signature 检查(一种加密软件套件)： 0-disable，1-enable</span></span><br><span class="line">gpgcheck=1</span><br><span class="line"><span class="comment"># yum plug-ins globally(yum全局插件): 0-disable, 1-enable</span></span><br><span class="line">plugins=1</span><br><span class="line"><span class="comment"># installonlypkgs directive 用到的参数</span></span><br><span class="line">installonly_limit=5</span><br><span class="line"><span class="comment"># 后两个作用不详</span></span><br><span class="line">bugtracker_url=http://bugs.centos.org/set_project.php?project_id=23&amp;ref=http://bugs.centos.org/bug_report_page.php?category=yum</span><br><span class="line">distroverpkg=centos-release</span><br></pre></td></tr></table></figure></p>
<p>仓库配置文件 <font color="#3366ff">/etc/yum.repos.d/*.repo</font> ：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 仓库的ID，可以取任意名字，只要不和其他的ID冲突即可  </span></span><br><span class="line">[Repository_ID]</span><br><span class="line"></span><br><span class="line"><span class="comment"># a human-readable string describing the repository.  </span></span><br><span class="line">name=repository_name</span><br><span class="line"><span class="comment"># 服务端 repodata文件夹 所在目录的URL，客户端安装包时访问的路径  </span></span><br><span class="line">baseurl=repository_url</span><br><span class="line"><span class="comment"># 镜像服务器的地址列表. 注：baseurl 和 mirrorlist 只能选其一</span></span><br><span class="line">mirrorlist=repository_url_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1-Include this repository as a package source(将此仓库作为包源，支持HTTP、FTP、本地库).  </span></span><br><span class="line">enabled=&#123;1|0&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否进行 gpg签名(GNU Privacy Guard)检测，0-disable，1-enable(默认)。若启用gpg检查，需要告知其key是什么</span></span><br><span class="line">gpgcheck=&#123;1|0&#125;   </span><br><span class="line"><span class="comment"># 如果启用 gpg签名检测，则需要指定gpgkey的路径，次路径可以是远程服务器上的，也可以是本地的.</span></span><br><span class="line">gpgkey=url</span><br></pre></td></tr></table></figure></p>
<h2 id="3-3-yum-命令-GENERAL-OPTIONS"><a href="#3-3-yum-命令-GENERAL-OPTIONS" class="headerlink" title="3.3 yum 命令 GENERAL OPTIONS"></a>3.3 yum 命令 GENERAL OPTIONS</h2><h3 id="3-3-1-安装和删除"><a href="#3-3-1-安装和删除" class="headerlink" title="3.3.1 安装和删除"></a>3.3.1 安装和删除</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install package-name;</span><br><span class="line"></span><br><span class="line">yum -y remove package-name;</span><br></pre></td></tr></table></figure>
<p>-y 自动确认安装/删除    </p>
<p>例如安装 sl：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install sl;</span><br></pre></td></tr></table></figure></p>
<h3 id="3-3-2-更新和升级"><a href="#3-3-2-更新和升级" class="headerlink" title="3.3.2 更新和升级"></a>3.3.2 更新和升级</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum update package-name;</span><br><span class="line"></span><br><span class="line">yum upgrade package-name;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-3-缓存"><a href="#3-3-3-缓存" class="headerlink" title="3.3.3 缓存"></a>3.3.3 缓存</h3><p>清除缓存：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum clean [headers|packages|metadata|dbcache|plugins|expire-cache|all]</span><br></pre></td></tr></table></figure></p>
<p>packages 清除缓存目录下的软件包, 清空的是(/var/cache/yum)下的缓存。<br>headers 清除缓存目录下的 headers。<br>all 清除所有的 yum缓存。  </p>
<p>将服务器软件包信息缓存至本地：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache;</span><br></pre></td></tr></table></figure></p>
<h3 id="3-3-4-查找和显示"><a href="#3-3-4-查找和显示" class="headerlink" title="3.3.4 查找和显示"></a>3.3.4 查找和显示</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示 软件包信息</span></span><br><span class="line">yum info sl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示 软件包安装信息</span></span><br><span class="line">yum list sl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询 软件包依赖信息</span></span><br><span class="line">yum deplist sl</span><br></pre></td></tr></table></figure>
<h1 id="4-RedHat6-4-重新安装-yum"><a href="#4-RedHat6-4-重新安装-yum" class="headerlink" title="4 RedHat6.4 重新安装 yum"></a>4 RedHat6.4 重新安装 yum</h1><p>RedHat6.4 原生 yum 需要注册付费才能下载软件，要想不注册，需要重新安装 yum ( CentOS6 版本 )。  </p>
<p>1、 卸载 RedHat6.4 原生 yum:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep yum | xargs rpm -e --nodeps</span><br></pre></td></tr></table></figure></p>
<p>2、 从 <a href="https://mirrors.163.com/centos/6/os/x86_64/Packages/" target="_blank" rel="noopener">网易镜像网站</a> 下载如下几个包(wget 下载过程略) 并安装：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh python-iniparse-0.3.1-2.1.el6.noarch.rpm  </span><br><span class="line">rpm -ivh python-urlgrabber-3.9.1-11.el6.noarch.rpm</span><br><span class="line">rpm -ivh yum-metadata-parser-1.1.2-16.el6.x86_64.rpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下两个包要一起安装</span></span><br><span class="line">rpm -ivh yum-3.2.29-40.el6.centos.noarch.rpm yum-plugin-fastestmirror-1.1.30-14.el6.noarch.rpm</span><br></pre></td></tr></table></figure></p>
<p><strong>注意：</strong><br>如果安装过程中有报 <font color="red">conflict 问题</font>，用 <code>rpm -Uvh xxx.rpm</code> 升级，或 用 <code>–force</code>强制安装。<br>如果报 <font color="red">xxx needed by 问题</font>，那么需要下载 xxx.rpm 包并安装。  </p>
<p>3、 <a href="https://mirrors.163.com/.help/centos.html" target="_blank" rel="noopener">下载 CentOS6-Base-163.repo</a>:<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d</span><br><span class="line">wget https://mirrors.163.com/.<span class="built_in">help</span>/CentOS6-Base-163.repo</span><br></pre></td></tr></table></figure></p>
<p>把 CentOS6-Base-163.repo 文件中的 $releasever 替换 为 6。  </p>
<p><font color="red">不要修改 epel.repo 文件</font>。  </p>
<p>4、 清理缓存：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure></p>
<p>5、 完成，测试以下：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gcc</span><br><span class="line">yum -y install sl</span><br><span class="line">yum -y install tree</span><br><span class="line">yum -y install htop</span><br></pre></td></tr></table></figure></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>1 <a href="https://linux.cn/article-8782-1.html?pr" target="_blank" rel="noopener">Linux 包管理基础：apt、yum、dnf 和 pkg</a><br>2 <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/sec-configuring_yum_and_yum_repositories" target="_blank" rel="noopener">CONFIGURING YUM AND YUM REPOSITORIES</a><br>3 <a href="https://blog.csdn.net/u012012939/article/details/48438103" target="_blank" rel="noopener">yum的工作原理以及如何建立yum仓库</a><br>4 <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/sec-setting_repository_options" target="_blank" rel="noopener">SETTING REPOSITORY OPTIONS</a><br>5 <a href="https://blog.csdn.net/shuaigexiaobo/article/details/79875730" target="_blank" rel="noopener">yum 命令讲解</a><br>6 <a href="https://en.wikipedia.org/wiki/Yum_(software%29" target="_blank" rel="noopener">yum (software)</a>   </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/14/Linux-域名解析失败/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mitre">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MITRE">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/14/Linux-域名解析失败/" itemprop="url">Linux 域名解析失败</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-14T15:00:23+08:00">
                2019-01-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1-问题"><a href="#1-问题" class="headerlink" title="1 问题"></a>1 问题</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://mirrors.163.com/centos/7/os/x86_64/Packages/PackageKit-yum-plugin-1.1.10-1.el7.centos.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>报错如下：  </p>
<font color="red">正在解析主机 mirrors.163.com… 失败：域名解析暂时失败。<br>wget: 无法解析主机地址 “mirrors.163.com”</font>    

<h1 id="2-问题排查"><a href="#2-问题排查" class="headerlink" title="2 问题排查"></a>2 问题排查</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ping 百度的域名，ping不通</span></span><br><span class="line">ping baidu.com</span><br><span class="line"><span class="comment"># ping: unknown host baidu.com</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ping 百度的 ip，可以 ping通</span></span><br><span class="line">ping 220.181.112.244</span><br><span class="line"><span class="comment"># PING 220.181.112.244 (220.181.112.244) 56(84) bytes of data.</span></span><br><span class="line"><span class="comment"># 64 bytes from 220.181.112.244: icmp_seq=1 ttl=49 time=26.5 ms</span></span><br><span class="line"><span class="comment"># 64 bytes from 220.181.112.244: icmp_seq=2 ttl=49 time=26.3 ms</span></span><br></pre></td></tr></table></figure>
<p><strong>说明是 DNS 解析 有问题！</strong>  </p>
<p>修改 <font color="#0066ff">/etc/resolv.conf</font> 文件(DNS resolver配置文件) ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nameserver 114.114.114.114</span><br></pre></td></tr></table></figure></p>
<p><strong>114DNS</strong> 以多个基础电信运营商自用的DNS系统为基础，通过扩展而建成专业的第三方高可靠 DNS服务平台….<br>总之，用 114DNS 做 DNS解析 能解决当下的问题。  </p>
<p>结果：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ping baidu.com</span><br><span class="line"><span class="comment"># PING baidu.com (220.181.57.216) 56(84) bytes of data.</span></span><br><span class="line"><span class="comment"># 64 bytes from 220.181.57.216: icmp_seq=1 ttl=49 time=22.3 ms</span></span><br><span class="line"><span class="comment"># 64 bytes from 220.181.57.216: icmp_seq=2 ttl=49 time=22.2 ms</span></span><br></pre></td></tr></table></figure></p>
<h1 id="3-附加说明"><a href="#3-附加说明" class="headerlink" title="3 附加说明"></a>3 附加说明</h1><p>Linux 版本信息：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br><span class="line"><span class="comment"># Linux ahtelecom-rhel6.4 2.6.32-358.el6.x86_64 #1 SMP Tue Jan 29 11:47:41 EST 2013 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line">cat /etc/redhat-release</span><br><span class="line"><span class="comment"># Red Hat Enterprise Linux Server release 6.4 (Santiago)</span></span><br></pre></td></tr></table></figure></p>
<p>网络配置信息：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询网关</span></span><br><span class="line">route -n</span><br><span class="line"><span class="comment"># Kernel IP routing table</span></span><br><span class="line"><span class="comment"># Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span></span><br><span class="line"><span class="comment"># 169.254.169.254 10.189.2.1      255.255.255.255 UGH   0      0        0 eth0</span></span><br><span class="line"><span class="comment"># 10.189.2.0      0.0.0.0         255.255.255.0   U     1      0        0 eth0</span></span><br><span class="line"><span class="comment"># 0.0.0.0         10.189.2.1      0.0.0.0         UG    0      0        0 eth0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 网卡配置文件</span></span><br><span class="line">cat /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line"><span class="comment"># DEVICE=eth0</span></span><br><span class="line"><span class="comment"># TYPE=Ethernet</span></span><br><span class="line"><span class="comment"># ONBOOT=yes</span></span><br><span class="line"><span class="comment"># BOOTPROTO=dhcp</span></span><br><span class="line"><span class="comment"># NM_CONTROLLED=yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 服务器所需网络配置信息(information about the desired network configuration on your server)</span></span><br><span class="line">cat /etc/sysconfig/network</span><br><span class="line"><span class="comment"># NETWORKING=yes</span></span><br><span class="line"><span class="comment"># HOSTNAME=ahtelecom-rhel6.4</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://mitre.oss-cn-hangzhou.aliyuncs.com/img/vlcsnap-2018-02-22-21h01m56s237.png" alt="mitre">
            
              <p class="site-author-name" itemprop="name">mitre</p>
              <p class="site-description motion-element" itemprop="description">Goals determine what you are going to be</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">104</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                Friends
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.yanmin99.com/" title="yanmin" target="_blank">yanmin</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://whark.cn" title="大鹏" target="_blank">大鹏</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.notall.cn/" title="zkp" target="_blank">zkp</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://qiracle.cn/" title="强强" target="_blank">强强</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mitre</span>

  
</div>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">totle: <span id="busuanzi_value_site_pv"></span> times</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">Visitors: <span id="busuanzi_value_site_uv"></span></span>
    <span class="post-meta-divider">|</span>



  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>






        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

</body>
</html>
